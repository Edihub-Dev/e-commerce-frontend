import{r,ar as X,as as Ee,j as e,A as Le,m as se}from"./vendor-2d1PFKo4.js";import{c as Ie,I as Ve,aJ as J,C as m,aK as ze,X as _e,aL as $e,aM as Be,aN as Ge,aO as qe,ae as Xe,aP as Je}from"./index-Bpx0OnSg.js";import{S as ae}from"./Sidebar-Blgfai62.js";import{N as Ke}from"./Navbar-K_t1OsQh.js";import{u as Ye,a as He}from"./hooks-W65Onizy.js";import{T as Qe}from"./tag-B5IXzVZU.js";import{S as We}from"./shield-check-ZginSkgb.js";import{L as Ze}from"./layers-C-GEjimE.js";import{C as et}from"./calendar-jUZ4havw.js";import{T as tt}from"./triangle-alert-C_xSVBCC.js";import{C as st}from"./circle-check-CZUF0pO-.js";import{C as at}from"./circle-dashed-pAKzQiuZ.js";import{R as lt}from"./refresh-cw-DQoxs3YL.js";import{L as K}from"./loader-circle-DRAKHMK_.js";import{P as le}from"./plus-BZuZgauU.js";import{T as ne}from"./trash-2-Chc1geHF.js";import{D as nt}from"./download-D5r73ZfU.js";import{P as it}from"./pencil-BZnjNrx9.js";import"./react-BzrpNAyj.js";import"./house-Bx4yg0fx.js";import"./ticket-percent-OJlGKFU7.js";import"./package-C_UWcLgd.js";import"./shopping-bag-Dv9EZFsL.js";import"./arrow-left-fjWLrcm4.js";import"./log-out-BEyQjTNl.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ot=Ie("lock",rt),Y=(s="single")=>({code:"",description:"",type:s,discountValue:"",maxDiscountAmount:"",minOrderAmount:"",maxRedemptions:s==="single"?"1":"",maxRedemptionsPerUser:s==="single"?"1":"",startDate:"",endDate:"",isActive:!0,count:"1"}),ie=s=>{if(!s)return"";try{return s.slice(0,10)}catch{const p=new Date(s);return Number.isNaN(p.getTime())?"":p.toISOString().slice(0,10)}},V=s=>{if(!s)return"--";const a=new Date(s);return Number.isNaN(a.getTime())?"--":a.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})},z=s=>{if(s==null||s==="")return"--";const a=Number(s);return Number.isFinite(a)?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(a):"--"},dt=s=>s?"Yes":"No",re=s=>{if(s==null)return"Unlimited";const a=Number(s);return!Number.isFinite(a)||a<=0?"Unlimited":a},oe=s=>{if(!s)return"--";const a=new Date(s);return Number.isNaN(a.getTime())?"--":a.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},de=s=>{if(s==null||s==="")return null;const a=Number(s);return Number.isFinite(a)?Math.min(Math.max(a,0),100):null},me=s=>!!(s!=null&&s.isFullyRedeemed||(s==null?void 0:s.redemptionStatus)==="redeemed"),ce=({value:s,onValueChange:a,options:p,ariaLabel:c})=>{const[b,v]=r.useState(!1),C=r.useRef(null);r.useEffect(()=>{const o=u=>{var w;(w=C.current)!=null&&w.contains(u.target)||v(!1)};return document.addEventListener("mousedown",o),document.addEventListener("touchstart",o),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("touchstart",o)}},[]);const y=p.find(o=>o.value===s)??p[0],l=o=>{a(o),v(!1)};return e.jsxs("div",{ref:C,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>v(o=>!o),className:`inline-flex items-center gap-2 rounded-xl border px-3 py-2 text-xs font-semibold transition focus:outline-none focus:ring-2 focus:ring-blue-100 ${b?"border-blue-400 bg-white text-blue-600":"border-slate-200 bg-white text-slate-600 hover:border-blue-300"}`,"aria-label":c,"aria-haspopup":"listbox","aria-expanded":b,children:[e.jsx("span",{children:y==null?void 0:y.label}),e.jsx(Xe,{size:14,className:`transition ${b?"rotate-180 text-blue-500":"text-slate-400"}`})]}),b&&e.jsx("div",{className:"absolute left-0 top-[calc(100%+0.35rem)] z-30 w-40 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg",children:e.jsx("ul",{className:"max-h-48 overflow-y-auto py-1",role:"listbox",children:p.map(o=>{const u=o.value===s;return e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>l(o.value),className:`flex w-full items-center justify-between px-3 py-2 text-xs font-semibold transition ${u?"bg-blue-50 text-blue-600":"text-slate-600 hover:bg-slate-50"}`,role:"option","aria-selected":u,children:[o.label,u&&e.jsx("span",{className:"text-[10px] font-bold uppercase text-blue-500",children:"Selected"})]})},o.value)})})})]})},mt=s=>(Array.isArray(s)?s:[]).map((a,p)=>({"#":p+1,Code:a.code||"",Type:a.type==="single"?"Single use":"Multi use","Discount (%)":Number(a.discountValue)||0,"Max Discount Amount":z(a.maxDiscountAmount),"Min Order Amount":z(a.minOrderAmount),"Total Redemptions":re(a.maxRedemptions??a.totalRedemptions),"Per User Limit":re(a.maxRedemptionsPerUser??a.perUserLimit),"Usage Count":Number(a.usageCount)||0,"Remaining Redemptions":a.remainingRedemptions===null||a.remainingRedemptions===void 0?"Unlimited":Number(a.remainingRedemptions),Status:a.isActive===!1?"Inactive":a.redemptionStatus==="redeemed"?"Redeemed":"Active","Start Date":V(a.startDate),"End Date":V(a.endDate),Active:dt(a.isActive!==!1),"Created At":oe(a.createdAt),"Updated At":oe(a.updatedAt)})),Et=()=>{const s=Ye(),{user:a,logout:p}=Ve(),{items:c,status:b,error:v,mutationStatus:C,mutationError:y}=He(t=>t.adminCoupons),[l,o]=r.useState(Y()),[u,w]=r.useState(null),[ue,T]=r.useState(!1),[_,H]=r.useState(!1),[F,Q]=r.useState("all"),[P,W]=r.useState("all"),[O,Z]=r.useState(""),[E,ee]=r.useState(""),[U,M]=r.useState([]),$=r.useRef(null),B=!!u,A=Number(l.count||"1"),j=!B&&Number.isFinite(A)&&A>1,D=b==="loading",h=C==="loading",g=r.useMemo(()=>{const t=de(O),n=de(E);return c.filter(i=>{if(F!=="all"&&i.type!==F||!(()=>{switch(P){case"active":return i.isActive!==!1;case"inactive":return i.isActive===!1;case"redeemed":return me(i);case"not-redeemed":return!me(i);default:return!0}})())return!1;const N=Number(i.discountValue)||0;return!(t!==null&&N<t||n!==null&&N>n)})},[c,E,O,P,F]),S=r.useMemo(()=>g.map(t=>t!=null&&t._id?String(t._id):null).filter(Boolean),[g]),R=S.length>0&&S.every(t=>U.includes(t)),k=U.length,L=k>0,xe=F!=="all"||P!=="all"||O!==""||E!=="",pe=g.length===0?c.length===0?"No coupons found. Create a coupon to get started.":"No coupons match the selected filters.":"";r.useEffect(()=>{M(t=>t.filter(n=>S.includes(n)))},[S]),r.useEffect(()=>{$.current&&($.current.indeterminate=!R&&k>0)},[R,k]),r.useEffect(()=>{b==="idle"&&s(J())},[s,b]),r.useEffect(()=>{C==="failed"&&y&&m.error(y)},[C,y]);const be=r.useCallback(()=>{Q("all"),W("all"),Z(""),ee("")},[]),fe=r.useMemo(()=>{const t=c.length,n=c.filter(x=>x.isActive!==!1).length,i=c.filter(x=>x.type==="single").length,d=c.filter(x=>x.type==="multi").length,N=c.filter(x=>x.type==="single"&&x.isActive===!1).length,q=c.filter(x=>x.type==="multi"&&x.isActive===!1).length,I=c.filter(x=>x.isFullyRedeemed).length,Oe=t-I;return[{key:"total",label:"Total Coupons",value:t,icon:Qe,badgeClass:"bg-blue-50 text-blue-600"},{key:"active",label:"Active",value:n,icon:We,badgeClass:"bg-emerald-50 text-emerald-600"},{key:"single",label:"Single Use",value:i,icon:Ze,badgeClass:"bg-violet-50 text-violet-600"},{key:"multi",label:"Multi Use",value:d,icon:et,badgeClass:"bg-amber-50 text-amber-600"},{key:"expired-single",label:"Expired Single Use",value:N,icon:ot,badgeClass:"bg-slate-100 text-slate-600"},{key:"expired-multi",label:"Expired Multi Use",value:q,icon:tt,badgeClass:"bg-orange-50 text-orange-600"},{key:"redeemed",label:"Redeemed Coupons",value:I,icon:st,badgeClass:"bg-emerald-50 text-emerald-600"},{key:"not-redeemed",label:"Not Redeemed",value:Oe,icon:at,badgeClass:"bg-blue-50 text-blue-600"}]},[c]),te=t=>{o(n=>({...Y(t==="multi"?"multi":"single"),count:n.count||"1"})),w(n=>n&&n.type!==t?null:n)},he=async()=>{H(!0);try{const t=await qe();o(n=>({...n,code:t})),m.success("Generated coupon code")}catch(t){m.error(t.message||"Unable to generate code")}finally{H(!1)}},G=r.useCallback(()=>{o(Y()),w(null)},[]),f=t=>n=>{const{value:i}=n.target;o(d=>({...d,[t]:i}))},ge=t=>n=>{const{checked:i}=n.target;o(d=>({...d,[t]:i}))},Ne=()=>{if(!j&&!l.code.trim())return m.error("Coupon code is required"),!1;const t=Number(l.discountValue);if(!Number.isFinite(t)||t<1||t>100)return m.error("Discount must be between 1 and 100"),!1;const n=l.minOrderAmount.trim();if(n&&Number(n)<0)return m.error("Minimum order amount cannot be negative"),!1;if(l.type==="multi"){if(l.maxRedemptions.trim()){const i=Number(l.maxRedemptions);if(!Number.isFinite(i)||i<1)return m.error("Total redemptions must be at least 1"),!1}if(l.maxRedemptionsPerUser.trim()){const i=Number(l.maxRedemptionsPerUser);if(!Number.isFinite(i)||i<1)return m.error("Per user limit must be at least 1"),!1}}if(l.startDate&&l.endDate){const i=new Date(l.startDate),d=new Date(l.endDate);if(!Number.isNaN(i.getTime())&&!Number.isNaN(d.getTime())&&i>d)return m.error("End date must be after start date"),!1}return!B&&(!Number.isFinite(A)||A<1)?(m.error("Count must be at least 1"),!1):!0},ye=()=>{const t=l.type==="multi"?"multi":"single";return{code:l.code.trim().toUpperCase(),description:l.description.trim()||void 0,type:t,discountValue:Number(l.discountValue),maxDiscountAmount:l.maxDiscountAmount.trim()?Number(l.maxDiscountAmount):null,minOrderAmount:l.minOrderAmount.trim()?Number(l.minOrderAmount):0,maxRedemptions:t==="single"?1:l.maxRedemptions.trim()?Number(l.maxRedemptions):null,maxRedemptionsPerUser:t==="single"?1:l.maxRedemptionsPerUser.trim()?Number(l.maxRedemptionsPerUser):null,startDate:l.startDate||null,endDate:l.endDate||null,isActive:!!l.isActive}},je=async t=>{if(t.preventDefault(),h||!Ne())return;const n=ye();try{u!=null&&u._id?(await s($e({id:u._id,payload:n})).unwrap(),m.success("Coupon updated successfully")):j?(await s(Be({...n,count:A})).unwrap(),m.success(`Created ${A} coupons`)):(await s(Ge(n)).unwrap(),m.success("Coupon created successfully")),G(),b!=="loading"&&s(J())}catch(i){const d=(i==null?void 0:i.message)||"Unable to save coupon. Please try again.";m.error(d)}},ve=t=>{t&&(w(t),o({code:t.code||"",description:t.description||"",type:t.type||"single",discountValue:t.discountValue!==void 0?String(t.discountValue):"",maxDiscountAmount:t.maxDiscountAmount!==void 0&&t.maxDiscountAmount!==null?String(t.maxDiscountAmount):"",minOrderAmount:t.minOrderAmount!==void 0&&t.minOrderAmount!==null?String(t.minOrderAmount):"",maxRedemptions:t.type==="single"?"1":t.maxRedemptions!==void 0&&t.maxRedemptions!==null?String(t.maxRedemptions):"",maxRedemptionsPerUser:t.type==="single"?"1":t.maxRedemptionsPerUser!==void 0&&t.maxRedemptionsPerUser!==null?String(t.maxRedemptionsPerUser):"",startDate:ie(t.startDate),endDate:ie(t.endDate),isActive:t.isActive!==!1,count:"1"}),window.scrollTo({top:0,behavior:"smooth"}))},Ce=async t=>{if(!(!(t!=null&&t._id)||!window.confirm(`Delete coupon "${t.code}"? This action cannot be undone.`)))try{await s(Je(t._id)).unwrap(),m.success("Coupon deleted"),M(i=>i.filter(d=>d!==String(t._id)))}catch(i){const d=(i==null?void 0:i.message)||"Unable to delete coupon. Please try again.";m.error(d)}},we=r.useCallback(()=>{M(t=>R?[]:[...S])},[R,S]),Ae=r.useCallback(t=>{if(!t)return;const n=String(t);M(i=>i.includes(n)?i.filter(d=>d!==n):[...i,n])},[]),De=r.useCallback(async()=>{if(!(!L||!window.confirm(`Delete ${k} selected coupon${k>1?"s":""}? This action cannot be undone.`)))try{await s(ze(U)).unwrap(),m.success("Selected coupons deleted"),M([])}catch(n){const i=(n==null?void 0:n.message)||"Failed to delete selected coupons. Please retry.";m.error(i)}},[s,L,k,U,b]),Se=()=>{s(J())},Re=r.useCallback(()=>{if(!Array.isArray(g)||g.length===0){m.error("No coupons available to export");return}try{const t=mt(g);if(!t.length){m.error("No coupons available to export");return}const n=X.json_to_sheet(t),i=X.book_new();X.book_append_sheet(i,n,"Coupons");const d=new Date,N=d.toISOString().slice(0,10),q=d.toISOString().slice(11,19).replace(/:/g,""),I=`coupons-${N}-${q}.xlsx`;Ee(i,I),m.success("Coupons exported successfully")}catch(t){console.error("Failed to export coupons",t),m.error("Unable to export coupons. Please try again.")}},[c]),ke=t=>{const n=t.isActive!==!1,i=n?"bg-emerald-50 text-emerald-600":"bg-slate-200 text-slate-600";return e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${i}`,children:n?"Active":"Inactive"})},Fe=t=>{const n=!!t.isFullyRedeemed,i=n?"bg-rose-50 text-rose-600":"bg-blue-50 text-blue-600";return e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${i}`,children:n?"Redeemed":"Not Redeemed"})},Ue=t=>{const n=t.type==="single",i=n?"bg-violet-50 text-violet-600":"bg-amber-50 text-amber-600";return e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${i}`,children:n?"Single Use":"Multi Use"})},Me=t=>t.type==="single"?t.usageCount>=1?"0 of 1":"1 of 1":t.maxRedemptions?`${Math.max(t.maxRedemptions-(t.usageCount||0),0)} of ${t.maxRedemptions}`:"Unlimited",Te=()=>e.jsxs("form",{onSubmit:je,className:"space-y-5",noValidate:!0,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3 sm:items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:u?"Update Coupon":"Create Coupon"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Configure single-use and multi-use coupons for promotions."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:Se,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm font-medium text-slate-600 transition hover:border-blue-200 hover:text-blue-600",disabled:D,children:[e.jsx(lt,{size:16,className:D?"animate-spin":""}),"Refresh"]}),u&&e.jsxs("button",{type:"button",onClick:G,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-sm font-medium text-rose-600 transition hover:bg-rose-100",disabled:h,children:[e.jsx(_e,{size:16})," Cancel edit"]})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[e.jsx("button",{type:"button",onClick:()=>te("single"),className:`w-full rounded-xl border px-3 py-2 text-sm font-medium transition sm:flex-1 ${l.type==="single"?"border-blue-500 bg-blue-50 text-blue-600":"border-slate-200 text-slate-500 hover:border-blue-200 hover:text-blue-600"}`,children:"Single use"}),e.jsx("button",{type:"button",onClick:()=>te("multi"),className:`w-full rounded-xl border px-3 py-2 text-sm font-medium transition sm:flex-1 ${l.type==="multi"?"border-blue-500 bg-blue-50 text-blue-600":"border-slate-200 text-slate-500 hover:border-blue-200 hover:text-blue-600"}`,children:"Multi use"})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-code",className:"text-sm font-medium text-slate-600",children:"Coupon Code"}),e.jsxs("div",{className:"mt-1 flex flex-col gap-3 sm:flex-row sm:items-center",children:[e.jsx("input",{id:"coupon-code",name:"code",type:"text",value:l.code,onChange:f("code"),className:"flex-1 rounded-xl border border-slate-200 px-3 py-2 text-sm uppercase tracking-wider text-slate-700 focus:border-blue-500 focus:outline-none",placeholder:j?"Auto-generated":"MEGA50",maxLength:20,required:!j,disabled:j}),e.jsxs("button",{type:"button",onClick:he,className:"inline-flex items-center justify-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm font-medium text-slate-600 transition hover:border-blue-200 hover:text-blue-600",disabled:_||h||j,children:[_?e.jsx(K,{size:16,className:"animate-spin"}):e.jsx(le,{size:16}),"Generate"]})]}),j&&e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Codes will be generated automatically for bulk creation."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-description",className:"text-sm font-medium text-slate-600",children:"Description"}),e.jsx("textarea",{id:"coupon-description",name:"description",value:l.description,onChange:f("description"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none",rows:2,placeholder:"E.g. 15% off on prepaid orders"})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-discount-value",className:"text-sm font-medium text-slate-600",children:"Discount (%)"}),e.jsx("input",{id:"coupon-discount-value",name:"discountValue",type:"number",min:1,max:100,value:l.discountValue,onChange:f("discountValue"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none",placeholder:"10",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-max-discount",className:"text-sm font-medium text-slate-600",children:"Max Discount Amount (optional)"}),e.jsx("input",{id:"coupon-max-discount",name:"maxDiscountAmount",type:"number",min:0,value:l.maxDiscountAmount,onChange:f("maxDiscountAmount"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none",placeholder:"500"})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-min-order",className:"text-sm font-medium text-slate-600",children:"Minimum Order Amount"}),e.jsx("input",{id:"coupon-min-order",name:"minOrderAmount",type:"number",min:0,value:l.minOrderAmount,onChange:f("minOrderAmount"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none",placeholder:"1000"})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-6",children:[e.jsx("input",{id:"coupon-active",type:"checkbox",checked:l.isActive,onChange:ge("isActive"),className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"coupon-active",className:"text-sm text-slate-600",children:"Mark as active immediately"})]})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Usage limits"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Configure how many times the coupon can be redeemed overall and per customer."}),e.jsxs("div",{className:"mt-4 space-y-4",children:[!B&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-count",className:"text-sm font-medium text-slate-600",children:"Number of coupons to generate"}),e.jsx("input",{id:"coupon-count",name:"count",type:"number",min:1,max:200,value:l.count,onChange:f("count"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none",placeholder:"1"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"A unique code will be generated for each coupon when count is greater than 1."})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"coupon-max-redemptions",className:"text-sm font-medium text-slate-600",children:["Total Redemptions",l.type==="multi"?" (leave blank for unlimited)":""]}),e.jsx("input",{id:"coupon-max-redemptions",name:"maxRedemptions",type:"number",min:l.type==="single"?1:0,value:l.maxRedemptions,onChange:f("maxRedemptions"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none",placeholder:l.type==="single"?"1":"Unlimited",disabled:l.type==="single"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"coupon-max-redemptions-per-user",className:"text-sm font-medium text-slate-600",children:["Per Customer Limit",l.type==="multi"?" (leave blank for unlimited)":""]}),e.jsx("input",{id:"coupon-max-redemptions-per-user",name:"maxRedemptionsPerUser",type:"number",min:l.type==="single"?1:0,value:l.maxRedemptionsPerUser,onChange:f("maxRedemptionsPerUser"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none",placeholder:l.type==="single"?"1":"Unlimited",disabled:l.type==="single"})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-start-date",className:"text-sm font-medium text-slate-600",children:"Start Date"}),e.jsx("input",{id:"coupon-start-date",name:"startDate",type:"date",value:l.startDate,onChange:f("startDate"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coupon-end-date",className:"text-sm font-medium text-slate-600",children:"End Date"}),e.jsx("input",{id:"coupon-end-date",name:"endDate",type:"date",value:l.endDate,onChange:f("endDate"),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap items-center gap-3",children:[e.jsxs("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-blue-200 transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:h||_,children:[h?e.jsx(K,{size:16,className:"animate-spin"}):e.jsx(le,{size:16}),u?"Update Coupon":"Create Coupon"]}),e.jsx("button",{type:"button",onClick:G,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 transition hover:border-blue-200 hover:text-blue-600",disabled:h,children:"Reset"})]})]})]})]}),Pe=()=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-2 border-b border-slate-100 px-4 py-4 sm:flex-row sm:flex-wrap sm:items-center sm:justify-between sm:px-5",children:[e.jsx("div",{className:"space-y-1",children:e.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"Coupons"})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 shadow-sm",children:[e.jsx(ce,{value:F,onValueChange:Q,options:[{value:"all",label:"All types"},{value:"single",label:"Single use"},{value:"multi",label:"Multi use"}],ariaLabel:"Filter coupons by type"}),e.jsx(ce,{value:P,onValueChange:W,options:[{value:"all",label:"All statuses"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"redeemed",label:"Redeemed"},{value:"not-redeemed",label:"Not redeemed"}],ariaLabel:"Filter coupons by status"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("label",{htmlFor:"filter-discount-min",className:"sr-only",children:"Minimum discount percentage"}),e.jsx("input",{id:"filter-discount-min",name:"filterDiscountMin",type:"number",min:0,max:100,value:O,onChange:t=>Z(t.target.value),className:"w-20 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-600 transition focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100",placeholder:"Min %","aria-label":"Minimum discount percentage"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"-"}),e.jsx("label",{htmlFor:"filter-discount-max",className:"sr-only",children:"Maximum discount percentage"}),e.jsx("input",{id:"filter-discount-max",name:"filterDiscountMax",type:"number",min:0,max:100,value:E,onChange:t=>ee(t.target.value),className:"w-20 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-600 transition focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100",placeholder:"Max %","aria-label":"Maximum discount percentage"})]}),e.jsx("button",{type:"button",onClick:be,className:"text-xs font-semibold text-slate-500 transition hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-50",disabled:!xe,children:"Reset"})]}),e.jsxs("button",{type:"button",onClick:De,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs font-medium text-rose-600 transition hover:bg-rose-100 disabled:cursor-not-allowed disabled:opacity-60",disabled:!L||h,children:[e.jsx(ne,{size:14})," Delete selected"]}),e.jsxs("button",{type:"button",onClick:Re,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 transition hover:border-blue-200 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-60",disabled:D||c.length===0,children:[e.jsx(nt,{size:14})," Export"]})]})]}),v&&e.jsx("div",{className:"border-b border-amber-100 bg-amber-50 px-4 py-3 text-sm text-amber-700 sm:px-5",children:v}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-100 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs uppercase tracking-wide text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3",children:e.jsx("input",{ref:$,type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:R&&L,onChange:we,"aria-label":R?"Deselect all coupons":"Select all coupons"})}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Code"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Type"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Discount"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Min Order"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Usage"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Date Range"}),e.jsx("th",{className:"px-5 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[D&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-6 text-center text-slate-500 sm:px-5",children:e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-4 py-2 text-sm",children:[e.jsx(K,{size:16,className:"animate-spin text-blue-500"}),"Loading coupons..."]})})}),!D&&g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-6 text-center text-slate-500 sm:px-5",children:pe})}),!D&&g.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-4 align-top sm:px-5",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:U.includes(String(t._id)),onChange:()=>Ae(t._id),"aria-label":`Select coupon ${t.code}`})}),e.jsx("td",{className:"px-4 py-4 align-top sm:px-5",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:t.code}),t.description&&e.jsx("p",{className:"text-xs text-slate-500",children:t.description})]})}),e.jsx("td",{className:"px-4 py-4 align-top sm:px-5",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[Ue(t),e.jsx("p",{className:"text-xs text-slate-500",children:t.type==="single"?"One-time use":"Reusable with limits"})]})}),e.jsxs("td",{className:"px-4 py-4 align-top sm:px-5",children:[e.jsxs("p",{className:"font-medium text-slate-900",children:[t.discountValue,"%"]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Cap: ",z(t.maxDiscountAmount)]})]}),e.jsx("td",{className:"px-4 py-4 align-top sm:px-5",children:e.jsx("p",{className:"font-medium text-slate-900",children:z(t.minOrderAmount)})}),e.jsxs("td",{className:"px-4 py-4 align-top sm:px-5",children:[e.jsx("p",{className:"font-medium text-slate-900",children:Me(t)}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Used ",t.usageCount||0," times"]})]}),e.jsxs("td",{className:"px-4 py-4 align-top sm:px-5",children:[e.jsx("p",{className:"font-medium text-slate-900",children:t.startDate?V(t.startDate):"Immediately"}),e.jsx("p",{className:"text-xs text-slate-500",children:t.endDate?V(t.endDate):"No end date"})]}),e.jsx("td",{className:"px-4 py-4 align-top sm:px-5",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ke(t),Fe(t)]})}),e.jsx("td",{className:"px-4 py-4 align-top text-right sm:px-5",children:e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>ve(t),className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 transition hover:border-blue-200 hover:text-blue-600",children:e.jsx(it,{size:14})}),e.jsx("button",{type:"button",onClick:()=>Ce(t),className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs font-medium text-rose-600 transition hover:bg-rose-100",disabled:h,children:e.jsx(ne,{size:14})})]})})]},t._id))]})]})})]});return e.jsx("div",{className:"min-h-screen bg-slate-50 text-slate-900",children:e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(ae,{active:"Coupons",className:"hidden lg:flex lg:w-64 lg:flex-none",onNavigate:()=>T(!1)}),e.jsx(Le,{children:ue&&e.jsxs(se.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex md:hidden",children:[e.jsx(se.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:220,damping:24},className:"bg-white w-72 max-w-sm h-full shadow-xl",children:e.jsx(ae,{active:"Coupons",className:"flex w-full",onNavigate:()=>T(!1)})}),e.jsx("button",{type:"button",onClick:()=>T(!1),className:"flex-1 bg-black/30","aria-label":"Close sidebar"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(Ke,{onToggleSidebar:()=>T(t=>!t),activeRange:"All Date",onSelectRange:()=>{},adminName:(a==null?void 0:a.name)||(a==null?void 0:a.username)||"Admin",adminRole:(a==null?void 0:a.role)==="admin"?"Administrator":a==null?void 0:a.role,notifications:null,showRangeSelector:!1,showNotifications:!1,onLogout:p}),e.jsxs("main",{className:"flex-1 overflow-y-auto px-4 py-6 md:px-8 space-y-6",children:[e.jsx("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4",children:fe.map(({key:t,label:n,value:i,icon:d,badgeClass:N})=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:n}),e.jsx("span",{className:`inline-flex items-center justify-center rounded-full px-3 py-1 text-xs font-semibold ${N}`,children:e.jsx(d,{size:16})})]}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:i})]},t))}),e.jsx("section",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:Te()}),e.jsx("section",{children:Pe()})]})]})]})})};export{Et as default};
