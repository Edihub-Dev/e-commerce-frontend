import{r as o,j as s,A as _,m as u}from"./vendor-2d1PFKo4.js";import{S as j}from"./Sidebar-Blgfai62.js";import{N as C}from"./Navbar-K_t1OsQh.js";import{A as R}from"./AdminUsersTable-44eNCRRk.js";import{I as y}from"./index-Bpx0OnSg.js";import{f as I}from"./adminUsersApi-JfDqj20M.js";import{R as L}from"./refresh-cw-DQoxs3YL.js";import"./react-BzrpNAyj.js";import"./house-Bx4yg0fx.js";import"./ticket-percent-OJlGKFU7.js";import"./package-C_UWcLgd.js";import"./shopping-bag-Dv9EZFsL.js";import"./arrow-left-fjWLrcm4.js";import"./log-out-BEyQjTNl.js";import"./eye-DjBlpBi-.js";import"./trash-2-Chc1geHF.js";import"./shield-check-ZginSkgb.js";import"./shield-alert-l_ssT4iu.js";import"./pencil-line-CoX3LYzN.js";import"./info-GXZN73e0.js";const Z=()=>{const[a,n]=o.useState([]),[N,b]=o.useState(!0),[m,g]=o.useState(!1),[x,f]=o.useState(""),[v,c]=o.useState(!1),{user:i,logout:w}=y(),p=async({silent:e}={silent:!1})=>{try{e?g(!0):b(!0);const t=await I(),r=Array.isArray(t)?t.filter(h=>{const l=String(h.role).toLowerCase();return l==="customer"||l==="admin"}):[];n(r),f("")}catch(t){console.error("Failed to load users",t),f(t.message||"Unable to load users. Please try again.")}finally{e?g(!1):b(!1)}};o.useEffect(()=>{p()},[]);const A=e=>{if(e!=null&&e.__delete){n(t=>t.filter(r=>r._id!==e._id));return}if(e!=null&&e.__bulkDelete&&Array.isArray(e.deletedIds)){n(t=>t.filter(r=>!e.deletedIds.includes(r._id)));return}e!=null&&e._id&&n(t=>t.map(r=>r._id===e._id?{...r,...e}:r))},d=o.useMemo(()=>{const e=a.length,t=a.filter(l=>String(l.role).toLowerCase()==="admin").length,r=a.filter(l=>l.isVerified).length,h=a.filter(l=>String(l.role).toLowerCase()==="customer").length;return{total:e,admins:t,customers:h,verified:r}},[a]),S=()=>{m||p({silent:!0})};return s.jsx("div",{className:"min-h-screen md:h-screen bg-slate-50 text-slate-900 overflow-x-hidden",children:s.jsxs("div",{className:"flex md:h-screen",children:[s.jsx(j,{active:"Customers",className:"hidden md:flex md:w-64 md:flex-none",onNavigate:()=>c(!1)}),s.jsx(_,{children:v&&s.jsxs(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex md:hidden",children:[s.jsx(u.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:220,damping:24},className:"bg-white w-72 max-w-sm h-full shadow-xl",children:s.jsx(j,{active:"Customers",className:"flex w-full",onNavigate:()=>c(!1)})}),s.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 bg-black/30","aria-label":"Close sidebar"})]})}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx(C,{onToggleSidebar:()=>c(e=>!e),activeRange:"All Time",onSelectRange:()=>{},adminName:(i==null?void 0:i.name)||(i==null?void 0:i.username)||"Admin",adminRole:(i==null?void 0:i.role)==="admin"?"Administrator":i==null?void 0:i.role,notifications:{pendingOrders:0,shippedOrders:0,deliveredOrders:0},showRangeSelector:!1,showNotifications:!1,onLogout:w}),s.jsxs("main",{className:"flex-1 overflow-y-auto px-4 py-6 md:px-8 space-y-6",children:[s.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm text-slate-500",children:"Dashboard / Customers"}),s.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Customers & Admins"})]}),s.jsxs("button",{type:"button",onClick:S,disabled:m,className:"inline-flex items-center justify-center gap-2 rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 transition hover:border-blue-200 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-60",children:[s.jsx(L,{size:16,className:m?"animate-spin":void 0}),m?"Refreshing":"Refresh"]})]}),s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-4",children:[s.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[s.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Total Accounts"}),s.jsx("p",{className:"mt-2 text-2xl font-semibold",children:d.total})]}),s.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[s.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Customers"}),s.jsx("p",{className:"mt-2 text-2xl font-semibold text-blue-600",children:d.customers})]}),s.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[s.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Admins"}),s.jsx("p",{className:"mt-2 text-2xl font-semibold text-violet-600",children:d.admins})]}),s.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[s.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Verified Accounts"}),s.jsx("p",{className:"mt-2 text-2xl font-semibold text-emerald-600",children:d.verified})]})]}),x&&s.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600",children:x}),s.jsx(R,{users:a,isLoading:N,error:x,onUserUpdated:e=>{A(e),!(e!=null&&e.__bulkDelete||e!=null&&e.__delete)&&e!=null&&e._id&&f("")},enableManagement:!0})]})]})]})})};export{Z as default};
