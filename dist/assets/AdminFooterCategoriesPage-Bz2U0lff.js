import{r as l,j as e,A as J,m as E}from"./vendor-2d1PFKo4.js";import{c as P,I as K,aQ as X,C as n,aR as Y,aS as Z,aT as ee,aU as se,aV as te}from"./index-Bpx0OnSg.js";import{S as I}from"./Sidebar-Blgfai62.js";import{N as ae}from"./Navbar-K_t1OsQh.js";import{L as f}from"./loader-circle-DRAKHMK_.js";import{T as re}from"./trash-2-Chc1geHF.js";import{S as ie}from"./save-DdNriqD8.js";import{P as le}from"./plus-BZuZgauU.js";import"./react-BzrpNAyj.js";import"./house-Bx4yg0fx.js";import"./ticket-percent-OJlGKFU7.js";import"./package-C_UWcLgd.js";import"./shopping-bag-Dv9EZFsL.js";import"./arrow-left-fjWLrcm4.js";import"./log-out-BEyQjTNl.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],ne=P("arrow-down",oe);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],ce=P("arrow-up",de),xe=72,b=(i="")=>i.toString().trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").replace(/-{2,}/g,"-"),ke=()=>{const{user:i,logout:H}=K(),[m,u]=l.useState([]),[y,T]=l.useState([]),[U,h]=l.useState(!1),[A,k]=l.useState(!1),[F,V]=l.useState(!1),[j,_]=l.useState(!1),[N,D]=l.useState(!1),[L,v]=l.useState({}),[o,p]=l.useState({name:"",slug:"",isVisible:!0,priority:0}),R=l.useMemo(()=>new Set(m.map(s=>s.slug)),[m]),g=l.useMemo(()=>y.length?y.filter(s=>s.slug&&!R.has(s.slug)):[],[y,R]),z=async(s=!0)=>{s?k(!0):V(!0);try{const t=await X(),a=Array.isArray(t.data)?t.data:[];u(a),v({})}catch(t){console.error("Failed to load footer categories",t),n.error(t.message||"Failed to load footer categories")}finally{k(!1),V(!1)}},w=async()=>{try{const s=await Y();T(Array.isArray(s.data)?s.data:[])}catch(s){console.error("Failed to load available categories",s),n.error(s.message||"Failed to load available categories")}};l.useEffect(()=>{z(),w()},[]),l.useEffect(()=>{p(s=>{if(s.name)return s;const t=g[0];return t?{...s,name:t.name,slug:t.slug}:s})},[g]);const C=(s,t)=>{v(a=>({...a,[s]:{...a[s],...t}}))},S=s=>{const t=L[s._id];return t?{priority:t.priority!==void 0?t.priority:s.priority??0,isVisible:t.isVisible!==void 0?t.isVisible:s.isVisible!==!1,slug:t.slug!==void 0?t.slug:s.slug||""}:{priority:s.priority??0,isVisible:s.isVisible!==!1,slug:s.slug||""}},$=s=>{if(!L[s._id])return!1;const a=S(s);return a.priority!==(s.priority??0)||a.isVisible!==(s.isVisible!==!1)||a.slug!==(s.slug||"")},q=s=>{v(t=>{if(!t[s])return t;const a={...t};return delete a[s],a})},O=async s=>{if(s.preventDefault(),!o.name){n.error("Select a category to add");return}const t={name:o.name,slug:o.slug||b(o.name),isVisible:!!o.isVisible,priority:Number.isFinite(Number(o.priority))?Number(o.priority):0};_(!0);try{const a=await te(t),d=a.data||a;n.success("Footer category added"),u(c=>[...c,d].sort((x,r)=>(x.priority??0)-(r.priority??0))),p({name:"",slug:"",isVisible:!0,priority:0}),await w()}catch(a){console.error("Failed to create footer category",a),n.error(a.message||"Failed to create footer category")}finally{_(!1)}},B=async s=>{const t=S(s);try{const a=await se(s._id,{slug:t.slug,isVisible:t.isVisible,priority:t.priority}),d=a.data||a;n.success("Category updated"),u(c=>c.map(x=>x._id===d._id?d:x).sort((x,r)=>(x.priority??0)-(r.priority??0))),q(s._id)}catch(a){console.error("Failed to update footer category",a),n.error(a.message||"Failed to update category")}},G=async s=>{if(window.confirm("Remove this category from the footer?"))try{await ee(s),n.success("Category removed"),u(t=>t.filter(a=>a._id!==s)),await w()}catch(t){console.error("Failed to delete footer category",t),n.error(t.message||"Failed to delete category")}},M=async(s,t)=>{const a=m.findIndex(r=>r._id===s);if(a<0)return;const d=t==="up"?a-1:a+1;if(d<0||d>=m.length)return;const c=[...m],[x]=c.splice(a,1);c.splice(d,0,x),D(!0);try{const r=await Z(c.map(W=>W._id)),Q=Array.isArray(r.data)?r.data:c;u(Q),n.success("Category order updated")}catch(r){console.error("Failed to reorder categories",r),n.error(r.message||"Failed to reorder categories")}finally{D(!1)}};return e.jsx("div",{className:"min-h-screen bg-slate-50 text-slate-900",children:e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(I,{active:"Footer Categories",className:"hidden lg:flex lg:w-64 lg:flex-none",onNavigate:()=>h(!1)}),e.jsx(J,{children:U&&e.jsxs(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex lg:hidden",children:[e.jsx(E.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:220,damping:24},className:"bg-white w-72 max-w-sm h-full shadow-xl",children:e.jsx(I,{active:"Footer Categories",className:"flex w-full",onNavigate:()=>h(!1)})}),e.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 bg-black/30","aria-label":"Close navigation"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(ae,{onToggleSidebar:()=>h(s=>!s),adminName:(i==null?void 0:i.name)||(i==null?void 0:i.username)||"Admin",adminRole:(i==null?void 0:i.role)==="admin"?"Administrator":i==null?void 0:i.role,onLogout:H,activeRange:"All Date",onSelectRange:()=>{},showRangeSelector:!1,showNotifications:!1}),e.jsx("main",{className:"flex-1 overflow-y-auto",style:{maxHeight:`calc(100vh - ${xe}px)`},children:e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[e.jsxs("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Footer Categories"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Control which categories appear in the storefront footer and set their display priority."})]}),e.jsxs("button",{onClick:()=>z(!1),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-slate-200 text-sm font-medium text-slate-600 hover:border-blue-200 hover:text-blue-600 transition",disabled:F,children:[F?e.jsx(f,{size:16,className:"animate-spin"}):null,"Refresh"]})]}),e.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-100 flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-slate-600",children:"Active Categories"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Reorder to change priority. Lower numbers appear first in the footer."})]}),(A||N)&&e.jsx(f,{size:18,className:"animate-spin text-slate-400"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{className:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-6 py-3",children:"Category"}),e.jsx("th",{className:"px-6 py-3",children:"Slug"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Visible"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 text-sm",children:A?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-slate-500",children:e.jsxs("div",{className:"inline-flex items-center gap-3",children:[e.jsx(f,{size:20,className:"animate-spin"}),"Loading categoriesâ€¦"]})})}):m.length?m.map((s,t)=>{const a=S(s),d=$(s),c=t===0||N,x=t===m.length-1||N;return e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:s.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Created"," ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",value:a.slug,onChange:r=>C(s._id,{slug:b(r.target.value)}),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-200",placeholder:"category-slug"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("input",{type:"number",min:0,value:a.priority,onChange:r=>C(s._id,{priority:Number(r.target.value)}),className:"w-24 px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-200 mx-auto"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.isVisible,onChange:r=>C(s._id,{isVisible:r.target.checked}),className:"h-4 w-4 text-blue-600 border-slate-300 rounded"}),e.jsx("span",{className:"text-xs text-slate-500",children:a.isVisible?"Shown":"Hidden"})]})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>M(s._id,"up"),disabled:c,className:"p-2 rounded-lg border border-slate-200 text-slate-500 hover:text-blue-600 hover:border-blue-200 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Move up",children:e.jsx(ce,{size:16})}),e.jsx("button",{type:"button",onClick:()=>M(s._id,"down"),disabled:x,className:"p-2 rounded-lg border border-slate-200 text-slate-500 hover:text-blue-600 hover:border-blue-200 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Move down",children:e.jsx(ne,{size:16})}),e.jsx("button",{type:"button",onClick:()=>G(s._id),className:"p-2 rounded-lg border border-rose-100 text-rose-500 hover:bg-rose-50","aria-label":"Delete category",children:e.jsx(re,{size:16})}),e.jsxs("button",{type:"button",onClick:()=>B(s),disabled:!d,className:"inline-flex items-center gap-1 px-3 py-2 rounded-lg bg-blue-600 text-white text-xs font-semibold hover:bg-blue-700 disabled:opacity-40",children:[e.jsx(ie,{size:14})," Save"]})]})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-slate-500",children:"No footer categories configured yet."})})})]})})]}),e.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm p-6 space-y-6",children:[e.jsx("header",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-slate-600",children:"Add category to footer"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Pick a product category and configure its footer visibility."})]})}),e.jsxs("form",{onSubmit:O,className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Category"}),e.jsxs("select",{value:o.name,onChange:s=>{const t=g.find(a=>a.name===s.target.value);p(a=>({...a,name:(t==null?void 0:t.name)||"",slug:(t==null?void 0:t.slug)||b(s.target.value)}))},className:"px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-200",children:[e.jsx("option",{value:"",disabled:!0,children:g.length?"Select category":"No categories available"}),g.map(s=>e.jsx("option",{value:s.name,children:s.name},s.slug))]})]}),e.jsxs("label",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Slug"}),e.jsx("input",{type:"text",value:o.slug,onChange:s=>p(t=>({...t,slug:b(s.target.value)})),className:"px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-200",placeholder:"category-slug"}),e.jsx("span",{className:"text-[11px] text-slate-400",children:"Used for footer links. Lowercase alphanumeric and hyphen only."})]}),e.jsxs("label",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Priority"}),e.jsx("input",{type:"number",min:0,value:o.priority,onChange:s=>p(t=>({...t,priority:Number(s.target.value)})),className:"px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-200"}),e.jsx("span",{className:"text-[11px] text-slate-400",children:"Lower numbers display earlier. Defaults to 0."})]}),e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:o.isVisible,onChange:s=>p(t=>({...t,isVisible:s.target.checked})),className:"h-4 w-4 text-blue-600 border-slate-300 rounded"}),e.jsx("span",{className:"text-sm text-slate-600",children:"Show in footer"})]}),e.jsx("div",{className:"md:col-span-2 lg:col-span-3 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:j||!o.name,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700 disabled:opacity-50",children:[j?e.jsx(f,{size:16,className:"animate-spin"}):e.jsx(le,{size:16}),j?"Adding":"Add Category"]})})]})]})]})})]})]})})};export{ke as default};
