import{r as p,j as e,A as H,m as R}from"./vendor-2d1PFKo4.js";import{X as De,aa as T,u as Me,I as $e,ab as Ue,ac as Oe,d as Be,C as _,ad as q,ae as Ve,af as Ge,ag as qe,ah as He,ai as We,aj as Xe,ak as Ye}from"./index-Bpx0OnSg.js";import{S as Ce}from"./Sidebar-Blgfai62.js";import{N as Ke}from"./Navbar-K_t1OsQh.js";import{L as fe}from"./loader-circle-DRAKHMK_.js";import{I as Ze}from"./image-o7Bv0ro0.js";import{C as Ae}from"./cloud-upload-CshyEAzQ.js";import{u as Je,a as Qe}from"./hooks-W65Onizy.js";import{D as et}from"./download-D5r73ZfU.js";import{P as tt}from"./plus-BZuZgauU.js";import{C as st}from"./calendar-jUZ4havw.js";import{F as at}from"./funnel-DrRYs2Xk.js";import{A as lt}from"./arrow-up-down-RiFGxrtj.js";import{S as pe}from"./star-DQTvdMJC.js";import{E as Pe}from"./eye-DjBlpBi-.js";import{P as he}from"./pencil-BZnjNrx9.js";import{T as Fe}from"./trash-2-Chc1geHF.js";import"./react-BzrpNAyj.js";import"./house-Bx4yg0fx.js";import"./ticket-percent-OJlGKFU7.js";import"./package-C_UWcLgd.js";import"./shopping-bag-Dv9EZFsL.js";import"./arrow-left-fjWLrcm4.js";import"./log-out-BEyQjTNl.js";const ze=["S","M","L","XL","XXL"],rt=[{matcher:/keychain/i,hsnCode:"8305",gstRate:18},{matcher:/ceramic\s+coffee\s+mug|coffee\s+mug|mug/i,hsnCode:"6912",gstRate:12},{matcher:/executive\s+diary|pen\s+set/i,hsnCode:"4820",gstRate:18},{matcher:/white\s+logo\s+cap|cap/i,hsnCode:"6501",gstRate:18},{matcher:/diary/i,hsnCode:"4820",gstRate:18},{matcher:/\bpen\b/i,hsnCode:"9608",gstRate:18},{matcher:/t\s*-?shirt|polo/i,hsnCode:"6109",gstRate:5}],it=(j="")=>{const u=j.toString().trim();return u&&rt.find(y=>y.matcher.test(u))||null},de=()=>ze.map(j=>({label:j,isAvailable:!0,stock:0})),Re=j=>{if(j==null)return"";const u=j.toString().trim().toUpperCase();if(!u)return"";if(/^P\d{1,2}$/.test(u))return u;const y=parseInt(u.replace(/[^0-9]/g,""),10);return!Number.isNaN(y)&&y>0?`P${y}`:""},Q=j=>{if(!Array.isArray(j)||!j.length)return de();const u=new Set,y=j.map(i=>{var v;const h=(v=i==null?void 0:i.label)==null?void 0:v.toString().trim().toUpperCase();return!h||u.has(h)?null:(u.add(h),{label:h,isAvailable:!!((i==null?void 0:i.isAvailable)??!0),stock:Math.max(Number((i==null?void 0:i.stock)??0),0)})}).filter(Boolean);return ze.forEach(i=>{u.has(i)||y.push({label:i,isAvailable:!0,stock:0})}),y.length?y:de()},nt=j=>(Array.isArray(j)?j:[]).reduce((y,i)=>{if(!i||!i.isAvailable)return y;const h=Number(i.stock??0);return Number.isFinite(h)?y+Math.max(h,0):y},0),M={name:"",sku:"",category:"",brand:"",categoryPriority:"",price:"",originalPrice:"",discountPercentage:"",saveAmount:"",stock:"",status:"published",availabilityStatus:"in_stock",thumbnail:"",description:"",gallery:[],isFeatured:!1,keyFeatures:[""],sizes:de(),showSizes:!1,hsnCode:"",gstRate:""},ot=[{label:"Published",value:"published"},{label:"Archived",value:"archived"}],ct=[{label:"In Stock",value:"in_stock"},{label:"Low Stock",value:"low_stock"},{label:"Out of Stock",value:"out_of_stock"},{label:"Preorder",value:"preorder"}],dt={hidden:{opacity:0,y:20},visible:{opacity:1,y:0},exit:{opacity:0,y:20}},ye=({isOpen:j,mode:u,initialData:y,onClose:i,onSubmit:h,isSubmitting:v,error:D})=>{const[a,N]=p.useState(M),[$,k]=p.useState(null),[U,c]=p.useState(""),[E,I]=p.useState(!1),[xe,ee]=p.useState(!1),[W,O]=p.useState(!1),[o,B]=p.useState(!1),ue=p.useMemo(()=>u==="edit"?"Edit Product":"Add Product",[u]),V=p.useMemo(()=>u==="edit"?"Save Changes":"Create Product",[u]);p.useEffect(()=>{if(j){const s=y||{};N({...M,...s,thumbnail:s.thumbnail||M.thumbnail,gallery:Array.isArray(s.gallery)?[...s.gallery]:[...M.gallery],keyFeatures:Array.isArray(s.keyFeatures)?s.keyFeatures.length?[...s.keyFeatures]:[""]:[...M.keyFeatures],sizes:Q(s.sizes),showSizes:!!s.showSizes,categoryPriority:Re(s.categoryPriority),hsnCode:s.hsnCode!=null?String(s.hsnCode):M.hsnCode,gstRate:s.gstRate!=null&&s.gstRate!==""?String(s.gstRate):M.gstRate}),c(""),O(!!(s!=null&&s.hsnCode)),B((s==null?void 0:s.gstRate)!==void 0&&(s==null?void 0:s.gstRate)!==null&&(s==null?void 0:s.gstRate)!=="")}},[j,y]),p.useEffect(()=>{D&&c(D)},[D]);const te=["out_of_stock","preorder"],z=te.includes(a.availabilityStatus),m=s=>l=>{const d=l.target.value;N(r=>{const n={...r,[s]:d};if(s==="availabilityStatus"&&te.includes(d)&&(n.stock="0"),s==="name"){const g=it(d);g&&((!W||!r.hsnCode)&&(n.hsnCode=g.hsnCode,O(!1)),(!o||!r.gstRate)&&(n.gstRate=g.gstRate.toString(),B(!1)))}return n})},X=s=>l=>{const d=l.target.value;s==="hsnCode"&&O(!0),s==="gstRate"&&B(!0),N(r=>({...r,[s]:d}))},S=s=>l=>{const{checked:d}=l.target;N(r=>s==="showSizes"?{...r,[s]:d}:{...r,[s]:d})},se=s=>l=>{const{value:d}=l.target;N(r=>{const n={...r,[s]:d},g=s==="price"?d:n.price,C=s==="originalPrice"?d:n.originalPrice,P=parseFloat(g),L=parseFloat(C);if(!Number.isNaN(P)&&!Number.isNaN(L)&&L>=P&&L>0){const G=L-P;n.discountPercentage=Math.round(G/L*100).toString(),n.saveAmount=G.toFixed(2)}else n.discountPercentage="",n.saveAmount="";return n})},Y=2*1024*1024,ae=s=>new Promise((l,d)=>{const r=new FileReader;r.onload=()=>l(r.result),r.onerror=()=>d(new Error("Failed to read file")),r.readAsDataURL(s)}),le=async s=>{var d;const l=(d=s.target.files)==null?void 0:d[0];if(l){if(!l.type.startsWith("image/")){c("Please upload an image file for the thumbnail"),s.target.value="";return}if(l.size>Y){c("Thumbnail must be under 2MB"),s.target.value="";return}I(!0);try{const r=await ae(l);N(n=>({...n,thumbnail:r})),c("")}catch{c("Failed to load thumbnail image")}finally{I(!1),s.target.value=""}}},K=async s=>{const l=Array.from(s.target.files||[]);if(!l.length)return;if(l.some(r=>!r.type.startsWith("image/"))){c("All gallery files must be images"),s.target.value="";return}if(l.find(r=>r.size>Y)){c("Each gallery image must be under 2MB"),s.target.value="";return}ee(!0);try{const r=await Promise.all(l.map(ae));N(n=>{const g=Array.isArray(n.gallery)?n.gallery:[],C=r.filter(P=>!g.includes(P));return{...n,gallery:[...g,...C]}}),c("")}catch{c("Failed to load gallery images")}finally{ee(!1),s.target.value=""}},re=s=>{N(l=>{const d=(l.gallery||[]).filter((r,n)=>n!==s);return{...l,gallery:d}})},Z=p.useMemo(()=>Q(a.sizes),[a.sizes]),ie=p.useMemo(()=>nt(Z),[Z]),me=s=>{N(l=>{const d=Q(l.sizes).map(r=>r.label===s?{...r,isAvailable:!r.isAvailable}:r);return{...l,sizes:d}})},be=()=>{N(s=>{const l=de();return{...s,sizes:l}})},ne=s=>l=>{const r=(l.target.value??"").toString().replace(/[^0-9]/g,""),n=Math.max(Number(r||0),0);N(g=>{const C=Q(g.sizes).map(P=>P.label===s?{...P,stock:n}:P);return{...g,sizes:C}})},J=s=>{var r;if(s.preventDefault(),c(""),!a.name.trim()){c("Product name is required");return}if(!a.category.trim()){c("Category is required");return}if(!a.categoryPriority.trim()){c("Set a category priority (e.g. P1, P2)");return}if(a.hsnCode&&!/^\d{2,}$/i.test(a.hsnCode.trim())){c("HSN code should contain at least 2 digits");return}if(a.gstRate!==""){const n=Number(a.gstRate);if(Number.isNaN(n)||n<0||n>100){c("GST rate must be between 0 and 100");return}}if(!a.thumbnail.trim()){c("Thumbnail URL is required");return}if(!Array.isArray(a.gallery)||a.gallery.length===0){c("Add at least one gallery image");return}if(!a.price||Number.isNaN(Number(a.price))){c("Valid price is required");return}const l=Array.isArray(a.keyFeatures)?a.keyFeatures.map(n=>n.trim()).filter(Boolean):[];if(!l.length){c("Add at least one key feature");return}const d=Q(a.sizes);if(a.showSizes&&!d.some(n=>n.isAvailable)){c("Enable at least one size or turn off the size selector before saving");return}if(a.originalPrice&&(Number.isNaN(Number(a.originalPrice))||Number(a.originalPrice)<Number(a.price))){c("Original price must be a valid number greater than or equal to price");return}if(a.stock!==""&&Number.isNaN(Number(a.stock))){c("Stock must be a number");return}h({...a,price:Number(a.price),originalPrice:a.originalPrice?Number(a.originalPrice):void 0,discountPercentage:a.discountPercentage?Number(a.discountPercentage):void 0,saveAmount:a.saveAmount?Number(a.saveAmount):void 0,stock:Number(["out_of_stock","preorder"].includes(a.availabilityStatus)?0:a.stock||0),gallery:Array.isArray(a.gallery)?a.gallery:[],isFeatured:!!a.isFeatured,keyFeatures:l,sizes:d,showSizes:!!a.showSizes,category:a.category,categoryPriority:Re(a.categoryPriority),brand:a.brand,hsnCode:((r=a.hsnCode)==null?void 0:r.toString().trim())||void 0,gstRate:a.gstRate!==""&&!Number.isNaN(Number(a.gstRate))?Number(a.gstRate):void 0})};return e.jsx(H,{children:j&&e.jsx(R.div,{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/40 px-4 py-8 md:items-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(R.div,{variants:dt,initial:"hidden",animate:"visible",exit:"exit",className:"flex w-full max-w-xl flex-col rounded-2xl bg-white p-6 shadow-xl md:my-0 max-h-[calc(100vh-4rem)] overflow-hidden",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:ue}),e.jsx("p",{className:"text-sm text-slate-500",children:u==="edit"?"Update product details and inventory":"Create a new product listing"})]}),e.jsx("button",{type:"button",onClick:i,className:"inline-flex h-9 w-9 items-center justify-center rounded-lg border border-transparent text-slate-400 hover:border-slate-200 hover:text-slate-600","aria-label":"Close",disabled:v,children:e.jsx(De,{size:18})})]}),e.jsx("form",{onSubmit:J,className:"mt-6 flex-1 overflow-y-auto pr-1",children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Product Name",e.jsx("input",{type:"text",value:a.name,onChange:m("name"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"Smartwatch E2"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["HSN Code",e.jsx("input",{type:"text",value:a.hsnCode,onChange:X("hsnCode"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"6109"}),e.jsx("span",{className:"text-[11px] text-slate-500",children:"Auto-suggested from product name; edit if required."})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["GST Rate (%)",e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:a.gstRate,onChange:X("gstRate"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"e.g. 18"}),e.jsx("span",{className:"text-[11px] text-slate-500",children:"Leave blank to auto-fill from presets."})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-xs font-medium text-slate-500 md:col-span-2",children:["Key Features",e.jsxs("div",{className:"space-y-2",children:[(a.keyFeatures||[]).map((s,l)=>e.jsxs("div",{className:"flex gap-2 rounded-xl border border-slate-200 bg-white px-2 py-1",draggable:!0,onDragStart:()=>k(l),onDragOver:d=>{d.preventDefault()},onDrop:d=>{d.preventDefault(),N(r=>{const n=Array.isArray(r.keyFeatures)?[...r.keyFeatures]:[],g=$,C=l;if(g==null||g===C||g<0||C<0||g>=n.length||C>=n.length)return r;const[P]=n.splice(g,1);return n.splice(C,0,P),{...r,keyFeatures:n.length?n:[""]}}),k(null)},children:[e.jsx("input",{type:"text",value:s,onChange:d=>{const r=d.target.value;N(n=>{const g=Array.isArray(n.keyFeatures)?[...n.keyFeatures]:[""];return g[l]=r,{...n,keyFeatures:g}})},placeholder:"E.g. Premium breathable fabric",className:"flex-1 rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none"}),e.jsx("button",{type:"button",onClick:()=>{N(d=>{const r=Array.isArray(d.keyFeatures)?d.keyFeatures.filter((n,g)=>g!==l):[];return{...d,keyFeatures:r.length?r:[""]}})},className:"inline-flex items-center justify-center rounded-xl border border-slate-200 px-2 py-2 text-xs font-medium text-slate-500 hover:border-rose-200 hover:text-rose-500",disabled:(a.keyFeatures||[]).length===1,children:"Remove"})]},l)),e.jsx("button",{type:"button",onClick:()=>{N(s=>({...s,keyFeatures:Array.isArray(s.keyFeatures)?[...s.keyFeatures,""]:["",""]}))},className:"inline-flex items-center gap-2 rounded-xl border border-dashed border-blue-300 px-3 py-2 text-xs font-semibold text-blue-600 hover:bg-blue-50",children:"Add Feature"})]})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["id",e.jsx("input",{type:"text",value:a.sku,onChange:m("sku"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"SW-302011"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Category",e.jsx("input",{type:"text",value:a.category,onChange:m("category"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"Menswear"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Category Priority",e.jsx("input",{type:"text",value:a.categoryPriority,onChange:m("categoryPriority"),placeholder:"P1",className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none"}),e.jsx("span",{className:"text-[11px] text-slate-500",children:"Use P1, P2, P3… Higher priority appears first in listings."})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Brand",e.jsx("input",{type:"text",value:a.brand,onChange:m("brand"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"p2pdeal"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Price",e.jsx("input",{type:"number",min:"0",step:"0.01",value:a.price,onChange:se("price"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"599.00"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Original Price (MRP)",e.jsx("input",{type:"number",min:"0",step:"0.01",value:a.originalPrice,onChange:se("originalPrice"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"799.00"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Discount (%)",e.jsx("input",{type:"number",min:"0",step:"1",value:a.discountPercentage,onChange:m("discountPercentage"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"Auto"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["You Save (₹)",e.jsx("input",{type:"number",min:"0",step:"0.01",value:a.saveAmount,onChange:m("saveAmount"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"Auto"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Stock",e.jsx("input",{type:"number",min:"0",step:"1",value:a.stock,onChange:m("stock"),disabled:z,className:`rounded-xl border px-3 py-2 text-sm focus:border-blue-400 focus:outline-none ${z?"cursor-not-allowed border-slate-200 bg-slate-100 text-slate-500":"border-slate-200"}`,placeholder:z?"Managed automatically":"40"}),z&&e.jsxs("span",{className:"text-[11px] text-slate-500",children:["Stock is controlled automatically when status is"," ",a.availabilityStatus==="preorder"?"Preorder":"Out of Stock","."]}),a.showSizes&&!z&&e.jsxs("span",{className:"text-[11px] text-slate-500",children:["Total from size quantities: ",ie]})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Status",e.jsx("select",{value:a.status,onChange:m("status"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-400 focus:outline-none",children:ot.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Stock Status",e.jsx("select",{value:a.availabilityStatus,onChange:m("availabilityStatus"),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-blue-400 focus:outline-none",children:ct.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Featured Product",e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[e.jsx("span",{className:"text-xs text-slate-600",children:"Highlight this item in storefront collections"}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!a.isFeatured,onChange:S("isFeatured"),className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500","aria-label":"Toggle featured product"}),e.jsx("span",{className:"text-xs text-slate-600",children:a.isFeatured?"Yes":"No"})]})]})]})]}),e.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 bg-slate-50/60 p-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Size Availability"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Toggle which sizes are purchasable and whether the selector appears on the product page."})]}),e.jsxs("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-[11px] font-medium text-slate-600",children:[e.jsx("input",{type:"checkbox",checked:!!a.showSizes,onChange:S("showSizes"),className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),a.showSizes?"Shown on product page":"Hidden on product page"]})]}),a.showSizes?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-[11px] text-slate-500",children:[e.jsxs("span",{className:"font-medium text-slate-600",children:["Total size stock: ",ie]}),e.jsx("button",{type:"button",onClick:be,className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-1.5 text-[11px] font-semibold text-slate-600 hover:border-blue-200 hover:text-blue-600",children:"Reset sizes"})]}),e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:Z.map(s=>{const l=!!s.isAvailable,d=Number(s.stock??0);return e.jsxs("div",{className:"flex flex-col gap-2 rounded-xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>me(s.label),className:`inline-flex items-center gap-2 rounded-lg border px-3 py-1.5 text-xs font-semibold transition focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-400 ${l?"border-blue-600 bg-blue-50 text-blue-600 hover:border-blue-700 hover:bg-blue-100":"border-rose-200 bg-rose-50 text-rose-500 hover:border-rose-300 hover:bg-rose-100"}`,children:[e.jsx("span",{children:s.label}),!l&&e.jsx("span",{className:"rounded-full bg-white px-2 py-0.5 text-[9px] font-semibold uppercase text-rose-500 shadow-sm",children:"Blocked"})]}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",min:"0",value:l&&!z&&d>0?d:"",onFocus:r=>r.target.select(),onChange:ne(s.label),disabled:!l||z,placeholder:"0",className:`w-24 rounded-lg border px-2 py-1 text-xs font-semibold focus:border-blue-400 focus:outline-none ${l&&!z?"border-slate-200 bg-white text-slate-700":"cursor-not-allowed border-slate-100 bg-slate-100 text-slate-400"}`,"aria-label":`${s.label} stock quantity`})]}),e.jsx("p",{className:"text-[11px] text-slate-500",children:l?"Adjust units for this size when available.":"Blocked sizes stay hidden for shoppers."})]},s.label)})}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Tip: Total stock equals the sum of enabled size quantities."})]}):e.jsx("p",{className:"rounded-lg border border-dashed border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-500",children:"Enable the toggle to manage per-size availability for this listing."})]}),e.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 bg-slate-50/60 p-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Thumbnail"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Upload a primary image (max 2MB) that will be used as the card preview."})]}),e.jsxs("div",{className:`flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-8 text-center ${a.thumbnail?"border-blue-200 bg-white":"border-slate-200 bg-white"}`,children:[a.thumbnail?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.thumbnail,alt:"Thumbnail preview",className:"h-28 w-28 rounded-2xl object-cover shadow-sm"}),e.jsx("button",{type:"button",onClick:()=>N(s=>({...s,thumbnail:""})),className:"absolute -right-2 -top-2 inline-flex items-center justify-center rounded-full bg-white px-2 py-1 text-[10px] font-semibold shadow-sm",children:"Remove"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-white shadow-sm",children:E?e.jsx(fe,{className:"h-5 w-5 animate-spin text-blue-600"}):e.jsx(Ze,{className:"h-5 w-5 text-blue-500"})}),e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"Drag and drop image here, or click add image"})]}),e.jsxs("label",{className:"mt-4 inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-2 text-xs font-semibold text-white shadow-sm hover:bg-blue-700",children:[e.jsx(Ae,{size:14}),a.thumbnail?"Replace Image":"Add Image",e.jsx("input",{type:"file",accept:"image/*",onChange:le,className:"hidden"})]})]})]}),e.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 bg-slate-50/60 p-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Gallery Images"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Upload multiple images (under 2MB each) for the product swiper."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3",children:(a.gallery||[]).map((s,l)=>e.jsxs("div",{className:"group relative overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[e.jsx("img",{src:s,alt:`Gallery ${l+1}`,className:"h-24 w-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>re(l),className:"absolute inset-x-2 bottom-2 rounded-lg bg-white/90 px-2 py-1 text-[10px] font-semibold text-slate-600 opacity-0 shadow-sm transition group-hover:opacity-100",children:"Remove"})]},`${s}-${l}`))}),e.jsxs("label",{className:"inline-flex items-center gap-2 rounded-xl border border-dashed border-blue-300 px-3 py-2 text-xs font-semibold text-blue-600 hover:bg-blue-50",children:[e.jsx(Ae,{size:14}),xe?"Uploading...":"Add Gallery Images",e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:K,className:"hidden"})]})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:["Description",e.jsx("textarea",{value:a.description,onChange:m("description"),rows:3,className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none",placeholder:"A short description about this product"})]}),(U||D)&&e.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-600",children:U||D}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:i,disabled:v,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 hover:border-slate-300 disabled:opacity-60",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-70",children:v?"Saving...":V})]})]})})]})})})};ye.propTypes={isOpen:T.bool.isRequired,mode:T.oneOf(["add","edit"]).isRequired,initialData:T.object,onClose:T.func.isRequired,onSubmit:T.func.isRequired,isSubmitting:T.bool,error:T.string};ye.defaultProps={initialData:null,isSubmitting:!1,error:""};const oe={published:"bg-emerald-100 text-emerald-700",archived:"bg-slate-300 text-slate-500"},ce={in_stock:"bg-emerald-50 text-emerald-600",low_stock:"bg-amber-50 text-amber-600",out_of_stock:"bg-rose-50 text-rose-600",preorder:"bg-blue-50 text-blue-600"},xt={hidden:{opacity:0,y:12},visible:{opacity:1,y:0}},ut=[{label:"All Status",value:""},{label:"Published",value:"published"},{label:"Archived",value:"archived"}],mt=[{label:"All Stock",value:""},{label:"In Stock",value:"in_stock"},{label:"Low Stock",value:"low_stock"},{label:"Out of Stock",value:"out_of_stock"},{label:"Preorder",value:"preorder"}],ge=({label:j,value:u,onChange:y,options:i,ariaLabel:h})=>{const[v,D]=p.useState(!1),a=p.useRef(null),N=p.useId(),$=p.useId(),k=i.find(c=>c.value===u)??i[0],U=k==null?void 0:k.fallbackLabel;return p.useEffect(()=>{const c=E=>{var I;(I=a.current)!=null&&I.contains(E.target)||D(!1)};return document.addEventListener("mousedown",c),document.addEventListener("touchstart",c),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("touchstart",c)}},[]),e.jsxs("div",{className:"flex flex-col gap-1 text-xs font-medium text-slate-500",children:[e.jsx("span",{id:N,children:j}),e.jsxs("div",{ref:a,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>D(c=>!c),className:`inline-flex w-full items-center justify-between gap-2 rounded-xl border px-3 py-2 text-sm font-semibold transition focus:outline-none focus:ring-2 focus:ring-blue-100 ${v?"border-blue-400 bg-white text-blue-600":"border-slate-200 bg-white text-slate-600 hover:border-blue-300"}`,"aria-haspopup":"listbox","aria-expanded":v,"aria-labelledby":`${N} ${$}`,"aria-label":h,children:[e.jsx("span",{children:(k==null?void 0:k.label)||U||j}),e.jsx(Ve,{size:14,className:`transition ${v?"rotate-180 text-blue-500":"text-slate-400"}`})]}),v&&e.jsx("div",{id:$,role:"listbox",className:"absolute left-0 top-[calc(100%+0.35rem)] z-30 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg",children:e.jsx("ul",{className:"max-h-48 overflow-y-auto py-1",children:i.map(c=>{const E=c.value===u;return e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>{y(c.value),D(!1)},className:`flex w-full items-center justify-between px-3 py-2 text-xs font-semibold transition ${E?"bg-blue-50 text-blue-600":"text-slate-600 hover:bg-slate-50"}`,role:"option","aria-selected":E,children:[c.label||c.fallbackLabel||j,E&&e.jsx("span",{className:"text-[10px] font-bold uppercase text-blue-500",children:"Selected"})]})},c.value)})})})]})]})},Mt=()=>{var we,Se,ke;const j=Me(),u=Je(),{items:y,meta:i,filters:h,sort:v,status:D,error:a,selection:N}=Qe(t=>t.adminProducts),[$,k]=p.useState(!1),[U,c]=p.useState(h.search||""),[E,I]=p.useState(!1),[xe,ee]=p.useState(!1),[W,O]=p.useState(!1),[o,B]=p.useState(null),[ue,V]=p.useState(""),[te,z]=p.useState(!1),[m,X]=p.useState(null),{user:S,logout:se}=$e(),[Y,ae]=p.useState([]);p.useEffect(()=>{ae(t=>{const x=new Set(t);y.forEach(b=>{b!=null&&b.category&&x.add(b.category)}),h.category&&x.add(h.category);const f=Array.from(x).sort((b,A)=>b.localeCompare(A));return f.length!==t.length||f.some((b,A)=>b!==t[A])?f:t})},[y,h.category]);const le=p.useMemo(()=>["",...Y],[Y]),K=p.useMemo(()=>{const t=(x,f)=>x.map(w=>typeof w=="string"?{value:w,label:w||f}:w);return{categories:t(le,"All Categories"),statuses:t(ut,"All Status"),stocks:t(mt,"All Stock")}},[le]),re=p.useMemo(()=>{var x;const t={page:i.page,limit:i.limit,sortBy:v.field,sortOrder:v.order};return(x=h.search)!=null&&x.trim()&&(t.search=h.search.trim()),h.status&&(t.status=h.status),h.stockStatus&&(t.stockStatus=h.stockStatus),h.category&&(t.category=h.category),h.dateRange.startDate&&(t.startDate=h.dateRange.startDate),h.dateRange.endDate&&(t.endDate=h.dateRange.endDate),t},[h,i.limit,i.page,v.field,v.order]);p.useEffect(()=>{u(Ue(re))},[u,re]);const Z=t=>{const x=t.target.value;c(x),u(q({search:x}))},ie=()=>{if(!y.length){_.error("No products to export");return}try{const t=["Name","ID","Category","Brand","Price","Original Price","Discount %","Stock","Availability","Status"],x=y.map(F=>{const Le=Number(F.price??0),_e=Number(F.originalPrice??F.price??0),Ie=Number(F.discountPercentage??0);return[F.name||"",F._id||"",F.category||"",F.brand||"",Le.toString(),_e.toString(),Ie.toString(),(F.stock??0).toString(),F.availabilityStatus||"",F.status||""].map(Te=>`"${String(Te).replace(/"/g,'""')}"`).join(",")}),f=[t.join(","),...x].join(`
`),w=new Blob([f],{type:"text/csv;charset=utf-8;"});if(typeof window>"u"){_.error("Export is only available in the browser");return}const b=window.URL.createObjectURL(w),A=document.createElement("a");A.href=b,A.setAttribute("download",`products_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(A),A.click(),document.body.removeChild(A),window.URL.revokeObjectURL(b),_.success("Exported products as CSV")}catch(t){console.error("Failed to export products",t),_.error("Failed to export products")}},me=t=>{const f=v.field===t&&v.order==="asc"?"desc":"asc";u(qe({field:t,order:f}))},be=t=>{u(Ge({selectAll:t.target.checked}))},ne=t=>{u(He({id:t}))},J=t=>{u(Xe(t))},s=t=>{u(q({category:t}))},l=t=>{u(q({status:t}))},d=t=>{u(q({stockStatus:t}))},r=(t,x)=>{u(q({dateRange:{...h.dateRange,[t]:x}}))},n=()=>{u(q({search:"",category:"",status:"",stockStatus:"",dateRange:{startDate:"",endDate:""}})),c("")};p.useEffect(()=>()=>{u(Oe())},[u]),p.useEffect(()=>{if(typeof document>"u"||!(W||!!m))return;const x=document.body,f=x.style.overflow,w=x.style.paddingRight,b=window.innerWidth-document.documentElement.clientWidth;return x.style.overflow="hidden",b>0&&(x.style.paddingRight=`${b}px`),()=>{x.style.overflow=f,x.style.paddingRight=w}},[W,m]);const g=D==="loading",C=!g&&y.length===0,P=p.useMemo(()=>{var f,w;if(!o)return null;const t=b=>!b||typeof b!="string"||b.startsWith("http")?b:`https://s3.ap-south-1.amazonaws.com/ecom-mega-mart/${b.replace(/^\/+/,"")}`,x=Array.isArray(o.gallery)?o.gallery:Array.isArray(o.images)?o.images:[];return{name:o.name||"",sku:o.sku||o.id||"",category:o.category||"",categoryPriority:o.categoryPriority||"P5",brand:o.brand||"",price:o.price??"",originalPrice:o.originalPrice??"",discountPercentage:o.discountPercentage??"",saveAmount:o.saveAmount??"",hsnCode:o.hsnCode??"",gstRate:o.gstRate!==void 0&&o.gstRate!==null?o.gstRate:"",rating:o.rating??((f=o.ratings)==null?void 0:f.average)??"",reviews:o.reviews??((w=o.ratings)==null?void 0:w.totalReviews)??"",stock:o.stock??"",status:o.status||"published",availabilityStatus:o.availabilityStatus||"in_stock",thumbnail:t(o.thumbnail||o.image||o.imageUrl||""),description:o.description||"",gallery:x.map(b=>t(b)),isFeatured:!!o.isFeatured,keyFeatures:Array.isArray(o.keyFeatures)?o.keyFeatures:[],sizes:Array.isArray(o.sizes)?o.sizes.map(b=>({label:(b==null?void 0:b.label)??"",isAvailable:!!((b==null?void 0:b.isAvailable)??!0),stock:Math.max(Number((b==null?void 0:b.stock)??0),0)})):[],showSizes:!!o.showSizes}},[o]),L=()=>{O(!1),B(null),V("")},G=t=>{B(t),V(""),O(!0)},je=t=>{X(t)},Ne=()=>{X(null)},Ee=async t=>{if(o!=null&&o._id){z(!0),V("");try{await u(Ye({id:o._id,payload:t})).unwrap(),_.success("Product updated successfully."),L()}catch(x){const f=(x==null?void 0:x.message)||x||"Unable to save product. Please try again.";V(f),_.error(f)}finally{z(!1)}}},ve=async t=>{if(window.confirm(`Delete product "${t.name}"? This action cannot be undone.`))try{await u(We(t._id)).unwrap(),_.success("Product deleted successfully.")}catch(f){const w=(f==null?void 0:f.message)||f||"Failed to delete product. Please try again.";_.error(w)}};return e.jsxs("div",{className:"min-h-screen md:h-screen bg-slate-50 text-slate-900 overflow-x-hidden",children:[e.jsxs("div",{className:"flex md:h-screen",children:[e.jsx(Ce,{active:"Products",className:"hidden md:flex md:w-64 md:flex-none",onNavigate:()=>k(!1)}),e.jsx(H,{children:$&&e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex md:hidden",children:[e.jsx(R.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:220,damping:24},className:"bg-white w-72 max-w-sm h-full shadow-xl",children:e.jsx(Ce,{active:"Products",className:"flex w-full",onNavigate:()=>k(!1)})}),e.jsx("button",{type:"button",onClick:()=>k(!1),className:"flex-1 bg-black/30","aria-label":"Close sidebar"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(Ke,{onToggleSidebar:()=>k(t=>!t),activeRange:"All Date",onSelectRange:()=>{},adminName:(S==null?void 0:S.name)||(S==null?void 0:S.username)||"Admin",adminRole:(S==null?void 0:S.role)==="admin"?"Administrator":S==null?void 0:S.role,notifications:{pendingOrders:0,shippedOrders:0,deliveredOrders:0},showRangeSelector:!1,showNotifications:!1,onLogout:se}),e.jsxs("main",{className:"flex-1 overflow-y-auto px-4 py-6 md:px-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Dashboard / Products"}),e.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Products"})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:flex-wrap sm:items-center",children:[e.jsxs("button",{type:"button",onClick:ie,className:"inline-flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm font-medium text-slate-600 hover:border-blue-200 hover:text-blue-600 sm:w-auto",children:[e.jsx(et,{size:16}),"Export"]}),e.jsxs("button",{type:"button",onClick:()=>j("/admin/products/new"),className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 sm:w-auto",children:[e.jsx(tt,{size:16}),"Add Product"]})]})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Total Products"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold",children:i.total})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Low Stock"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-amber-600",children:((we=i.counts)==null?void 0:we.lowStock)??0})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Out of Stock"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-rose-600",children:((Se=i.counts)==null?void 0:Se.outOfStock)??0})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Selected"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-blue-600",children:N.selectedIds.length})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-1 lg:flex-row lg:items-center",children:[e.jsxs("div",{className:"flex w-full items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm",children:[e.jsx(Be,{size:16,className:"text-slate-400"}),e.jsx("input",{value:U,onChange:Z,placeholder:"Search product name or ID",className:"w-full bg-transparent outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm font-medium text-slate-600 hover:border-blue-200 hover:text-blue-600 sm:w-auto",onClick:()=>ee(t=>!t),children:[e.jsx(st,{size:16}),"Select Dates"]}),xe&&e.jsx("div",{className:"absolute left-0 z-20 mt-2 w-full min-w-[16rem] rounded-2xl border border-slate-200 bg-white p-4 shadow-lg sm:w-64",children:e.jsxs("div",{className:"flex flex-col gap-3 text-sm",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"Start Date"}),e.jsx("input",{type:"date",value:h.dateRange.startDate,onChange:t=>r("startDate",t.target.value),className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none"})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"End Date"}),e.jsx("input",{type:"date",value:h.dateRange.endDate,onChange:t=>r("endDate",t.target.value),className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-blue-400 focus:outline-none"})]})]})})]}),e.jsxs("button",{type:"button",className:`inline-flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm font-medium transition sm:w-auto ${E?"border-blue-200 text-blue-600":"text-slate-600 hover:border-blue-200 hover:text-blue-600"}`,onClick:()=>I(t=>!t),children:[e.jsx(at,{size:16}),"Filters"]})]})}),e.jsx(H,{children:E&&e.jsxs(R.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"mt-3 grid gap-3 md:grid-cols-4",children:[e.jsx(ge,{label:"Category",value:h.category,onChange:s,options:K.categories,ariaLabel:"Filter products by category"}),e.jsx(ge,{label:"Status",value:h.status,onChange:l,options:K.statuses,ariaLabel:"Filter products by status"}),e.jsx(ge,{label:"Stock Status",value:h.stockStatus,onChange:d,options:K.stocks,ariaLabel:"Filter products by stock status"}),e.jsx("div",{className:"flex flex-col items-end md:flex-row md:items-center md:justify-end",children:e.jsx("button",{type:"button",onClick:n,className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm font-medium text-slate-600 hover:border-blue-200 hover:text-blue-600 md:w-auto",children:"Clear Filters"})})]})}),e.jsx("div",{className:"relative mt-4 hidden overflow-x-auto rounded-2xl border border-slate-100 md:block",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-100 text-sm",children:[e.jsx("thead",{className:"bg-slate-50/70",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:N.allSelected,onChange:be,"aria-label":"Select all products"})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"id"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:e.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 font-semibold text-slate-500",onClick:()=>me("price"),children:["Price",e.jsx(lt,{size:14})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Featured"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Added"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:e.jsxs(H,{children:[g&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-6 py-10 text-center text-slate-500",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx(fe,{className:"h-4 w-4 animate-spin"}),"Loading products..."]})})}),!g&&a&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-6 py-10 text-center text-rose-600",children:a})}),C&&!a&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-6 py-10 text-center text-slate-500",children:"No products found. Try adjusting your filters."})}),!g&&!a&&y.map(t=>{var A;const x=oe[t.status]||oe.published,f=ce[t.availabilityStatus]||ce.in_stock,w=Number(t.price||0).toLocaleString("en-IN",{style:"currency",currency:t.currency||"INR",minimumFractionDigits:2}),b=t.createdAt?new Date(t.createdAt).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"--";return e.jsxs(R.tr,{initial:"hidden",animate:"visible",variants:xt,className:"hover:bg-slate-50/70",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:N.selectedIds.includes(t._id),onChange:()=>ne(t._id),"aria-label":`Select ${t.name}`})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 overflow-hidden rounded-xl border border-slate-100 bg-slate-50",children:e.jsx("img",{src:t.thumbnail||t.imageUrl,alt:t.name,className:"h-full w-full object-cover",onError:F=>{F.currentTarget.src="https://placehold.co/96x96/f8fafc/e2e8f0?text=IMG"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[((A=t.variants)==null?void 0:A.length)||0," Variants"]})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:t._id||"--"}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:t.category||"--"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium ${f}`,children:t.stock??0})}),e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-slate-900",children:w}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-semibold ${t.isFeatured?"bg-blue-50 text-blue-600":"bg-slate-100 text-slate-500"}`,children:[e.jsx(pe,{size:12,className:t.isFeatured?"text-blue-500 fill-blue-400":"text-slate-400"}),t.isFeatured?"Featured":"Standard"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ${x}`,children:t.status?t.status.charAt(0).toUpperCase()+t.status.slice(1):"Published"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500",children:b}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex justify-end gap-2 text-slate-400",children:[e.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-lg border border-transparent hover:border-blue-200 hover:text-blue-600","aria-label":"View product",onClick:()=>je(t),children:e.jsx(Pe,{size:16})}),e.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-lg border border-transparent hover:border-blue-200 hover:text-blue-600","aria-label":"Edit product",onClick:()=>G(t),children:e.jsx(he,{size:16})}),e.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-lg border border-transparent hover:border-rose-200 hover:text-rose-600","aria-label":"Delete product",onClick:()=>ve(t),children:e.jsx(Fe,{size:16})})]})})]},t._id)})]})})]})}),e.jsx("div",{className:"mt-4 space-y-3 md:hidden",children:e.jsxs(H,{children:[g&&e.jsx(R.div,{className:"rounded-2xl border border-slate-200 bg-white p-6 text-center text-slate-500",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx(fe,{className:"h-4 w-4 animate-spin"}),"Loading products..."]})}),!g&&a&&e.jsx(R.div,{className:"rounded-2xl border border-rose-200 bg-white p-6 text-center text-rose-600",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:a}),C&&!a&&e.jsx(R.div,{className:"rounded-2xl border border-slate-200 bg-white p-6 text-center text-slate-500",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:"No products found. Try adjusting your filters."}),!g&&!a&&y.map(t=>{const x=oe[t.status]||oe.published,f=ce[t.availabilityStatus]||ce.in_stock,w=Number(t.price||0).toLocaleString("en-IN",{style:"currency",currency:t.currency||"INR",minimumFractionDigits:2}),b=t.createdAt?new Date(t.createdAt).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"--";return e.jsxs(R.div,{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.2},children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:N.selectedIds.includes(t._id),onChange:()=>ne(t._id),"aria-label":`Select ${t.name}`}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-16 w-16 overflow-hidden rounded-xl border border-slate-100 bg-slate-50",children:e.jsx("img",{src:t.thumbnail||t.imageUrl,alt:t.name,className:"h-full w-full object-cover",onError:A=>{A.currentTarget.src="https://placehold.co/96x96/f8fafc/e2e8f0?text=IMG"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["ID: ",t._id||"--"]})]})]})]}),e.jsx("span",{className:`inline-flex max-w-full items-center rounded-full px-3 py-1 text-xs font-semibold ${x}`,children:t.status?t.status.charAt(0).toUpperCase()+t.status.slice(1):"Published"})]}),e.jsxs("div",{className:"mt-4 grid gap-2 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs uppercase text-slate-400",children:"Category"}),e.jsx("span",{className:"font-medium",children:t.category||"--"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs uppercase text-slate-400",children:"Price"}),e.jsx("span",{className:"font-semibold text-slate-900",children:w})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs uppercase text-slate-400",children:"Featured"}),e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-semibold ${t.isFeatured?"bg-blue-50 text-blue-600":"bg-slate-100 text-slate-500"}`,children:[e.jsx(pe,{size:12,className:t.isFeatured?"text-blue-500 fill-blue-400":"text-slate-400"}),t.isFeatured?"Yes":"No"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs uppercase text-slate-400",children:"Stock"}),e.jsx("span",{className:`inline-flex min-w-[64px] items-center justify-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${f}`,children:t.stock??0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs uppercase text-slate-400",children:"Added"}),e.jsx("span",{children:b})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-end gap-2",children:[e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-xs font-semibold text-slate-600 hover:border-blue-200 hover:text-blue-600",onClick:()=>je(t),children:[e.jsx(Pe,{size:14})," View"]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-xs font-semibold text-slate-600 hover:border-blue-200 hover:text-blue-600",onClick:()=>G(t),children:[e.jsx(he,{size:14})," Edit"]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-2 text-xs font-semibold text-rose-600 hover:border-rose-300",onClick:()=>ve(t),children:[e.jsx(Fe,{size:14})," Delete"]})]})]},t._id)})]})}),!g&&!C&&!a&&e.jsxs("div",{className:"flex flex-col gap-3 pt-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("p",{className:"text-xs text-slate-500",children:["Showing ",(i.page-1)*i.limit+1,"-",Math.min(i.page*i.limit,i.total)," of"," ",i.total]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 disabled:opacity-50",disabled:i.page===1,onClick:()=>J(i.page-1),children:"Prev"}),Array.from({length:i.totalPages},(t,x)=>x+1).map(t=>e.jsx("button",{type:"button",onClick:()=>J(t),className:`inline-flex h-8 w-8 items-center justify-center rounded-lg text-xs font-semibold ${t===i.page?"bg-blue-600 text-white":"border border-slate-200 text-slate-500 hover:border-blue-200 hover:text-blue-600"}`,children:t},t)),e.jsx("button",{type:"button",className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 disabled:opacity-50",disabled:i.page>=i.totalPages,onClick:()=>J(i.page+1),children:"Next"})]})]})]})]})]})]}),e.jsx(ye,{isOpen:W,mode:"edit",initialData:P,onClose:L,onSubmit:Ee,isSubmitting:te,error:ue}),e.jsx(H,{children:m&&e.jsx(R.div,{className:"fixed inset-0 z-50 flex items-start justify-center bg-slate-900/40 px-4 py-8 md:items-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(R.div,{className:"relative flex w-full max-w-3xl flex-col rounded-3xl bg-white shadow-2xl md:my-0 max-h-[calc(100vh-4rem)] overflow-hidden",initial:{scale:.95,opacity:0,y:24},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:24},transition:{type:"spring",stiffness:220,damping:26},children:[e.jsx("button",{type:"button",onClick:Ne,className:"absolute right-4 top-4 inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 text-slate-500 hover:border-blue-200 hover:text-blue-600","aria-label":"Close",children:e.jsx(De,{size:18})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"grid gap-6 px-6 pb-6 pt-12 md:grid-cols-[1.2fr,1fr]",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Product"}),e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:m.name||"Untitled product"}),e.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["ID: ",m._id||"--"]})]}),e.jsx("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-600",children:m.category||"No category"})]}),e.jsxs("div",{className:"space-y-3 rounded-2xl border border-slate-200 bg-slate-50/60 p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[e.jsxs("div",{className:"rounded-xl bg-white px-3 py-2 shadow-sm",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Price"}),e.jsxs("p",{className:"text-base font-semibold text-slate-900",children:["₹",Number(m.price??0).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"rounded-xl bg-white px-3 py-2 shadow-sm",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Stock"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:m.stock??0})]}),e.jsxs("div",{className:"rounded-xl bg-white px-3 py-2 shadow-sm",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Availability"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:m.availabilityStatus||"--"})]}),e.jsxs("div",{className:"rounded-xl bg-white px-3 py-2 shadow-sm",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Status"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:m.status||"--"})]}),e.jsxs("div",{className:"rounded-xl bg-white px-3 py-2 shadow-sm",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Featured"}),e.jsxs("p",{className:"mt-1 inline-flex items-center gap-1 text-sm font-semibold text-slate-900",children:[e.jsx(pe,{size:14,className:m.isFeatured?"text-blue-500 fill-blue-400":"text-slate-300"}),m.isFeatured?"Yes":"No"]})]})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-xl bg-white p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Brand"}),e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-800",children:m.brand||"--"})]}),e.jsxs("div",{className:"rounded-xl bg-white p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Discount"}),e.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-800",children:[Number(m.discountPercentage??0),"%"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Description"}),e.jsx("p",{className:"rounded-2xl border border-slate-200 bg-white p-4 text-sm leading-relaxed text-slate-600",children:m.description||"No description provided."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Metadata"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-600",children:[e.jsx("p",{className:"text-xs font-semibold uppercase text-slate-400",children:"Rating"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-slate-900",children:Number(m.rating??0).toFixed(1)})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-600",children:[e.jsx("p",{className:"text-xs font-semibold uppercase text-slate-400",children:"Reviews"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-slate-900",children:m.reviews??0})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-slate-50",children:e.jsx("img",{src:m.thumbnail||m.imageUrl||((ke=m.gallery)==null?void 0:ke[0])||"https://placehold.co/600x600/f8fafc/e2e8f0?text=Image",alt:m.name,className:"h-64 w-full object-cover",onError:t=>{t.currentTarget.src="https://placehold.co/600x600/f8fafc/e2e8f0?text=Image"}})}),Array.isArray(m.gallery)&&m.gallery.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Gallery"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:m.gallery.map((t,x)=>e.jsx("div",{className:"overflow-hidden rounded-xl border border-slate-200 bg-white",children:e.jsx("img",{src:t,alt:`${m.name||"Product"} ${x+1}`,className:"h-24 w-full object-cover",onError:f=>{f.currentTarget.src="https://placehold.co/200x200/f8fafc/e2e8f0?text=Image"}})},`${t}-${x}`))})]}),e.jsxs("button",{type:"button",onClick:()=>{Ne(),G(m)},className:"inline-flex items-center justify-center gap-2 rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700",children:[e.jsx(he,{size:16}),"Edit Product"]})]})]})})]})})})]})};export{Mt as default};
