import{r as l,j as t,m as k}from"./vendor-2d1PFKo4.js";import{f as N}from"./offerLightboxApi-Dk5QGubC.js";import{u as C,S as j}from"./index-Bpx0OnSg.js";import{C as O}from"./copy-pxcJIyRH.js";import{L}from"./loader-circle-DRAKHMK_.js";import"./react-BzrpNAyj.js";const S=({offer:e})=>{var y,v;const c=C(),o=l.useMemo(()=>({background:(e==null?void 0:e.backgroundColor)||"#f8fafc",text:(e==null?void 0:e.textColor)||"#0f172a",accent:(e==null?void 0:e.accentColor)||"#008ecc",imageBackground:(e==null?void 0:e.imageBackgroundColor)||"#ffffff"}),[e]),r=l.useMemo(()=>{var n;return((n=e==null?void 0:e.couponCode)==null?void 0:n.trim())||""},[e==null?void 0:e.couponCode]),d=l.useMemo(()=>{var n;return((n=e==null?void 0:e.couponDescription)==null?void 0:n.trim())||""},[e==null?void 0:e.couponDescription]),[u,x]=l.useState(!1),s=l.useRef(null),m=l.useCallback(()=>{x(!0),s.current&&clearTimeout(s.current),s.current=window.setTimeout(()=>{x(!1),s.current=null},1600)},[]);l.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]);const h=l.useCallback(()=>{if(r)try{navigator.clipboard.writeText(r).then(m).catch(m)}catch{m()}},[r,m]),p=l.useCallback(()=>{e&&window.dispatchEvent(new CustomEvent("open-offer-lightbox",{detail:{offer:e}}))},[e]),a=l.useCallback(()=>{if(!e)return;const n=(e.buttonLinkType||"none").toLowerCase(),i=(e.buttonLinkValue||"").trim();if(n==="product"&&i){c(`/product/${i}`);return}if(n==="category"&&i){c(`/category/${i}`);return}if(n==="custom"&&i){/^https?:\/\//i.test(i)?window.open(i,"_blank","noopener"):i.startsWith("/")?c(i):window.location.href=i;return}p()},[c,e]);if(!e)return null;const g=!!e.imageUrl,w=(y=e.secondaryLabel)==null?void 0:y.trim(),b=(v=e.secondaryHref)==null?void 0:v.trim();return t.jsxs("article",{className:"relative flex flex-col overflow-hidden rounded-[26px] border border-white/70 bg-white shadow-xl transition-transform hover:-translate-y-1 hover:shadow-2xl",style:{backgroundColor:o.background,color:o.text},children:[t.jsx("span",{className:`absolute right-5 top-5 inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold shadow ${e.isActive?"bg-emerald-500 text-white":"bg-slate-300 text-slate-600"}`,children:e.isActive?"Active":"Hidden"}),g?t.jsx("div",{className:"relative h-44 w-full overflow-hidden md:hidden",style:{backgroundColor:o.imageBackground},children:t.jsx("img",{src:e.imageUrl,alt:e.title||"Offer artwork",className:"h-full w-full object-cover",style:{objectPosition:"center"}})}):null,t.jsxs("div",{className:`relative grid gap-0 ${g?"md:grid-cols-[1.12fr_0.88fr]":"md:grid-cols-1"}`,children:[t.jsxs("div",{className:"space-y-5 px-5 py-6 sm:px-10 sm:py-10",children:[t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-black px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-white shadow-sm",children:[t.jsx(j,{size:14})," Special Offer"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h2",{className:"text-3xl font-bold leading-tight text-slate-900 sm:text-4xl",children:e.title||"Unlock amazing savings"}),e.subtitle?t.jsx("p",{className:"text-base font-medium",style:{color:o.text},children:e.subtitle}):null,e.description?t.jsx("p",{className:"text-sm text-slate-600",style:{color:o.text},children:e.description}):null]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-black",children:"Coupon code"}),r?t.jsxs("div",{className:"relative",children:[t.jsxs("button",{type:"button",onClick:h,className:"flex w-full items-center justify-between rounded-2xl border border-white/70 bg-white/90 px-4 py-3 text-sm font-semibold uppercase tracking-[0.25em] text-black shadow-sm transition hover:border-white focus:outline-none focus:ring-2 focus:ring-white/60",children:[t.jsx("span",{children:r}),t.jsx(O,{size:16,className:"text-slate-500"})]}),u?t.jsx("span",{className:"pointer-events-none absolute right-3 top-0 -translate-y-full rounded-full bg-emerald-500 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] text-white shadow-md","aria-hidden":!0,children:"Copied!"}):null]}):t.jsx("div",{className:"rounded-2xl border border-white/40 bg-white/60 px-4 py-3 text-xs font-medium text-slate-500",children:"Coupon code coming soon"}),d?t.jsx("p",{className:"text-xs text-slate-500",children:d}):null]}),t.jsx("button",{type:"button",onClick:a,className:"w-full rounded-xl px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-blue-500/25 transition hover:shadow-blue-500/40 focus:outline-none focus:ring-2 focus:ring-blue-200",style:{backgroundColor:o.accent},children:e.buttonLabel||"Take the offer"}),w?b?t.jsx("a",{href:b,target:/^https?:/i.test(b)?"_blank":void 0,rel:/^https?:/i.test(b)?"noopener":void 0,className:"inline-flex text-xs font-medium text-slate-500 underline",children:w}):t.jsx("span",{className:"text-xs font-medium text-slate-500 underline",children:w}):null]})]}),g?t.jsx("div",{className:"relative hidden min-h-[340px] overflow-hidden bg-white md:block",style:{backgroundColor:o.imageBackground},children:t.jsx("img",{src:e.imageUrl,alt:e.title||"Offer artwork",className:"h-full w-full object-cover",style:{objectPosition:"center"}})}):null]})]})},P=()=>{const[e,c]=l.useState([]),[o,r]=l.useState("idle"),[d,u]=l.useState(null);l.useEffect(()=>{let s=!0;return(async()=>{var h,p;r("loading"),u(null);try{const a=await N({offersOnly:!0});if(!s)return;c(Array.isArray(a)?a:[]),r("success")}catch(a){if(!s)return;console.error("Failed to load offers",a),r("error"),u(((p=(h=a==null?void 0:a.response)==null?void 0:h.data)==null?void 0:p.message)||(a==null?void 0:a.message)||"Failed to load offers")}})(),()=>{s=!1}},[]);const x=l.useMemo(()=>e.filter(s=>(s==null?void 0:s.showOnOffersPage)!==!1),[e]);return t.jsx("div",{className:"min-h-[60vh] bg-slate-50 py-12",children:t.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:t.jsxs("div",{children:[t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white px-3 py-1 text-xs font-semibold uppercase tracking-[0.25em] text-blue-600 shadow-sm",children:[t.jsx(j,{size:14})," Storefront offers"]}),t.jsx("h1",{className:"mt-3 hidden text-3xl font-bold text-slate-900 sm:block md:text-4xl",children:"Current promotions & perks"}),t.jsx("p",{className:"mt-2 hidden max-w-2xl text-sm text-slate-500 sm:block md:text-base",children:"Explore every live offer available right now. Each lightbox below mirrors exactly what shoppers see on the homepage."})]})}),t.jsx("div",{className:"mt-10",children:o==="loading"?t.jsx("div",{className:"flex justify-center py-20",children:t.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white px-4 py-2 text-sm font-medium text-slate-600 shadow",children:[t.jsx(L,{className:"h-4 w-4 animate-spin"})," Loading offersâ€¦"]})}):d?t.jsx("div",{className:"rounded-3xl border border-rose-200 bg-white px-6 py-8 text-center text-rose-600 shadow-sm",children:d}):x.length?t.jsx(k.div,{layout:!0,className:"grid gap-6 md:grid-cols-2",children:x.map(s=>t.jsx(S,{offer:s},s._id))}):t.jsx("div",{className:"rounded-3xl border border-dashed border-slate-300 bg-white px-6 py-16 text-center text-slate-500 shadow-sm",children:"No active offers right now. Check back soon!"})})]})})};export{P as default};
