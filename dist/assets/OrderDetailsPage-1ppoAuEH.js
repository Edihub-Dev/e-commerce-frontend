import{r as x,j as e,m as es}from"./vendor-2d1PFKo4.js";import{i as ss,u as ts,k as as,a3 as ls,X as rs,_ as is,J as v,a4 as ns,a as cs,a5 as ds}from"./index-Bpx0OnSg.js";import{A as os}from"./arrow-left-fjWLrcm4.js";import{P as ms}from"./package-check-Bzx6Kak-.js";import{C as xs}from"./circle-check-CZUF0pO-.js";import{C as us}from"./circle-8xuaZdaz.js";import{R as qe}from"./rotate-ccw-Cv6fb4_h.js";import{C as ps}from"./circle-alert-tOb1bCg-.js";import{S as Pe}from"./star-DQTvdMJC.js";import{M as hs}from"./message-circle-BUAU0cKs.js";import{S as fs}from"./send-ywki2P6O.js";import{D as gs}from"./download-D5r73ZfU.js";import"./react-BzrpNAyj.js";const E=[{key:"order_confirmed",label:"Order Confirmed",defaultDescription:"Your order has been placed."},{key:"processed",label:"Processed",defaultDescription:"Seller has processed your order."},{key:"rejected",label:"Rejected",defaultDescription:"Order has been rejected and will not be fulfilled."},{key:"picked_up",label:"Picked Up",defaultDescription:"Your item has been picked up by delivery partner."},{key:"shipped",label:"Shipped",defaultDescription:"Package is on the way to the nearest hub."},{key:"out_for_delivery",label:"Out For Delivery",defaultDescription:"Your order is out for delivery."},{key:"delivered",label:"Delivered",defaultDescription:"Your item has been delivered."},{key:"returned",label:"Return Initiated",defaultDescription:"Return or replacement processing has begun."}],$e=g=>g?new Date(g).toLocaleString("en-IN"):"--",Me={"order placed":"order_confirmed","order confirmed":"order_confirmed",processed:"processed","seller processed":"processed",packed:"processed",picked_up:"picked_up","picked up":"picked_up","item picked up":"picked_up",shipped:"shipped",dispatched:"shipped","out for delivery":"out_for_delivery",delivered:"delivered",returned:"returned","return initiated":"returned","return approved":"returned","return request rejected":"returned",rejected:"rejected","order rejected":"rejected"},Oe=(g="")=>{const h=String(g).trim().toLowerCase();if(!h)return null;if(Me[h])return Me[h];const y=E.find(j=>j.label.toLowerCase()===h||j.key.replace(/_/g," ")===h);return(y==null?void 0:y.key)||null},bs=g=>{if(!g)return[];const h=new Map;(g.statusTimeline||[]).forEach((c={})=>{const d=Oe(c.label);if(!d)return;const p=h.get(d),k=c.at?new Date(c.at).getTime():0,z=p!=null&&p.at?new Date(p.at).getTime():0;(!p||k>=z)&&h.set(d,{label:c.label,description:c.description,at:c.at})});const y={processing:"order confirmed",confirmed:"order confirmed",picked_up:"picked up",shipped:"shipped",out_for_delivery:"out for delivery",delivered:"delivered",cancelled:"cancelled",returned:"returned",rejected:"rejected"},j=String(g.status||"").toLowerCase(),s=y[j]||j,S=Oe(s)||"order_confirmed",Y=S==="rejected",L=E.findIndex(c=>c.key===S),M=L===-1?0:L,O=h.size>0,_=!!(g.replacementRequest&&g.replacementRequest.status!=="none")||h.has("returned")||S==="returned"?E:E.filter(c=>c.key!=="returned");let I=_;if(Y){const c=_.findIndex(d=>d.key==="rejected");c!==-1&&(I=_.filter((d,p)=>p<=c))}else I=_.filter(c=>c.key==="rejected"?h.has("rejected"):!0);return I.map(c=>{const d=h.get(c.key)||null,p=I.findIndex(F=>F.key===c.key),k=O?L:M,z=S==="delivered";let C=!!(d!=null&&d.at),D=!1;return d!=null&&d.at||(k!==-1?p<k?C=!0:p===k&&!z&&(D=!0):!O&&p===0&&(D=!0)),z&&k!==-1&&(C=p<=k,D=!1),{...c,label:(d==null?void 0:d.label)||c.label,isCompleted:C,isCurrent:D,description:(d==null?void 0:d.description)||c.defaultDescription,at:(d==null?void 0:d.at)||null}})},ys=(g,h)=>{if(!h)return null;const y=String(g||"").trim().toLowerCase(),j=encodeURIComponent(h.trim());return y==="triupati"||y==="tirupati"?`https://trackcourier.io/track-and-trace/tirupati-courier/${j}`:y.includes("xpressbees")?`https://trackcourier.io/track-and-trace/xpressbees-logistics/${j}`:y.includes("delhivery")?`https://trackcourier.io/track-and-trace/delhivery-courier/${j}`:y.includes("india post")?`https://trackcourier.io/track-and-trace/india-post-domestic/${j}`:null},qs=()=>{var te,ae,le,re,ie,ne,ce,de,oe,me,xe,ue,pe,he,fe,ge,be,ye,je,Ne,ve,we,ke,Se,Ce,Ae,Ie,B,De,Re,Le;const{orderId:g}=ss(),h=ts(),j=((te=as().state)==null?void 0:te.from)==="admin-orders",[s,S]=x.useState(null),[Y,L]=x.useState(!0),[M,O]=x.useState(null),[Q,K]=x.useState(!1),[_,I]=x.useState(null),[c,d]=x.useState({}),[p,k]=x.useState(null),[z,C]=x.useState(!1),[D,F]=x.useState(!1),[b,V]=x.useState({itemIndex:0,description:"",size:"",color:"",remarks:""});x.useMemo(()=>{const t="http://localhost:5001/api";{const a=t.replace(/\/$/,"");return a.endsWith("/api")?a:`${a}/api`}},[]);const W=()=>{j?h("/admin/orders",{replace:!0}):h(-1)};x.useEffect(()=>{(async()=>{var a,r;try{L(!0);const i=await is(g),l=i==null?void 0:i.data;if(!l)throw new Error("Order not found");S(l)}catch(i){console.error("Failed to load order",i);const l=((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.message)||i.message||"Failed to load order";O(l),v.error(l)}finally{L(!1)}})()},[g]),x.useMemo(()=>{var w,m,f,N,u,A,_e,ze;if(!s)return null;const t=(s.items||[]).map(T=>{const Te=[T.quantity?`x${T.quantity}`:null,T.size?`Size ${T.size}`:null].filter(Boolean).join(" ");return Te?`${T.name} (${Te})`:T.name}).join(" | "),a={paid:"Successful",pending:"Pending",failed:"Failed"},r={cod:"Cash on Delivery",upi:"UPI",qr:"QR Code",card:"Card",netbanking:"Net Banking"},i=(m=(w=s.payment)==null?void 0:w.status)==null?void 0:m.toLowerCase(),l=(N=(f=s.payment)==null?void 0:f.method)==null?void 0:N.toLowerCase(),n=s.totalAmount??((u=s.pricing)==null?void 0:u.total)??0;return{id:s._id,placedAt:s.createdAt?new Date(s.createdAt).toISOString():"",customer:((A=s.shippingAddress)==null?void 0:A.fullName)||"Customer",email:((_e=s.shippingAddress)==null?void 0:_e.email)||"--",itemsSummary:t,total:Number(n).toFixed(2),orderStatus:(s.status||"processing").replace(/_/g," "),paymentMethod:r[l]||((ze=l==null?void 0:l.toUpperCase)==null?void 0:ze.call(l))||"",paymentStatus:a[i]||i||""}},[s]);const Fe=x.useMemo(()=>s!=null&&s.estimatedDeliveryDate?new Date(s.estimatedDeliveryDate).toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"To be updated",[s==null?void 0:s.estimatedDeliveryDate]),H=x.useMemo(()=>bs(s),[s]);x.useEffect(()=>{var t;(t=s==null?void 0:s.items)!=null&&t.length&&V(a=>({...a,itemIndex:a.itemIndex>=0&&a.itemIndex<s.items.length?a.itemIndex:0}))},[(ae=s==null?void 0:s.items)==null?void 0:ae.length]);const q=x.useMemo(()=>{var t;if(!((t=s==null?void 0:s.statusTimeline)!=null&&t.length))return(s==null?void 0:s.status)==="delivered"?s.updatedAt:null;for(let a=s.statusTimeline.length-1;a>=0;a-=1){const r=s.statusTimeline[a];if(String((r==null?void 0:r.label)||"").toLowerCase().includes("delivered"))return r.at||r.createdAt||r.updatedAt||null}return(s==null?void 0:s.status)==="delivered"?s.updatedAt:null},[s==null?void 0:s.statusTimeline,s==null?void 0:s.status,s==null?void 0:s.updatedAt]),o=(s==null?void 0:s.replacementRequest)||{},U=!!(o!=null&&o.status&&o.status!=="none"),J=x.useMemo(()=>{if(!q)return!1;const t=new Date(q).getTime();if(Number.isNaN(t))return!1;const a=Date.now()-t,r=10080*60*1e3;return a>=0&&a<=r},[q]),Ue=J&&!U&&!o.used,Z=x.useMemo(()=>!!(q&&(s==null?void 0:s.status)==="delivered"),[q,s==null?void 0:s.status]),ee=x.useMemo(()=>U?null:J?"Return & replace can be requested once per order while the request window is active.":"Return & replace is available within 7 days after delivery.",[U,J]),Be=(t,a)=>{var r,i;if(!((i=(r=s==null?void 0:s.items)==null?void 0:r[t])!=null&&i.ratedAt||p!==null)){if(!Z){v.error("You can rate items after the order is delivered.");return}I(t),d(l=>{var n;return{...l,[t]:{rating:a,review:((n=l[t])==null?void 0:n.review)||""}}})}},Ee=(t,a)=>{d(r=>{var i;return{...r,[t]:{rating:((i=r[t])==null?void 0:i.rating)||0,review:a}}})},Ye=()=>{V(t=>({...t,itemIndex:t.itemIndex??0,description:"",size:"",color:"",remarks:""})),C(!0)},P=(t,a)=>{V(r=>({...r,[t]:a}))},X=x.useMemo(()=>{var t;return(t=s==null?void 0:s.items)!=null&&t.length&&s.items[b.itemIndex]||null},[s==null?void 0:s.items,b.itemIndex]),Qe=async t=>{var a,r;if(t.preventDefault(),!!(s!=null&&s._id)){if(!b.description||b.description.trim().length<10){v.error("Please describe the issue (minimum 10 characters).");return}try{F(!0);const i={itemIndex:b.itemIndex,description:b.description.trim(),replacement:{size:b.size.trim()||void 0,color:b.color.trim()||void 0,remarks:b.remarks.trim()||void 0}},l=await ds(s._id,i);if(!(l!=null&&l.success))throw new Error((l==null?void 0:l.message)||"Failed to submit request");S(n=>({...n,replacementRequest:l.data})),C(!1),v.success("Replacement request sent to support.")}catch(i){console.error("Replacement request failed",i);const l=((r=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:r.message)||(i==null?void 0:i.message)||"Failed to submit request";v.error(l)}finally{F(!1)}}},Ke=async t=>{var r,i,l;const a=c[t];if(!(!(a!=null&&a.rating)||p!==null||(i=(r=s==null?void 0:s.items)==null?void 0:r[t])!=null&&i.ratedAt))try{k(t);const n=await ns(s._id,{itemIndex:t,rating:a.rating,review:(l=a.review)==null?void 0:l.trim()});if(!(n!=null&&n.success))throw new Error((n==null?void 0:n.message)||"Unable to submit rating");const w=s.items.map((m,f)=>{var N,u,A;return f===t?{...m,rating:(N=n.data)==null?void 0:N.rating,review:(u=n.data)==null?void 0:u.review,ratedAt:(A=n.data)==null?void 0:A.ratedAt}:m});S(m=>({...m,items:w})),I(null),d(m=>{const f={...m};return delete f[t],f}),v.success("Thank you for rating this product!")}catch(n){console.error("Failed to submit rating",n),v.error(n.message||"Unable to submit rating")}finally{k(null)}};if(Y)return e.jsx("div",{className:clsx("max-w-5xl","mx-auto","px-4","lg:px-6","py-10","text-center","text-medium-text"),children:"Fetching order details..."});if(M||!s)return e.jsxs("div",{className:clsx("max-w-5xl","mx-auto","px-4","lg:px-6","py-10","text-center","space-y-4"),children:[e.jsx("p",{className:clsx("text-lg","font-semibold","text-secondary"),children:"Unable to load order"}),e.jsx("p",{className:"text-medium-text",children:M||"Order not found"}),e.jsx("button",{onClick:W,className:clsx("px-4","py-2","rounded-lg","bg-primary","text-white","hover:bg-primary-dark"),children:"Back to Orders"})]});const Ve=(((le=s==null?void 0:s.payment)==null?void 0:le.status)||"pending").toLowerCase()==="paid",We=!!(((re=s==null?void 0:s.invoice)==null?void 0:re.url)||(s==null?void 0:s.invoiceUrl)),G=Ve||We,He=async()=>{var a,r,i;if(!(s!=null&&s._id)){v.error("Order details unavailable");return}if(!G){v.error("Invoice will be available once payment is successful or the invoice is generated.");return}K(!0);let t=null;try{t=v.loading("Downloading invoice...",{duration:1e4,position:"top-center"});const l=await cs.get(`/orders/${s._id}/invoice`,{responseType:"blob",headers:{Accept:"application/pdf"}}),n=l.data,m=(((a=l.headers)==null?void 0:a["content-disposition"])||"").match(/filename="?([^";]+)"?/i),f=(m==null?void 0:m[1])||`invoice-${s._id}.pdf`,N=window.URL.createObjectURL(n),u=document.createElement("a");u.href=N,u.download=f,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(N),v.success("Invoice downloaded.",{id:t,duration:4e3,position:"top-center"})}catch(l){console.error("Invoice download failed",l);const n=((i=(r=l==null?void 0:l.response)==null?void 0:r.data)==null?void 0:i.message)||(l==null?void 0:l.message)||"Invoice download failed.";v.error(n,{id:t||void 0,duration:4e3,position:"top-center"})}finally{K(!1)}},$=t=>(Number.isFinite(Number(t))?Number(t):0).toLocaleString("en-IN",{style:"currency",currency:"INR"}),Je=((ie=s==null?void 0:s.pricing)==null?void 0:ie.subtotal)??((ne=s==null?void 0:s.pricing)==null?void 0:ne.itemTotal)??0,Xe=((ce=s==null?void 0:s.pricing)==null?void 0:ce.shippingFee)??0,Ge=((de=s==null?void 0:s.pricing)==null?void 0:de.taxAmount)??0,se=((oe=s==null?void 0:s.pricing)==null?void 0:oe.discount)??0,Ze=((me=s==null?void 0:s.pricing)==null?void 0:me.total)??(s==null?void 0:s.totalAmount)??0,R=s==null?void 0:s.coupon;return Number.isFinite(Number(R==null?void 0:R.discountAmount))&&Number(R.discountAmount),e.jsxs("div",{className:clsx("max-w-5xl","mx-auto","px-4","lg:px-6","py-8","lg:py-10","space-y-6"),children:[e.jsxs("button",{onClick:W,className:clsx("inline-flex","items-center","gap-2","text-sm","text-medium-text","hover:text-secondary"),children:[e.jsx(os,{className:clsx("h-4","w-4")})," Back"]}),e.jsxs(es.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","space-y-4"),children:[e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","justify-between","gap-3"),children:[e.jsxs("h1",{className:clsx("text-2xl","font-semibold","text-secondary","break-all"),children:["Order #",s._id]}),e.jsxs("p",{className:clsx("text-sm","text-medium-text","break-words"),children:["Placed on ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:clsx("grid","gap-4","text-sm","text-medium-text","md:grid-cols-2","md:items-end"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-2"),children:[e.jsx(ms,{className:clsx("h-4","w-4","text-secondary")}),e.jsxs("span",{className:clsx("whitespace-nowrap","text-secondary"),children:[e.jsx("span",{className:"font-medium",children:"Items:"})," ",e.jsx("span",{className:"text-medium-text",children:((xe=s.items)==null?void 0:xe.length)||0})]})]}),e.jsxs("div",{className:clsx("flex","items-center","gap-2","md:justify-end","md:text-right"),children:[e.jsx(ls,{className:clsx("h-4","w-4","text-secondary")}),e.jsxs("span",{className:clsx("text-secondary","md:text-right"),children:[e.jsx("span",{className:"font-medium",children:"Estimated delivery:"})," ",e.jsx("span",{className:clsx("text-medium-text","whitespace-nowrap"),children:Fe})]})]})]})]}),e.jsxs("section",{className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","space-y-6"),children:[e.jsxs("header",{className:"space-y-1",children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-secondary"),children:"Tracking Updates"}),e.jsxs("p",{className:clsx("text-sm","text-medium-text"),children:["Tracking ID:"," ",(ue=s==null?void 0:s.shipping)!=null&&ue.trackingId?e.jsx("a",{href:ys((pe=s==null?void 0:s.shipping)==null?void 0:pe.courier,s.shipping.trackingId)||void 0,target:"_blank",rel:"noopener noreferrer",className:clsx("font-semibold","text-primary","underline-offset-4","hover:underline"),children:s.shipping.trackingId}):"To be assigned"]}),e.jsxs("p",{className:clsx("text-xs","text-slate-400"),children:["Courier: ",((he=s==null?void 0:s.shipping)==null?void 0:he.courier)||"Ekart Logistics"]})]}),e.jsx("div",{className:"relative",children:e.jsx("ul",{className:"relative",children:H.map((t,a)=>{var N;const r=t.isCompleted?xs:us,l=!(a===H.length-1),n=a>0?H[a-1]:null,w=a>0,m=u=>u!=null&&u.isCompleted?"bg-emerald-500":u!=null&&u.isCurrent?"bg-primary/40":"bg-slate-200",f={"--timeline-marker-size":"1.5rem","--timeline-gap":"1.5rem"};return e.jsxs("li",{className:clsx("relative","grid","grid-cols-[auto,1fr]","gap-4","py-6","first:pt-0","last:pb-0"),style:f,children:[e.jsxs("div",{className:clsx("relative","flex","w-6","justify-center"),children:[w&&e.jsx("span",{"aria-hidden":"true",className:`absolute left-1/2 w-[2px] -translate-x-1/2 ${m(n)}`,style:{top:"calc(-1 * var(--timeline-gap))",bottom:"calc(var(--timeline-marker-size) / 2)"}}),e.jsx("span",{className:`relative z-10 inline-flex h-[var(--timeline-marker-size)] w-[var(--timeline-marker-size)] items-center justify-center rounded-full border-2 ${t.isCompleted?"border-emerald-500 bg-emerald-500 text-white":t.isCurrent?"border-primary bg-white text-primary":"border-slate-300 bg-white text-slate-300"}`,children:e.jsx(r,{className:clsx("h-3.5","w-3.5")})}),l&&e.jsx("span",{"aria-hidden":"true",className:`absolute left-1/2 w-[2px] -translate-x-1/2 ${m(t)}`,style:{top:"calc(var(--timeline-marker-size) / 2)",bottom:"calc(-1 * var(--timeline-gap))"}})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-2"),children:[e.jsx("p",{className:clsx("text-sm","font-semibold","text-secondary"),children:t.label}),t.at&&e.jsx("span",{className:clsx("text-xs","text-slate-400"),children:$e(t.at)})]}),e.jsx("p",{className:clsx("text-sm","text-medium-text","whitespace-pre-line"),children:t.description}),t.key==="shipped"&&((N=s==null?void 0:s.shipping)==null?void 0:N.trackingId)&&e.jsxs("div",{className:clsx("rounded-xl","bg-slate-50","px-3","py-2","text-xs","text-medium-text"),children:[e.jsxs("p",{children:[s.shipping.courier||"Ekart Logistics"," •"," ",s.shipping.trackingId]}),e.jsxs("p",{className:clsx("mt-1","text-slate-400"),children:["Last updated"," ",$e(s.shipping.updatedAt)]})]})]})]},t.key)})})})]}),U?e.jsxs("section",{className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","space-y-4"),children:[e.jsxs("header",{className:clsx("flex","flex-wrap","items-center","justify-between","gap-3"),children:[e.jsxs("div",{children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-secondary"),children:"Return & Replace status"}),e.jsxs("p",{className:clsx("text-xs","text-medium-text"),children:["Requested on"," ",o.requestedAt?new Date(o.requestedAt).toLocaleString():"--"]})]}),e.jsxs("span",{className:clsx("inline-flex","items-center","gap-2","rounded-full","bg-primary/10","px-3","py-1","text-xs","font-medium","text-primary"),children:[e.jsx("span",{className:clsx("h-2","w-2","rounded-full","bg-primary")}),o.status.replace(/_/g," ")]})]}),e.jsxs("div",{className:clsx("grid","gap-4","md:grid-cols-2"),children:[e.jsxs("div",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsx("h3",{className:clsx("text-sm","font-semibold","text-secondary"),children:"Item details"}),e.jsxs("p",{className:clsx("font-medium","text-secondary"),children:[o.itemName,o.itemSize&&` • Size ${o.itemSize}`]}),e.jsxs("p",{children:["Quantity: ",o.quantity||1]}),o.issueDescription&&e.jsx("p",{className:clsx("rounded-xl","border","border-slate-200","bg-slate-50","p-3","text-sm","text-slate-600"),children:o.issueDescription})]}),e.jsxs("div",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsx("h3",{className:clsx("text-sm","font-semibold","text-secondary"),children:"Replacement preference"}),e.jsxs("p",{children:["Size: ",((fe=o.replacementPreferences)==null?void 0:fe.size)||"--"]}),e.jsxs("p",{children:["Color:"," ",((ge=o.replacementPreferences)==null?void 0:ge.color)||"--"]}),e.jsxs("p",{children:["Notes:"," ",((be=o.replacementPreferences)==null?void 0:be.remarks)||"--"]}),o.adminNotes&&e.jsxs("p",{className:clsx("rounded-xl","border","border-primary/20","bg-primary/5","p-3","text-sm","text-primary"),children:["Admin notes: ",o.adminNotes]})]})]}),Array.isArray(o.history)&&o.history.length?e.jsxs("div",{className:clsx("rounded-2xl","border","border-slate-200","bg-slate-50","p-4"),children:[e.jsx("h3",{className:clsx("mb-3","text-sm","font-semibold","text-secondary"),children:"Activity"}),e.jsx("ul",{className:clsx("space-y-2","text-xs","text-medium-text"),children:o.history.slice().reverse().map((t,a)=>{var r;return e.jsxs("li",{className:clsx("flex","items-start","gap-2"),children:[e.jsx("span",{className:clsx("mt-0.5","inline-flex","h-2","w-2","rounded-full","bg-primary")}),e.jsxs("div",{children:[e.jsx("p",{className:clsx("font-medium","text-secondary"),children:((r=t.status)==null?void 0:r.replace(/_/g," "))||"Update"}),e.jsx("p",{className:"text-medium-text",children:t.note||"Status updated"}),e.jsxs("p",{className:clsx("text-[10px]","text-slate-400"),children:[t.at?new Date(t.at).toLocaleString():"--",t.actor?` • by ${t.actor}`:""]})]})]},`${t.at||a}-${t.status}`)})})]}):null]}):null,e.jsxs("section",{className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","space-y-4"),children:[e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","justify-between","gap-3"),children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-secondary"),children:"Items in your order"}),Ue&&e.jsxs("button",{type:"button",onClick:Ye,className:clsx("inline-flex","items-center","gap-2","rounded-xl","bg-primary","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","transition","hover:bg-primary-dark"),children:[e.jsx(qe,{className:clsx("h-4","w-4")})," Request return & replace"]})]}),ee&&e.jsxs("div",{className:clsx("flex","items-center","gap-2","rounded-xl","border","border-amber-200","bg-amber-50","px-3","py-2","text-xs","text-amber-700"),children:[e.jsx(ps,{className:clsx("h-4","w-4")}),ee]}),e.jsx("div",{className:"space-y-4",children:(ye=s.items)==null?void 0:ye.map((t,a)=>{var l,n;const r=t.price.toLocaleString(),i=(t.price*t.quantity).toLocaleString();return e.jsxs("div",{className:clsx("flex","flex-col","gap-4","rounded-2xl","border","border-slate-200","p-4"),children:[e.jsxs("div",{className:clsx("flex","gap-4"),children:[e.jsx("div",{className:clsx("flex","h-20","w-20","items-center","justify-center","overflow-hidden","rounded-xl","border","border-slate-200","bg-white"),children:e.jsx("img",{src:t.image,alt:t.name,className:clsx("max-h-full","max-w-full","object-contain")})}),e.jsxs("div",{className:clsx("flex-1","space-y-1"),children:[e.jsx("p",{className:clsx("font-semibold","text-secondary"),children:t.name}),e.jsxs("p",{className:clsx("text-sm","text-medium-text"),children:["Qty: ",t.quantity,t.size&&e.jsxs("span",{className:"ml-2",children:["• Size: ",t.size]})]}),e.jsxs("p",{className:clsx("text-sm","text-medium-text"),children:["Price: ₹",r]}),e.jsxs("p",{className:clsx("text-sm","text-medium-text"),children:["Line Total: ₹",i]})]})]}),e.jsx("div",{className:clsx("border-t","border-slate-100","pt-3"),children:t.ratedAt?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:clsx("flex","items-center","gap-2","text-sm","text-secondary"),children:[[...Array(5)].map((w,m)=>e.jsx(Pe,{size:18,className:m<Math.round(t.rating||0)?"fill-yellow-400 text-yellow-400":"text-slate-300"},m)),e.jsxs("span",{className:clsx("text-xs","text-medium-text"),children:["Rated on ",new Date(t.ratedAt).toLocaleDateString()]})]}),t.review&&e.jsxs("div",{className:clsx("flex","items-start","gap-2","rounded-xl","bg-slate-50","p-3","text-sm","text-medium-text"),children:[e.jsx(hs,{className:clsx("h-4","w-4","text-secondary","mt-0.5")}),e.jsx("p",{className:clsx("whitespace-pre-line","break-words"),children:t.review})]})]}):Z?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:clsx("flex","items-center","gap-2"),children:[...Array(5)].map((w,m)=>{var A;const f=m+1,u=(((A=c[a])==null?void 0:A.rating)||0)>=f;return e.jsx("button",{type:"button",onClick:()=>Be(a,f),className:"focus:outline-none",disabled:p!==null,"aria-label":`Rate ${f} star${f>1?"s":""}`,children:e.jsx(Pe,{size:24,className:u?"fill-yellow-400 text-yellow-400":"text-slate-300"})},f)})}),_===a&&((l=c[a])==null?void 0:l.rating)>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:((n=c[a])==null?void 0:n.review)||"",onChange:w=>Ee(a,w.target.value),placeholder:"Share your experience with this product (optional)",className:clsx("w-full","rounded-xl","border","border-slate-200","bg-white","px-3","py-2","text-sm","text-medium-text","focus:border-primary","focus:outline-none"),rows:3,maxLength:2e3,disabled:p!==null}),e.jsx("div",{className:clsx("flex","justify-end"),children:e.jsxs("button",{type:"button",onClick:()=>Ke(a),disabled:p!==null,className:clsx("inline-flex","items-center","gap-2","rounded-xl","bg-primary","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary/90","disabled:cursor-not-allowed","disabled:opacity-60"),children:[e.jsx(fs,{className:clsx("h-4","w-4")}),p===a?"Submitting...":"Submit review"]})})]})]}):null})]},`${t.name}-${a}`)})})]}),e.jsxs("section",{className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","grid","md:grid-cols-2","gap-6"),children:[e.jsxs("div",{className:clsx("space-y-2","text-sm","text-medium-text","break-words"),children:[e.jsx("h3",{className:clsx("text-lg","font-semibold","text-secondary","mb-2"),children:"Delivery Address"}),e.jsx("p",{className:clsx("font-medium","text-secondary"),children:(je=s.shippingAddress)==null?void 0:je.fullName}),e.jsx("p",{children:(Ne=s.shippingAddress)==null?void 0:Ne.addressLine}),e.jsxs("p",{children:[(ve=s.shippingAddress)==null?void 0:ve.city,", ",(we=s.shippingAddress)==null?void 0:we.state," -"," ",(ke=s.shippingAddress)==null?void 0:ke.pincode]}),e.jsxs("p",{children:["Mobile: ",(Se=s.shippingAddress)==null?void 0:Se.mobile]}),((Ce=s.shippingAddress)==null?void 0:Ce.alternatePhone)&&e.jsxs("p",{children:["Alternate: ",s.shippingAddress.alternatePhone]}),e.jsxs("p",{children:["Email: ",(Ae=s.shippingAddress)==null?void 0:Ae.email]})]}),e.jsxs("div",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsxs("div",{className:clsx("mb-2","flex","items-center","justify-between","gap-3"),children:[e.jsx("h3",{className:clsx("text-lg","font-semibold","text-secondary"),children:"Payment Summary"}),(R==null?void 0:R.code)&&e.jsx("span",{className:clsx("inline-flex","items-center","rounded-full","bg-emerald-50","px-3","py-1","text-xs","font-semibold","uppercase","tracking-wide","text-emerald-600"),children:"Coupon applied"})]}),e.jsxs("p",{className:clsx("flex","justify-between","gap-3"),children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:$(Je)})]}),e.jsxs("p",{className:clsx("flex","justify-between","gap-3"),children:[e.jsx("span",{children:"Shipping Fee"}),e.jsx("span",{children:$(Xe)})]}),e.jsxs("p",{className:clsx("flex","justify-between","gap-3"),children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:$(Ge)})]}),e.jsxs("p",{className:clsx("flex","justify-between","text-success","font-medium","gap-3"),children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-",$(se)]})]}),e.jsxs("p",{className:clsx("flex","justify-between","text-base","font-semibold","text-slate-900","border-t","border-slate-200","pt-3","gap-3"),children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:$(Ze)})]}),e.jsxs("p",{className:clsx("text-xs","text-slate-400","pt-1","break-words"),children:["Method: ",(De=(B=(Ie=s.payment)==null?void 0:Ie.method)==null?void 0:B.toUpperCase)==null?void 0:De.call(B)," • Status:"," ",(Re=s.payment)==null?void 0:Re.status]})]})]}),e.jsxs("div",{className:clsx("flex","flex-wrap","gap-3","justify-end"),children:[e.jsx("button",{onClick:W,className:clsx("px-5","py-3","rounded-xl","border","border-slate-200","text-secondary","hover:bg-slate-50"),children:"Back to Orders"}),e.jsxs("button",{type:"button",onClick:He,disabled:Q||!G,className:clsx("px-5","py-3","rounded-xl","bg-primary","text-white","hover:bg-primary-dark","disabled:opacity-50","disabled:cursor-not-allowed","inline-flex","items-center","gap-2"),children:[e.jsx(gs,{className:clsx("h-4","w-4")}),Q?"Preparing Invoice...":G?"Download Invoice":"Invoice available after payment"]})]}),z&&e.jsx("div",{className:clsx("fixed","inset-0","z-40","flex","items-center","justify-center","bg-slate-900/40","px-4"),children:e.jsxs("div",{className:clsx("w-full","max-w-2xl","rounded-3xl","bg-white","p-6","shadow-xl"),children:[e.jsxs("div",{className:clsx("mb-4","flex","items-start","justify-between","gap-4"),children:[e.jsxs("div",{children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-secondary"),children:"Return & Replace request"}),e.jsx("p",{className:clsx("text-xs","text-medium-text"),children:"Tell us what went wrong so we can arrange a replacement."})]}),e.jsx("button",{type:"button",onClick:()=>C(!1),className:clsx("rounded-full","border","border-slate-200","bg-white","p-1","text-slate-500","hover:bg-slate-100"),children:e.jsx(rs,{className:clsx("h-4","w-4")})})]}),e.jsxs("form",{className:"space-y-4",onSubmit:Qe,children:[e.jsxs("div",{className:clsx("grid","gap-4","md:grid-cols-[1.4fr_1fr]"),children:[e.jsxs("label",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsx("span",{className:clsx("font-medium","text-secondary"),children:"Select product"}),e.jsx("select",{value:b.itemIndex,onChange:t=>P("itemIndex",Number(t.target.value)),className:clsx("w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),children:(Le=s==null?void 0:s.items)==null?void 0:Le.map((t,a)=>e.jsxs("option",{value:a,children:[t.name,t.size?` • Size ${t.size}`:""]},`${t.name}-${a}`))})]}),X?e.jsx("div",{className:clsx("flex","items-center","justify-center","rounded-xl","border","border-slate-100","bg-slate-50","p-3"),children:e.jsx("img",{src:X.image,alt:X.name,className:clsx("h-20","w-20","rounded-lg","object-contain")})}):null]}),e.jsxs("label",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsx("span",{className:clsx("font-medium","text-secondary"),children:"Describe the issue"}),e.jsx("textarea",{value:b.description,onChange:t=>P("description",t.target.value),required:!0,minLength:10,rows:4,className:clsx("w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),placeholder:"Share what went wrong with the product."})]}),e.jsxs("div",{className:clsx("grid","gap-4","md:grid-cols-2"),children:[e.jsxs("label",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsx("span",{className:clsx("font-medium","text-secondary"),children:"Preferred size"}),e.jsx("input",{value:b.size,onChange:t=>P("size",t.target.value),className:clsx("w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),placeholder:"e.g. L"})]}),e.jsxs("label",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsx("span",{className:clsx("font-medium","text-secondary"),children:"Preferred color"}),e.jsx("input",{value:b.color,onChange:t=>P("color",t.target.value),className:clsx("w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),placeholder:"e.g. Blue"})]})]}),e.jsxs("label",{className:clsx("space-y-2","text-sm","text-medium-text"),children:[e.jsx("span",{className:clsx("font-medium","text-secondary"),children:"Additional notes (optional)"}),e.jsx("input",{value:b.remarks,onChange:t=>P("remarks",t.target.value),className:clsx("w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),placeholder:"Share anything else the team should know."})]}),e.jsxs("div",{className:clsx("flex","flex-wrap","justify-end","gap-3","pt-2"),children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:clsx("rounded-xl","border","border-slate-200","px-4","py-2","text-sm","text-secondary","hover:bg-slate-50"),children:"Cancel"}),e.jsx("button",{type:"submit",disabled:D,className:clsx("inline-flex","items-center","gap-2","rounded-xl","bg-primary","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","transition","hover:bg-primary-dark","disabled:cursor-not-allowed","disabled:opacity-60"),children:D?e.jsx(e.Fragment,{children:"Submitting..."}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:clsx("h-4","w-4")})," Send request"]})})]})]})]})})]})};export{qs as default};
