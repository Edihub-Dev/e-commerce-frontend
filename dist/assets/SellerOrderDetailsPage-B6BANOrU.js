import{r as d,j as e,m as C}from"./vendor-2d1PFKo4.js";import{c as ze,i as Ee,u as Fe,k as Be,_ as Me,J as g,as as Qe,a3 as We,a as Ge,aD as He}from"./index-Bpx0OnSg.js";import{L as T}from"./loader-circle-DRAKHMK_.js";import{A as ve}from"./arrow-left-fjWLrcm4.js";import{D as Je}from"./download-D5r73ZfU.js";import{P as Ve}from"./package-check-Bzx6Kak-.js";import{C as Ke}from"./credit-card-BgETEGky.js";import{R as Xe,C as we}from"./receipt-DMCEhblB.js";import{R as Ye}from"./rotate-ccw-Cv6fb4_h.js";import"./react-BzrpNAyj.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],es=ze("external-link",Ze),ss={processing:{label:"Processing",badge:"bg-amber-100 text-amber-700"},confirmed:{label:"Confirmed",badge:"bg-blue-100 text-blue-700"},shipped:{label:"Shipped",badge:"bg-sky-100 text-sky-700"},out_for_delivery:{label:"Out for Delivery",badge:"bg-indigo-100 text-indigo-700"},delivered:{label:"Delivered",badge:"bg-emerald-100 text-emerald-700"},returned:{label:"Return/Replace",badge:"bg-rose-100 text-rose-700"}},ts=[{value:"approved",label:"Approved"},{value:"pickup_completed",label:"Pickup completed"},{value:"replacement_processing",label:"Replacement processing"},{value:"replacement_shipped",label:"Replacement shipped"},{value:"replacement_out_for_delivery",label:"Out for delivery"},{value:"replacement_delivered",label:"Replacement delivered"},{value:"rejected",label:"Rejected"},{value:"cancelled",label:"Cancelled"}],h=new Set(["rejected"]),f=i=>(Number.isFinite(Number(i))?Number(i):0).toLocaleString("en-IN",{style:"currency",currency:"INR"}),as=(i,o="--")=>{if(!i)return o;const c=new Date(i);return Number.isNaN(c.getTime())?o:c.toLocaleString()},ls=(i,o="--")=>{if(!i)return o;const c=new Date(i);return Number.isNaN(c.getTime())?o:c.toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},ns=(i,o)=>{if(!o)return null;const c=String(i||"").trim().toLowerCase(),p=encodeURIComponent(o.trim());return c==="triupati"||c==="tirupati"?`https://trackcourier.io/track-and-trace/tirupati-courier/${p}`:c.includes("xpressbees")?`https://trackcourier.io/track-and-trace/xpressbees-logistics/${p}`:c.includes("delhivery")?`https://trackcourier.io/track-and-trace/delhivery-courier/${p}`:c.includes("india post")?`https://trackcourier.io/track-and-trace/india-post-domestic/${p}`:null},fs=({allowReplacementActions:i}={})=>{var W,G,H,J,V,K,X,Y,Z,ee,se,te,ae,le,ne,A,re,ce,ie,oe,de,xe,me,pe,ue,he,be,ge,fe,je,Ne,ye;const{orderId:o}=Ee(),c=Fe(),p=Be(),[s,ke]=d.useState(null),[Re,_]=d.useState(!0),[L,U]=d.useState(null),[P,O]=d.useState(!1),[n,y]=d.useState({status:"approved",notes:"",courier:"",trackingId:""}),[$,z]=d.useState(!1),v=d.useRef(null),w=i??((W=p.state)==null?void 0:W.allowReplacementActions)??!0,E=p.pathname.startsWith("/subadmin"),Se=((G=p.state)==null?void 0:G.returnTo)||(E&&sellerId?`/subadmin/sellers/${sellerId}`:"/seller/orders"),qe=(H=p.state)==null?void 0:H.returnState,Ae=((J=p.state)==null?void 0:J.returnLabel)||(E?"Back to seller orders":"Back to orders"),I=d.useCallback(async()=>{var t,a;try{_(!0),U(null);const r=await Me(o),l=r==null?void 0:r.data;if(!l)throw new Error("Order not found");ke(l),l.replacementRequest&&l.replacementRequest.status!=="none"&&y(b=>{var j,u;return{...b,status:"approved",notes:"",courier:((j=l.replacementRequest.replacementShipment)==null?void 0:j.courier)||"",trackingId:((u=l.replacementRequest.replacementShipment)==null?void 0:u.trackingId)||""}})}catch(r){console.error("Failed to load order",r);const l=((a=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Failed to load order";U(l),g.error(l)}finally{_(!1)}},[o]);d.useEffect(()=>{I()},[I]);const F=()=>{c(Se,{state:qe})},Ce=(((V=s==null?void 0:s.payment)==null?void 0:V.status)||"pending").toLowerCase()==="paid",Ie=!!(((K=s==null?void 0:s.invoice)==null?void 0:K.url)||(s==null?void 0:s.invoiceUrl)),k=Ce||Ie,R=(t,a)=>{y(r=>({...r,[t]:a}))};d.useEffect(()=>{var t;h.has(n.status)&&(y(a=>({...a,notes:a.notes||""})),(t=v.current)==null||t.focus())},[n.status]);const B=t=>{w&&(y(a=>({...a,status:t,notes:h.has(t)?"":a.notes})),h.has(t)&&setTimeout(()=>{var a;(a=v.current)==null||a.focus(),g("Add a reason before submitting your decision.")},0))},De=async()=>{var t,a,r;if(!(s!=null&&s._id)){g.error("Order details unavailable");return}if(!k){g.error("Invoice will be available once payment is successful or the invoice is generated.");return}O(!0);try{const l=await Ge.get(`/orders/${s._id}/invoice`,{responseType:"blob",headers:{Accept:"application/pdf"}}),b=l.data,u=(((t=l.headers)==null?void 0:t["content-disposition"])||"").match(/filename="?([^";]+)"?/i),x=(u==null?void 0:u[1])||`invoice-${s._id}.pdf`,m=window.URL.createObjectURL(b),N=document.createElement("a");N.href=m,N.download=x,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(m)}catch(l){console.error("Invoice download failed",l);const b=((r=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:r.message)||(l==null?void 0:l.message)||"Unable to download invoice. Please try again.";g.error(b)}finally{O(!1)}},Te=async t=>{var a,r,l,b,j,u;if(t.preventDefault(),!(!w||!(s!=null&&s._id))){if(h.has(n.status)&&!(n.notes&&n.notes.trim())){g.error("Please provide a reason for rejecting this request."),(a=v.current)==null||a.focus();return}try{z(!0);const x={status:n.status,notes:((r=n.notes)==null?void 0:r.trim())||void 0,courier:((l=n.courier)==null?void 0:l.trim())||void 0,trackingId:((b=n.trackingId)==null?void 0:b.trim())||void 0},m=await He(s._id,x);if(!(m!=null&&m.success))throw new Error((m==null?void 0:m.message)||"Failed to update request");g.success("Replacement request updated"),await I()}catch(x){console.error("Failed to update replacement request",x);const m=((u=(j=x==null?void 0:x.response)==null?void 0:j.data)==null?void 0:u.message)||(x==null?void 0:x.message)||"Unable to update replacement request";g.error(m)}finally{z(!1)}}},_e=d.useMemo(()=>{const t=String((s==null?void 0:s.status)||"").toLowerCase(),a=ss[t];return a?e.jsx("span",{className:`inline-flex rounded-full px-3 py-1 text-xs font-medium ${a.badge}`,children:a.label}):e.jsx("span",{className:clsx("inline-flex","rounded-full","bg-slate-100","px-3","py-1","text-xs","text-slate-600"),children:"Unknown"})},[s==null?void 0:s.status]),Le=d.useMemo(()=>ls(s==null?void 0:s.estimatedDeliveryDate),[s==null?void 0:s.estimatedDeliveryDate]),Ue=((X=s==null?void 0:s.pricing)==null?void 0:X.subtotal)??0,Pe=((Y=s==null?void 0:s.pricing)==null?void 0:Y.shippingFee)??0,Oe=((Z=s==null?void 0:s.pricing)==null?void 0:Z.taxAmount)??0,$e=((ee=s==null?void 0:s.pricing)==null?void 0:ee.discount)??0,M=((se=s==null?void 0:s.pricing)==null?void 0:se.total)??0,S=s==null?void 0:s.coupon,Q=typeof(S==null?void 0:S.code)=="string"?S.code.trim():"",q=ns((te=s==null?void 0:s.shipping)==null?void 0:te.courier,(ae=s==null?void 0:s.shipping)==null?void 0:ae.trackingId),D=Array.isArray(s==null?void 0:s.items)?s.items:[];return Re?e.jsxs("div",{className:clsx("flex","h-full","items-center","justify-center","text-slate-500"),children:[e.jsx(T,{className:clsx("h-6","w-6","animate-spin")}),e.jsx("span",{className:clsx("ml-3","text-sm"),children:"Loading order details..."})]}):L||!s?e.jsx("div",{className:clsx("flex","h-full","flex-col","items-center","justify-center","text-center","text-slate-600"),children:e.jsxs("div",{className:clsx("rounded-3xl","bg-white","px-8","py-10","shadow-sm"),children:[e.jsx("h2",{className:clsx("text-xl","font-semibold","text-slate-900"),children:"Order not available"}),e.jsx("p",{className:clsx("mt-2","text-sm","text-slate-500"),children:L||"The requested order could not be found."}),e.jsxs("button",{type:"button",onClick:F,className:clsx("mt-6","inline-flex","items-center","gap-2","rounded-xl","bg-blue-600","px-4","py-2","text-sm","font-semibold","text-white","shadow-sm","hover:bg-blue-700"),children:[e.jsx(ve,{className:clsx("h-4","w-4")}),"Back to orders"]})]})}):e.jsxs(C.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:clsx("mx-auto","max-w-5xl","space-y-6"),children:[e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","justify-between","gap-3"),children:[e.jsxs("button",{type:"button",onClick:F,className:clsx("inline-flex","items-center","gap-2","text-sm","text-slate-500","transition","hover:text-slate-700"),children:[e.jsx(ve,{className:clsx("h-4","w-4")})," ",Ae]}),e.jsxs("button",{type:"button",onClick:De,disabled:P||!k,className:clsx("inline-flex","items-center","gap-2","rounded-xl","bg-blue-600","px-4","py-2","text-sm","font-semibold","text-white","shadow-sm","transition","hover:bg-blue-700","disabled:cursor-not-allowed","disabled:opacity-60"),title:k?void 0:"Invoice will be available once payment is successful or the invoice is generated.",children:[P?e.jsx(T,{className:clsx("h-4","w-4","animate-spin")}):e.jsx(Je,{className:clsx("h-4","w-4")}),k?"Download invoice":"Invoice locked"]})]}),e.jsxs(C.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","shadow-sm"),children:[e.jsxs("div",{className:clsx("flex","flex-col","gap-4","lg:flex-row","lg:items-start","lg:justify-between"),children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:clsx("text-sm","text-slate-500"),children:["Order #",s._id]}),e.jsx("h1",{className:clsx("text-2xl","font-semibold","text-slate-900"),children:((le=s.shippingAddress)==null?void 0:le.fullName)||"Customer"}),e.jsxs("div",{className:clsx("text-sm","text-slate-500"),children:["Placed on ",as(s.createdAt)]})]}),_e]}),e.jsxs("div",{className:clsx("mt-6","grid","gap-4","sm:grid-cols-2","lg:grid-cols-4"),children:[e.jsxs("div",{className:clsx("rounded-2xl","bg-slate-50","p-4"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-3","text-sm","text-slate-500"),children:[e.jsx(Ve,{className:clsx("h-5","w-5")})," Items"]}),e.jsx("p",{className:clsx("mt-2","text-xl","font-semibold","text-slate-900"),children:D.length||0})]}),e.jsxs("div",{className:clsx("rounded-2xl","bg-slate-50","p-4"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-3","text-sm","text-slate-500"),children:[e.jsx(Ke,{className:clsx("h-5","w-5")})," Payment"]}),e.jsx("p",{className:clsx("mt-2","text-xl","font-semibold","text-slate-900"),children:((re=(A=(ne=s.payment)==null?void 0:ne.method)==null?void 0:A.toUpperCase)==null?void 0:re.call(A))||"--"}),e.jsxs("p",{className:clsx("text-xs","text-slate-500"),children:["Status: ",((ce=s.payment)==null?void 0:ce.status)||"--"]})]}),e.jsxs("div",{className:clsx("rounded-2xl","bg-slate-50","p-4"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-3","text-sm","text-slate-500"),children:[e.jsx(Qe,{className:clsx("h-5","w-5")})," Delivery"]}),e.jsx("p",{className:clsx("mt-2","text-base","font-semibold","text-slate-900"),children:Le})]}),e.jsxs("div",{className:clsx("rounded-2xl","bg-slate-50","p-4"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-3","text-sm","text-slate-500"),children:[e.jsx(Xe,{className:clsx("h-5","w-5")})," Total"]}),e.jsx("p",{className:clsx("mt-2","text-xl","font-semibold","text-slate-900"),children:f(M)})]})]})]}),e.jsx("section",{className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","shadow-sm"),children:e.jsxs("div",{className:clsx("flex","flex-col","gap-4","sm:flex-row","sm:items-start","sm:justify-between"),children:[e.jsxs("div",{children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Tracking Updates"}),e.jsxs("p",{className:clsx("mt-2","text-sm","text-slate-600"),children:["Tracking ID:"," ",(ie=s==null?void 0:s.shipping)!=null&&ie.trackingId?q?e.jsx("a",{href:q,target:"_blank",rel:"noopener noreferrer",className:clsx("font-semibold","text-blue-600","underline-offset-4","hover:underline"),children:s.shipping.trackingId}):e.jsx("span",{className:clsx("font-semibold","text-slate-800"),children:s.shipping.trackingId}):"To be assigned"]}),e.jsxs("p",{className:clsx("mt-1","text-xs","text-slate-400"),children:["Courier: ",((oe=s==null?void 0:s.shipping)==null?void 0:oe.courier)||"Triupati"]})]}),q&&e.jsxs("button",{type:"button",onClick:()=>window.open(q,"_blank","noopener"),className:clsx("inline-flex","items-center","gap-2","self-start","rounded-xl","border","border-blue-200","px-4","py-2","text-sm","font-semibold","text-blue-600","transition","hover:border-blue-300","hover:bg-blue-50"),children:["Track My order",e.jsx(es,{size:16})]})]})}),e.jsxs("section",{className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","shadow-sm"),children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Order items"}),e.jsxs("div",{className:clsx("mt-4","divide-y","divide-slate-200"),children:[D.map((t,a)=>e.jsxs("div",{className:clsx("flex","flex-col","gap-4","py-4","sm:flex-row"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-4","sm:w-1/2"),children:[e.jsx("div",{className:clsx("h-16","w-16","overflow-hidden","rounded-xl","bg-slate-100"),children:t.image?e.jsx("img",{src:t.image,alt:t.name,className:clsx("h-full","w-full","object-cover")}):e.jsx("div",{className:clsx("flex","h-full","w-full","items-center","justify-center","text-xs","text-slate-400"),children:"No image"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:clsx("text-sm","font-semibold","text-slate-900"),children:t.name}),t.size&&e.jsxs("p",{className:clsx("text-xs","text-slate-500"),children:["Size: ",t.size]})]})]}),e.jsxs("div",{className:clsx("flex","flex-1","flex-wrap","items-center","gap-3","text-sm","text-slate-600"),children:[e.jsxs("span",{children:["Qty: ",t.quantity]}),e.jsxs("span",{children:["Price: ",f(t.price)]}),e.jsxs("span",{children:["Total: ",f(t.price*t.quantity)]}),t.ratedAt&&e.jsxs("span",{className:clsx("rounded-full","bg-emerald-100","px-3","py-1","text-xs","text-emerald-700"),children:["Rated ",t.rating??0,"/5"]})]})]},`${t.product||t.name}-${a}`)),D.length===0&&e.jsx("p",{className:clsx("py-8","text-center","text-sm","text-slate-500"),children:"No items available for this order."})]})]}),e.jsxs("section",{className:clsx("grid","gap-6","lg:grid-cols-2"),children:[e.jsxs(C.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","shadow-sm"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-3","text-sm","text-slate-500"),children:[e.jsx(We,{className:clsx("h-4","w-4")})," Shipping information"]}),e.jsxs("div",{className:clsx("mt-4","space-y-2","text-sm","text-slate-600"),children:[e.jsx("p",{className:clsx("text-sm","font-semibold","text-slate-900"),children:((de=s.shippingAddress)==null?void 0:de.fullName)||"--"}),e.jsx("p",{children:((xe=s.shippingAddress)==null?void 0:xe.addressLine)||"--"}),e.jsxs("p",{children:[((me=s.shippingAddress)==null?void 0:me.city)||"--",","," ",((pe=s.shippingAddress)==null?void 0:pe.state)||"--"," -"," ",((ue=s.shippingAddress)==null?void 0:ue.pincode)||"--"]}),e.jsxs("p",{children:["Mobile: ",((he=s.shippingAddress)==null?void 0:he.mobile)||"--"]}),((be=s.shippingAddress)==null?void 0:be.alternatePhone)&&e.jsxs("p",{children:["Alternate: ",s.shippingAddress.alternatePhone]}),e.jsxs("p",{children:["Email: ",((ge=s.shippingAddress)==null?void 0:ge.email)||"--"]})]})]}),e.jsxs(C.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","shadow-sm"),children:[e.jsxs("div",{className:clsx("mb-3","flex","items-center","justify-between","gap-3"),children:[e.jsx("h3",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Payment summary"}),Q&&e.jsxs("span",{className:clsx("inline-flex","items-center","rounded-full","bg-emerald-50","px-3","py-1","text-xs","font-semibold","uppercase","tracking-wide","text-emerald-600"),children:["Coupon: ",Q]})]}),e.jsxs("div",{className:clsx("mt-4","space-y-3","text-sm","text-slate-600"),children:[e.jsxs("div",{className:clsx("flex","items-center","justify-between"),children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:f(Ue)})]}),e.jsxs("div",{className:clsx("flex","items-center","justify-between"),children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:f(Pe)})]}),e.jsxs("div",{className:clsx("flex","items-center","justify-between"),children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:f(Oe)})]}),e.jsxs("div",{className:clsx("flex","items-center","justify-between","text-emerald-600"),children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-",f($e)]})]}),e.jsxs("div",{className:clsx("flex","items-center","justify-between","border-t","border-slate-200","pt-3","text-base","font-semibold","text-slate-900"),children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:f(M)})]})]})]})]}),s.replacementRequest&&s.replacementRequest.status&&s.replacementRequest.status!=="none"&&e.jsxs("section",{className:clsx("rounded-3xl","border","border-slate-200","bg-white","p-6","shadow-sm"),children:[e.jsxs("div",{className:clsx("mb-4","flex","flex-wrap","items-center","justify-between","gap-3"),children:[e.jsx("h3",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Return & Replace request"}),w?e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-2"),children:[e.jsxs("button",{type:"button",onClick:()=>B("approved"),className:clsx("inline-flex","items-center","gap-2","rounded-xl","border","border-emerald-200","bg-emerald-50","px-3","py-2","text-xs","font-semibold","text-emerald-700","hover:bg-emerald-100"),children:[e.jsx(we,{className:clsx("h-4","w-4")})," Approve request"]}),e.jsxs("button",{type:"button",onClick:()=>B("rejected"),className:clsx("inline-flex","items-center","gap-2","rounded-xl","border","border-rose-200","bg-rose-50","px-3","py-2","text-xs","font-semibold","text-rose-700","hover:bg-rose-100"),children:[e.jsx(Ye,{className:clsx("h-4","w-4")})," Reject request"]})]}):null]}),e.jsxs("div",{className:clsx("grid","gap-4","md:grid-cols-2"),children:[e.jsxs("div",{className:clsx("space-y-2","text-sm","text-slate-600"),children:[e.jsx("h4",{className:clsx("text-sm","font-semibold","text-primary"),children:"Item details"}),e.jsxs("p",{className:clsx("font-medium","text-slate-900"),children:[s.replacementRequest.itemName,s.replacementRequest.itemSize&&` â€¢ Size ${s.replacementRequest.itemSize}`]}),e.jsxs("p",{children:["Quantity: ",s.replacementRequest.quantity||1]}),s.replacementRequest.issueDescription&&e.jsx("p",{className:clsx("rounded-xl","border","border-primary/20","bg-white","p-3","text-sm","text-slate-700"),children:s.replacementRequest.issueDescription})]}),e.jsxs("div",{className:clsx("space-y-2","text-sm","text-slate-600"),children:[e.jsx("h4",{className:clsx("text-sm","font-semibold","text-primary"),children:"Replacement preferences"}),e.jsxs("p",{children:["Size:"," ",((fe=s.replacementRequest.replacementPreferences)==null?void 0:fe.size)||"--"]}),e.jsxs("p",{children:["Color:"," ",((je=s.replacementRequest.replacementPreferences)==null?void 0:je.color)||"--"]}),e.jsxs("p",{children:["Notes:"," ",((Ne=s.replacementRequest.replacementPreferences)==null?void 0:Ne.remarks)||"--"]}),s.replacementRequest.adminNotes&&e.jsxs("p",{className:clsx("rounded-xl","border","border-emerald-200","bg-emerald-50","p-3","text-sm","text-emerald-700"),children:["Seller notes: ",s.replacementRequest.adminNotes]})]})]}),w?e.jsxs("form",{className:clsx("mt-6","grid","gap-4","md:grid-cols-[1fr_1fr]"),onSubmit:Te,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:clsx("text-sm","font-medium","text-primary"),children:"Update status"}),e.jsx("select",{value:n.status,onChange:t=>R("status",t.target.value),className:clsx("w-full","rounded-xl","border","border-primary/30","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),required:!0,children:ts.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:clsx("text-sm","font-medium","text-primary"),children:"Courier (optional)"}),e.jsx("input",{value:n.courier,onChange:t=>R("courier",t.target.value),className:clsx("w-full","rounded-xl","border","border-primary/30","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),placeholder:"e.g. Delhivery"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:clsx("text-sm","font-medium","text-primary"),children:"Tracking ID (optional)"}),e.jsx("input",{value:n.trackingId,onChange:t=>R("trackingId",t.target.value),className:clsx("w-full","rounded-xl","border","border-primary/30","px-3","py-2","text-sm","focus:border-primary","focus:outline-none"),placeholder:"e.g. AWB123456"})]}),e.jsxs("div",{className:clsx("space-y-2","md:col-span-2"),children:[e.jsx("label",{className:clsx("text-sm","font-medium","text-primary"),children:"Notes for customer"}),e.jsx("textarea",{value:n.notes,onChange:t=>R("notes",t.target.value),rows:3,ref:v,required:h.has(n.status),className:`w-full rounded-xl border px-3 py-2 text-sm focus:border-primary focus:outline-none ${h.has(n.status)?"border-rose-200":"border-primary/30"}`,placeholder:h.has(n.status)?"Explain why you are rejecting this request.":"Share updates or next actions (optional)."}),h.has(n.status)?e.jsx("p",{className:clsx("text-xs","text-rose-500"),children:"A reason is required when rejecting."}):e.jsx("p",{className:clsx("text-xs","text-slate-500"),children:"Optional message shared with the customer."})]}),e.jsx("div",{className:clsx("flex","flex-wrap","items-center","justify-end","gap-3","md:col-span-2"),children:e.jsx("button",{type:"submit",disabled:$||h.has(n.status)&&!(n.notes&&n.notes.trim()),className:clsx("inline-flex","items-center","gap-2","rounded-xl","bg-primary","px-4","py-2","text-sm","font-semibold","text-white","shadow-sm","transition","hover:bg-primary-dark","disabled:cursor-not-allowed","disabled:opacity-60"),children:$?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:clsx("h-4","w-4","animate-spin")})," Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:clsx("h-4","w-4")})," Update request"]})})})]}):e.jsx("p",{className:clsx("mt-6","rounded-xl","border","border-slate-200","bg-slate-50","px-4","py-3","text-sm","text-slate-600"),children:"Replacement workflow is read-only in coordinator view."})]}),Array.isArray((ye=s.replacementRequest)==null?void 0:ye.history)&&s.replacementRequest.history.length>0&&e.jsxs("div",{className:clsx("mt-6","rounded-2xl","border","border-slate-200","bg-white","p-4"),children:[e.jsx("h3",{className:clsx("mb-3","text-sm","font-semibold","text-slate-800"),children:"Activity log"}),e.jsx("ul",{className:clsx("space-y-2","text-xs","text-slate-600"),children:s.replacementRequest.history.slice().reverse().map((t,a)=>e.jsxs("li",{className:clsx("rounded-xl","border","border-slate-100","bg-slate-50","px-3","py-2"),children:[e.jsxs("div",{className:clsx("flex","justify-between","gap-3"),children:[e.jsx("span",{className:clsx("font-semibold","capitalize"),children:t.status.replace(/_/g," ")}),e.jsx("span",{className:clsx("text-[11px]","text-slate-400"),children:t.at?new Date(t.at).toLocaleString("en-IN"):"--"})]}),t.note?e.jsx("p",{className:clsx("mt-1","text-[12px]","text-slate-600"),children:t.note}):null,t.actor?e.jsxs("p",{className:clsx("mt-1","text-[11px]","uppercase","tracking-wide","text-slate-400"),children:["Actor: ",t.actor]}):null]},`${t.at||a}-${t.status}`))})]})]})};export{fs as default};
