import{r as x,j as e,A as Ee,m as J}from"./vendor-2d1PFKo4.js";import{E as Ds}from"./exceljs.min-DtRa7M71.js";import{E as Is}from"./jspdf.es.min-BhhWDGe6.js";import{c as Me,i as Ps,k as As,u as Ls,I as _s,J as R,d as Fe,X as wt,b2 as Rs,_ as Os,aB as Ts}from"./index-Bpx0OnSg.js";import{S as St}from"./SubadminSidebar-qZjJQiuA.js";import{N as Us}from"./Navbar-K_t1OsQh.js";import{a as Es,b as Fs,c as Ms}from"./subadminApi-Cjp4NYtR.js";import{d as kt,Q as zs}from"./downloadQr-DEmKiViM.js";import{T as Bs}from"./tag-B5IXzVZU.js";import{S as $s}from"./shield-check-ZginSkgb.js";import{L as qs}from"./layers-C-GEjimE.js";import{T as Ct}from"./triangle-alert-C_xSVBCC.js";import{E as Dt}from"./eye-DjBlpBi-.js";import{F as It}from"./funnel-DrRYs2Xk.js";import{D as Pt}from"./download-D5r73ZfU.js";import{L as At}from"./loader-circle-DRAKHMK_.js";import{P as Qs}from"./pencil-line-CoX3LYzN.js";import"./react-BzrpNAyj.js";import"./arrow-left-fjWLrcm4.js";import"./log-out-BEyQjTNl.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Ws=Me("calendar-days",Hs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],Lt=Me("gift",Ks);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]],_t=Me("image-off",Vs),Xs=["","processing","confirmed","picked_up","shipped","out_for_delivery","delivered","returned","rejected"],Rt=[{key:"processing",label:"Processing",accent:"text-amber-600",badge:"bg-amber-100 text-amber-700"},{key:"confirmed",label:"Confirmed",accent:"text-blue-600",badge:"bg-blue-100 text-blue-700"},{key:"shipped",label:"Shipped",accent:"text-sky-600",badge:"bg-sky-100 text-sky-700"},{key:"out_for_delivery",label:"Out for Delivery",accent:"text-indigo-600",badge:"bg-indigo-100 text-indigo-700"},{key:"delivered",label:"Delivered",accent:"text-emerald-600",badge:"bg-emerald-100 text-emerald-700"},{key:"returned",label:"Return / Replace",accent:"text-rose-600",badge:"bg-rose-100 text-rose-700"}],Ys=[{value:"all",label:"All availability"},{value:"in_stock",label:"In stock"},{value:"low_stock",label:"Low stock"},{value:"out_of_stock",label:"Out of stock"}],Gs=[{value:"all",label:"All dates"},{value:"last_7_days",label:"Last 7 days"},{value:"last_30_days",label:"Last 30 days"},{value:"last_90_days",label:"Last 90 days"}],Js=[{value:"all",label:"All coupons"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"redeemed",label:"Redeemed"},{value:"not_redeemed",label:"Not redeemed"},{value:"expired",label:"Expired"}],Ot=I=>{if(!I)return"";const B=new Date(I);if(Number.isNaN(B.getTime()))return"";const xe=B.getTimezoneOffset()*60*1e3;return new Date(B.getTime()-xe).toISOString().slice(0,10)},re=I=>I&&(I.orderId||I.id||I._id)||"",Zs=[{value:"Triupati",label:"Triupati"},{value:"Xpressbees Logistics",label:"Xpressbees Logistics"},{value:"Delhivery Courier",label:"Delhivery Courier"},{value:"India Post",label:"India Post"}],jl=()=>{var gt,ft,bt;const{sellerId:I}=Ps(),B=As(),xe=Ls(),{user:ze,logout:Tt}=_s(),[Ut,me]=x.useState(!1),Et=(gt=B.state)==null?void 0:gt.initialTab,[Z,Be]=x.useState(()=>Et||"products"),ye=t=>{var s;Be(t),(s=B.state)!=null&&s.initialTab&&xe(B.pathname,{replace:!0,state:{...B.state,initialTab:t}})};x.useEffect(()=>{var t;(t=B.state)!=null&&t.initialTab&&Be(B.state.initialTab)},[(ft=B.state)==null?void 0:ft.initialTab]);const[ee,$e]=x.useState([]),[je,qe]=x.useState(!0),[Qe,He]=x.useState(""),[g,ue]=x.useState(null),[ve,Ft]=x.useState(""),[pe,Mt]=x.useState(""),[ne,zt]=x.useState("all"),[te,Bt]=x.useState("all"),[Y,We]=x.useState([]),[Ne,Ke]=x.useState(!0),[Ve,Xe]=x.useState(""),[he,$t]=x.useState(""),[we,qt]=x.useState(""),[Qt,ge]=x.useState(!1),[E,Se]=x.useState(null),[N,fe]=x.useState({status:"",paymentStatus:"",paymentMethod:"",estimatedDeliveryDate:"",rejectionPermanent:!1,courier:"Triupati",trackingId:""}),Ht=x.useMemo(()=>Ot(new Date),[]),[ie,Ye]=x.useState(!1),X=x.useRef(""),[Wt,Ge]=x.useState(null),[Je,Ze]=x.useState(null),[et,se]=x.useState([]),tt=x.useRef(null),[le,st]=x.useState([]),[ke,lt]=x.useState(!0),[at,rt]=x.useState(""),[Ce,Kt]=x.useState(""),[De,Vt]=x.useState("all"),G=x.useMemo(()=>{const t=Ce.trim().toLowerCase(),s=new Date;return le.filter(l=>{const a=l.isActive!==!1;Number(l.maxRedemptions);const i=(Number(l.usageCount)||0)>0,p=l.endDate?new Date(l.endDate):null,c=p&&!Number.isNaN(p.getTime())&&p<s;return(()=>{switch(De){case"active":return a&&!c;case"inactive":return!a;case"redeemed":return i;case"not_redeemed":return!i;case"expired":return c;default:return!0}})()?t?[l.code,l.description,l.discountType,l.discountValue].filter(Boolean).map(n=>String(n).toLowerCase()).some(n=>n.includes(t)):!0:!1})},[le,Ce,De]),H=x.useMemo(()=>{const t={total:G.length,active:0,singleUse:0,multiUse:0,expiredSingle:0,expiredMulti:0,redeemed:0,notRedeemed:0},s=new Date;return G.forEach(l=>{l.isActive!==!1&&(t.active+=1);const r=Number(l.maxRedemptions)||0,i=Number(l.usageCount)||0,p=r<=1;p?t.singleUse+=1:t.multiUse+=1;const c=l.endDate?new Date(l.endDate):null;c&&!Number.isNaN(c.getTime())&&c<s&&(p?t.expiredSingle+=1:t.expiredMulti+=1),i>0?t.redeemed+=1:t.notRedeemed+=1}),t},[G]),Xt=x.useMemo(()=>[{key:"total",label:"Total Coupons",value:H.total,icon:Bs,iconBg:"bg-blue-100 text-blue-600",helper:le.length!==H.total?`of ${le.length}`:null},{key:"active",label:"Active",value:H.active,icon:$s,iconBg:"bg-emerald-100 text-emerald-600"},{key:"single",label:"Single Use",value:H.singleUse,icon:qs,iconBg:"bg-purple-100 text-purple-600"},{key:"multi",label:"Multi Use",value:H.multiUse,icon:Ws,iconBg:"bg-amber-100 text-amber-600"},{key:"expiredSingle",label:"Expired Single Use",value:H.expiredSingle,icon:Ct,iconBg:"bg-slate-100 text-slate-500"},{key:"expiredMulti",label:"Expired Multi Use",value:H.expiredMulti,icon:Ct,iconBg:"bg-orange-100 text-orange-600"},{key:"redeemed",label:"Redeemed Coupons",value:H.redeemed,icon:Lt,iconBg:"bg-emerald-100 text-emerald-600"},{key:"notRedeemed",label:"Not Redeemed",value:H.notRedeemed,icon:Lt,iconBg:"bg-indigo-100 text-indigo-600"}],[H,le.length]),nt=x.useCallback(async()=>{try{qe(!0),He("");const t=await Es({sellerId:I});$e(Array.isArray(t)?t:[])}catch(t){console.error("Failed to load seller products for subadmin",t),He(t.message||"Unable to load seller products."),$e([])}finally{qe(!1)}},[I]),Ie=x.useCallback(async()=>{try{Ke(!0),Xe("");const t={sellerId:I};he&&(t.status=he);const s=await Fs(t);We(Array.isArray(s)?s:[])}catch(t){console.error("Failed to load seller orders for subadmin",t),Xe(t.message||"Unable to load seller orders."),We([])}finally{Ke(!1)}},[I,he]),it=x.useCallback(async()=>{try{lt(!0),rt("");const t=await Ms({sellerId:I});st(Array.isArray(t)?t:[])}catch(t){console.error("Failed to load seller coupons for subadmin",t),rt(t.message||"Unable to load seller coupons."),st([])}finally{lt(!1)}},[I]);x.useEffect(()=>{I&&(nt(),Ie(),it())},[I,nt,Ie,it]),x.useEffect(()=>{if(!Y.length){se(s=>s.length?[]:s);return}const t=new Set(Y.map(s=>String(re(s))).filter(Boolean));se(s=>{const l=s.filter(a=>t.has(String(a)));return l.length===s.length?s:l})},[Y]);const Yt=x.useMemo(()=>{const t=new Set;return ee.forEach(s=>{s!=null&&s.status&&t.add(s.status)}),["",...Array.from(t)]},[ee]),ot=x.useMemo(()=>[...ee].sort((t,s)=>{const l=t!=null&&t.createdAt?new Date(t.createdAt).getTime():0;return(s!=null&&s.createdAt?new Date(s.createdAt).getTime():0)-l}),[ee]),Pe=x.useMemo(()=>{const t=ve.trim().toLowerCase();return ot.filter(s=>{if(!s)return!1;const l=t?[s.name,s.sku,s.brand].filter(Boolean).map(n=>String(n).toLowerCase()).some(n=>n.includes(t)):!0,a=pe?String(s.status||"").toLowerCase()===pe.toLowerCase():!0,r=Number(s.stock),i=Number.isFinite(r),p=Number(s.lowStockThreshold),c=Number.isFinite(p)&&p>0?p:5;let h=!0;ne==="in_stock"?h=i?r>c:!0:ne==="low_stock"?h=i?r>0&&r<=c:!1:ne==="out_of_stock"&&(h=i?r<=0:!1);let u=!0;if(te!=="all")if(!(s!=null&&s.createdAt))u=!1;else{const n=new Date(s.createdAt);if(Number.isNaN(n.getTime()))u=!1;else{const f=(Date.now()-n.getTime())/(1e3*60*60*24);te==="last_7_days"?u=f<=7:te==="last_30_days"?u=f<=30:te==="last_90_days"&&(u=f<=90)}}return l&&a&&h&&u})},[ot,ve,pe,ne,te]),Gt=t=>{var a,r,i,p,c;if(!t)return 0;const l=[t.totalAmount,(a=t.orderPricing)==null?void 0:a.total,(r=t.pricing)==null?void 0:r.total,(i=t.totals)==null?void 0:i.grandTotal,(p=t.totals)==null?void 0:p.net,(c=t.orderPricing)==null?void 0:c.grandTotal,t.total].find(h=>{const u=Number(h);return Number.isFinite(u)&&u>0});return Number(l??0)},Jt=t=>{var s,l,a,r;return t&&(t.customerName||((s=t.buyer)==null?void 0:s.name)||((l=t.shippingAddress)==null?void 0:l.fullName)||((a=t.shippingAddress)==null?void 0:a.firstName)||((r=t.shipping)==null?void 0:r.recipientName))||"Customer"},Zt=t=>{var s,l,a,r;return t&&(t.buyerPhone||t.customerPhone||((s=t.shippingAddress)==null?void 0:s.mobile)||((l=t.shipping)==null?void 0:l.mobile)||((a=t.buyer)==null?void 0:a.phone)||((r=t.buyer)==null?void 0:r.mobile))||"--"},es=t=>{var l;if(!t)return"--";const s=t.shippingAddress||t.shipping||{};return t.buyerEmail||t.customerEmail||s.email||((l=t.buyer)==null?void 0:l.email)||"--"},w=x.useMemo(()=>{const t=we.trim().toLowerCase();return[...Y].sort((l,a)=>{const r=l!=null&&l.createdAt?new Date(l.createdAt).getTime():0;return(a!=null&&a.createdAt?new Date(a.createdAt).getTime():0)-r}).filter(l=>{var r,i,p,c,h,u;return t?[l.orderId,l._id,(r=l.buyer)==null?void 0:r.name,(i=l.shippingAddress)==null?void 0:i.fullName,(p=l.shipping)==null?void 0:p.trackingId,l.buyerEmail,l.customerEmail,(c=l.shippingAddress)==null?void 0:c.email,(h=l.shipping)==null?void 0:h.email,(u=l.buyer)==null?void 0:u.email].filter(Boolean).map(n=>String(n).toLowerCase()).some(n=>n.includes(t)):!0})},[Y,we]),V=x.useMemo(()=>new Set(et.map(t=>String(t))),[et]),be=x.useMemo(()=>{if(!w.length||V.size===0)return 0;let t=0;return w.forEach(s=>{const l=String(re(s));l&&V.has(l)&&(t+=1)}),t},[w,V]);x.useEffect(()=>{const t=tt.current;if(t){if(!w.length){t.indeterminate=!1;return}t.indeterminate=be>0&&be<w.length}},[w,be]);const ts=x.useCallback(()=>{if(!w.length){se([]);return}const t=w.map(a=>String(re(a))).filter(Boolean);if(t.some(a=>!V.has(a))){se(a=>{const r=new Set(a.map(i=>String(i)));return t.forEach(i=>r.add(i)),Array.from(r)});return}const l=new Set(t);se(a=>a.filter(r=>!l.has(String(r))))},[w,V]),ss=x.useCallback(t=>{const s=String(t||"");s&&se(l=>l.includes(s)?l.filter(a=>a!==s):[...l,s])},[]),ae=x.useCallback(()=>{if(!Array.isArray(w)||!w.length)return[];const t=V.size>0?w.filter(l=>{const a=String(re(l));return a&&V.has(a)}):w;if(!t.length)return[];const s=l=>{var r,i;const a=typeof l=="string"?l.trim():"";if(!a)return"";if(/^https?:\/\//i.test(a))return a;if(a.startsWith("//"))return typeof window<"u"&&((r=window.location)!=null&&r.protocol)?`${window.location.protocol}${a}`:`https:${a}`;try{const p=typeof window<"u"&&((i=window.location)!=null&&i.origin)?window.location.origin:void 0;return p?new URL(a,p).href:a}catch{return a}};return t.map(l=>{var f,b,P,O,C;const a=Array.isArray(l.items)?l.items:[],r=a[0]||{},i=l.shippingAddress||l.shipping||{},p=l.qrfolio||{},c=()=>{if(p.imageKey)return p.imageKey;const U=p.imageUrl||"";if(!U)return"";try{const $=new URL(U,window.location.origin).pathname||"",W=($.endsWith("/")?$.slice(0,-1):$).split("/").filter(Boolean);return W.length?W[W.length-1]:""}catch{const $=U.split("?")[0],M=$.split("/").filter(Boolean);return M.length?M[M.length-1]:$}},h=typeof p.imageUrl=="string"?p.imageUrl.trim():"",u=l.invoice||{},n=s(u.url||l.invoiceUrl||""),m={};return m["Order ID"]=l.orderId||l.id||l._id,m.Status=l.orderStatus||l.status||"processing",m["Payment Status"]=l.paymentStatus||((f=l.payment)==null?void 0:f.status)||"pending",m["Payment Method"]=l.paymentMethod||((b=l.payment)==null?void 0:b.method)||"",m["Total Amount"]=l.total??l.totalAmount??((P=l.pricing)==null?void 0:P.total)??0,m["Item Count"]=a.length,m["Primary Item"]=r.name||r.productName||"",m["Primary SKU"]=r.sku||"",m["Primary Size"]=r.size||r.selectedSize||((O=r.options)==null?void 0:O.size)||"",m["Buyer Name"]=l.buyerName||l.customerName||i.fullName||"",m["Buyer Email"]=l.buyerEmail||l.customerEmail||i.email||"",m["Buyer Phone"]=l.buyerPhone||i.mobile||"",m["Created At"]=l.createdAt?new Date(l.createdAt).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",m["Estimated Delivery"]=l.estimatedDeliveryDate?new Date(l.estimatedDeliveryDate).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",m["Shipping Address"]=pt(i),m["QR Folio Image"]=h||c(),m["Invoice Number"]=u.number||l.invoiceNumber||"",m["Invoice Date"]=u.generatedAt?new Date(u.generatedAt).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):l.invoiceDate?new Date(l.invoiceDate).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",m.Invoice=n,Object.defineProperty(m,"__qrfolioLink",{value:h,enumerable:!1}),Object.defineProperty(m,"__invoiceLink",{value:n,enumerable:!1}),Object.defineProperty(m,"__shippingAddress",{value:i,enumerable:!1}),Object.defineProperty(m,"__itemCount",{value:a.length,enumerable:!1}),Object.defineProperty(m,"__primaryItem",{value:r,enumerable:!1}),Object.defineProperty(m,"__qrPdfLink",{value:((C=l.qrfolio)==null?void 0:C.pdfUrl)||"",enumerable:!1}),m})},[w,V]),ls=x.useCallback(()=>{const t=ae();if(!t.length){R.error("No orders to export");return}const s=Object.keys(t[0]),l=[s.join(","),...t.map(p=>s.map(c=>`"${String(p[c]??"").replace(/"/g,'""')}"`).join(","))].join(`
`),a=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=`seller-orders-${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r),R.success("CSV exported")},[ae]),as=x.useCallback(async()=>{const t=ae();if(!t.length){R.error("No orders to export");return}const s=Object.keys(t[0]),l=s.indexOf("QR Folio Image"),a=s.indexOf("Invoice"),r=new Ds.Workbook,i=r.addWorksheet("Orders");i.addRow(s),l!==-1&&(i.getColumn(l+1).width=16),a!==-1&&(i.getColumn(a+1).width=24);const p=u=>{var m;if(!u||typeof u!="string")return null;const n=u.trim();if(!n)return null;try{return new URL(n).toString()}catch{try{const b=((m=window.location)==null?void 0:m.origin)||"";return b?new URL(n.replace(/^\/+/,""),b).toString():n}catch{return n}}},c=new Map,h=async u=>{const n=p(u);if(!n)return null;if(c.has(n))return c.get(n);try{const m=await fetch(n,{credentials:"include"});if(!m.ok)throw new Error(`Unexpected status ${m.status}`);const f=await m.blob();if(!f.type||!f.type.startsWith("image/"))return c.set(n,null),null;const b=await new Promise((C,U)=>{const F=new FileReader;F.onloadend=()=>C(F.result),F.onerror=U,F.readAsDataURL(f)}),P=f.type.includes("png")?"png":f.type.includes("jpeg")||f.type.includes("jpg")?"jpeg":f.type.includes("webp")?"webp":"png",O={dataUrl:b,extension:P};return c.set(n,O),O}catch(m){return console.error("Failed to load QR image for XLSX export",n,m),c.set(n,null),null}};for(let u=0;u<t.length;u+=1){const n=t[u],m=u+2,f=n.__qrfolioLink||n["QR Folio Image"],b=l!==-1&&f?await h(f):null,P=s.map(C=>C==="QR Folio Image"?b?"":n[C]||"":n[C]),O=i.addRow(P);if(b&&b.dataUrl&&l!==-1){const C=typeof b.dataUrl=="string"&&b.dataUrl.split(",")[1]||b.dataUrl,U=r.addImage({base64:C,extension:b.extension||"png"});O.height=70,i.addImage(U,{tl:{col:l,row:m-1},ext:{width:72,height:72}})}if(a!==-1){const C=n.__invoiceLink;if(C){const U=O.getCell(a+1),F=n.Invoice||C;U.value={text:F,hyperlink:C}}}}try{const u=await r.xlsx.writeBuffer(),n=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=window.URL.createObjectURL(n),f=document.createElement("a");f.href=m,f.download=`seller-orders-${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(m),R.success("XLSX exported")}catch(u){console.error("Failed to export XLSX with QR images",u),R.error("Failed to export XLSX. Please try again.")}},[ae]),rs=x.useCallback(async()=>{var jt;const t=ae();if(!t.length){R.error("No orders to export");return}const s=new Is({orientation:"landscape",unit:"pt",format:"a4"}),l=[{key:"orderId",label:"Order ID",width:60},{key:"status",label:"Status",width:40},{key:"payment",label:"Payment",width:62},{key:"total",label:"Total (INR)",width:60,align:"right"},{key:"item",label:"Primary Item",width:100},{key:"size",label:"Size",width:34,align:"center"},{key:"buyer",label:"Buyer",width:74},{key:"qty",label:"Qty",width:28,align:"center"},{key:"ship",label:"Ship To",width:96},{key:"qr",label:"QR Code",width:66,type:"image",imageWidth:52,imageHeight:52},{key:"qrPdf",label:"QR PDF",width:62,align:"center"},{key:"invoice",label:"Invoice",width:80,type:"image",imageWidth:68,imageHeight:52}],a=32,r=72,i=48,p=26,c=l.reduce((d,o)=>d+o.width,0),h=9,u=12;let n=r,m=s.internal.pageSize.getWidth(),f=s.internal.pageSize.getHeight();const b=()=>{m=s.internal.pageSize.getWidth(),f=s.internal.pageSize.getHeight()},P=d=>d==null?"--":(Array.isArray(d)?d.join(" "):String(d)).replace(/\u00a0/g," ").trim()||"--",O=d=>{var y;if(!d||typeof d!="string")return null;const o=d.trim();if(!o||o==="--")return null;try{return new URL(o).toString()}catch{try{const j=((y=window.location)==null?void 0:y.origin)||"";return j?new URL(o.replace(/^\/+/,""),j).toString():o}catch{return o}}},C=d=>{if(!d||typeof d!="string")return"";const y=d.split("?")[0].split("#")[0].split("/").filter(Boolean);if(!y.length)return"";const S=y[y.length-1],j=S.lastIndexOf(".");return j===-1||j===S.length-1?"":S.slice(j+1).toLowerCase()},U=d=>{var o;if(!d||typeof d!="string")return"";try{const y=new URL(d,((o=window.location)==null?void 0:o.origin)||void 0);return C(y.pathname||"")}catch{return C(d)}},F=d=>{const o=U(d);return o?["png","jpg","jpeg","gif","bmp","webp","svg"].includes(o):!1},$=(d,o)=>{if(!d)return"Invoice unavailable";if(o)return"Invoice image unavailable";const y=U(d);return y?y==="pdf"?"Invoice ":`Invoice ${y.toUpperCase()}`:"Invoice file"},M=new Map,W=async d=>{const o=O(d);if(!o)return null;if(M.has(o))return M.get(o);try{const y=await fetch(o,{credentials:"include"});if(!y.ok)throw new Error(`Unexpected status ${y.status}`);const S=await y.blob();if(!S.type||!S.type.startsWith("image/"))return M.set(o,null),null;const j=await new Promise((D,q)=>{const A=new FileReader;A.onloadend=()=>D(A.result),A.onerror=q,A.readAsDataURL(S)}),v=S.type.includes("png")?"PNG":S.type.includes("jpeg")||S.type.includes("jpg")?"JPEG":S.type.includes("webp")?"WEBP":void 0,K={dataUrl:j,format:v};return M.set(o,K),K}catch(y){return console.error("Failed to load image for PDF export",o,y),M.set(o,null),null}},fs=d=>{const o=Number.isFinite(Number(d))?Number(d):0;return`INR ${new Intl.NumberFormat("en-IN",{minimumFractionDigits:0,maximumFractionDigits:0}).format(o)}`},bs=d=>d&&typeof d=="object"&&!Array.isArray(d)?{text:d.text!==void 0?d.text:"--",link:O(d.link||d.url)}:{text:d,link:null},ys=()=>{s.setFont("Helvetica","bold"),s.setFontSize(10),s.setTextColor(255,255,255),s.setFillColor(15,23,42),s.setDrawColor(15,23,42);let d=a;l.forEach(o=>{s.setFillColor(15,23,42),s.setTextColor(255,255,255),s.rect(d,n,o.width,p,"FD");const y=n+p/2+1;s.text(o.label,d+o.width/2,y,{align:"center",baseline:"middle"}),d+=o.width}),n+=p,s.setDrawColor(221,226,233),s.setFont("Helvetica","normal"),s.setFontSize(h),s.setTextColor(30,41,59)},yt=d=>{b();const o=d?"Seller Orders":"Seller Orders (cont.)",y=d?32:24;s.setFont("Helvetica","bold"),s.setFontSize(d?16:12),s.setTextColor(30,41,59),s.text(o,m/2,r-y,{align:"center"}),n=r,ys()},js=(d,o)=>{const y=l.map(v=>{if(v.type==="image"){const _=d[v.key]||{},k=!!(_.image&&_.image.dataUrl),T=typeof _.url=="string"&&_.url.trim()?_.url.trim():null,L=k?[]:s.splitTextToSize(P(_.fallback||"Image unavailable"),v.width-12),Q=v.imageHeight||52,z=Math.max(k?Q+16:(L.length||1)*u+16,26);return{type:"image",hasImage:k,image:_.image||null,url:T,fallbackLines:L,requiredHeight:z,imageWidth:v.imageWidth||52,imageHeight:Q}}const{text:K,link:D}=bs(d[v.key]),q=P(typeof K=="string"?K.replace(/\r?\n/g,`
`):K),A=s.splitTextToSize(q||"--",v.width-12);return{type:"text",lines:A.length?A:["--"],link:D,requiredHeight:Math.max(A.length*u+16,26)}}),S=Math.max(...y.map(v=>v.requiredHeight||26));n+S>f-i&&(s.addPage({orientation:"landscape",unit:"pt",format:"a4"}),yt(!1)),o%2===0&&(s.setFillColor(248,250,252),s.setDrawColor(248,250,252),s.rect(a,n,c,S,"F")),s.setDrawColor(221,226,233),s.setFont("Helvetica","normal"),s.setFontSize(h),s.setTextColor(30,41,59);let j=a;l.forEach((v,K)=>{var _;const D=y[K];if(s.rect(j,n,v.width,S),v.type==="image"){if(D.hasImage&&((_=D.image)!=null&&_.dataUrl)){const k=Math.min(D.imageWidth,v.width-8),T=D.imageHeight,L=j+(v.width-k)/2,Q=n+(S-T)/2;try{s.addImage(D.image.dataUrl,D.image.format||"PNG",L,Q,k,T),D.url&&s.link(L,Q,k,T,{url:D.url})}catch(z){console.error("Failed to add image to PDF",z)}}else D.fallbackLines.length&&D.fallbackLines.forEach((k,T)=>{const L=n+12+T*u;D.url&&T===0?(s.setTextColor(37,99,235),s.textWithLink(k,j+6,L,{url:D.url}),s.setTextColor(30,41,59)):s.text(k,j+6,L,{baseline:"top"})});j+=v.width;return}const{lines:q,link:A}=D;q.forEach((k,T)=>{const L=n+12+T*u,Q=v.align||"left",z={baseline:"top"};Q==="center"?(z.align="center",A&&q.length===1&&T===0?(s.setTextColor(37,99,235),s.textWithLink(k,j+v.width/2,L,{align:"center",url:A}),s.setTextColor(30,41,59)):s.text(k,j+v.width/2,L,z)):Q==="right"?(z.align="right",A&&q.length===1&&T===0?(s.setTextColor(37,99,235),s.textWithLink(k,j+v.width-6,L,{align:"right",url:A}),s.setTextColor(30,41,59)):s.text(k,j+v.width-6,L,z)):A&&q.length===1&&T===0?(s.setTextColor(37,99,235),s.textWithLink(k,j+6,L,{url:A}),s.setTextColor(30,41,59)):s.text(k,j+6,L,z)}),j+=v.width}),n+=S};yt(!0);for(let d=0;d<t.length;d+=1){const o=t[d],y=o["Payment Status"]||"",S=o["Payment Method"]||"",j=`${y||""}`,v=S?`${j}${j?" ":""}(${S})`:j,K=[o["Buyer Name"],o["Buyer Email"],o["Buyer Phone"]].filter(Boolean).join(" • "),D=pt(o.__shippingAddress).split(`
`).map(Ue=>Ue.trim()).filter(Boolean).join(`
`),q=o.__qrfolioLink||o["QR Folio Image"],A=o.__invoiceLink||o.Invoice,_=O(q),k=O(A),T=k||A,L=F(T),Q=o.__qrPdfLink,[z,vt,Nt]=await Promise.all([W(q),L?W(A):Promise.resolve(null),Q?Promise.resolve(Q):_?kt({qrUrl:_,orderId:o.orderId,filePrefix:"order-qr",returnDataUri:!0}).catch(Ue=>(console.error("Failed to build QR PDF for export",Ue),null)):Promise.resolve(null)]),vs=P(v),de=o.__primaryItem||{},Ns=o["Primary Item"]||de.productName||de.name||"--",ws=o["Primary SKU"]?` (SKU: ${o["Primary SKU"]})`:"",Ss=o["Primary Size"]||de.size||de.selectedSize||((jt=de.options)==null?void 0:jt.size)||"",ks=Number.isFinite(Number(o.__itemCount))?Number(o.__itemCount):Number(o["Item Count"]||0),Cs={orderId:P(o["Order ID"]),status:P(o.Status),payment:vs,total:fs(o["Total Amount"]),item:P(`${Ns}${ws}`),size:P(Ss||"--"),buyer:P(K),qty:P(ks),ship:D?P(D):"--",qr:z?{image:z,url:_}:{fallback:"QR image unavailable",url:_},qrPdf:Nt?{text:"Download",link:Nt}:_?{text:"Open QR",link:_}:"--",invoice:vt?{image:vt,url:k}:{fallback:$(T,L),url:k}};js(Cs,d)}s.save(`seller-orders-${new Date().toISOString().slice(0,10)}.pdf`),R.success("PDF exported")},[ae]),ns=x.useMemo(()=>{const t=Rt.reduce((s,l)=>(s[l.key]=0,s),{});return w.forEach(s=>{const l=String(s.orderStatus||s.status||"").toLowerCase().trim();l&&t[l]!==void 0&&(t[l]+=1)}),Rt.map(s=>({...s,value:t[s.key]??0}))},[w]),is=async t=>{var l,a,r,i,p;const s=re(t);if(!s){R.error("Order reference unavailable");return}try{const c=await Os(s),h=c==null?void 0:c.data;if(!h)throw new Error("Order details not found");const u=h.shipping&&h.shipping.courier||"Triupati",n={status:h.status||"processing",paymentStatus:((l=h.payment)==null?void 0:l.status)||"",paymentMethod:((a=h.payment)==null?void 0:a.method)||"",estimatedDeliveryDate:Ot(h.estimatedDeliveryDate)||"",rejectionPermanent:!!h.rejectionPermanent,courier:u,trackingId:((r=h.shipping)==null?void 0:r.trackingId)||""};Se(h),fe(n);const m=String(n.status||"").toLowerCase()==="delivered"?"":n.estimatedDeliveryDate;X.current=m||""}catch(c){const h=((p=(i=c==null?void 0:c.response)==null?void 0:i.data)==null?void 0:p.message)||(c==null?void 0:c.message)||"Failed to load order for editing";R.error(h)}},Ae=()=>{ie||Se(null)},oe=(t,s)=>{fe(l=>({...l,[t]:s}))},os=t=>{const s=t.target.value;fe(l=>{const a=String(l.status||"").toLowerCase(),r=String(s||"").toLowerCase(),i=r==="delivered",p=a==="delivered";let c=l.estimatedDeliveryDate;return i&&!p?(!l.estimatedDeliveryDate&&X.current||(X.current=l.estimatedDeliveryDate||X.current||""),c=Ht):!i&&p&&(c=X.current||""),i||(X.current=c||X.current||""),{...l,status:s,estimatedDeliveryDate:c,rejectionPermanent:r==="rejected"?l.rejectionPermanent:!1}})},ct=(((bt=E==null?void 0:E.payment)==null?void 0:bt.status)||"").toString().toLowerCase(),dt=(N.paymentStatus||"").toString().toLowerCase(),cs=dt||ct,xt=(N.status||"").toString().toLowerCase(),Le=E?["delivered","returned"].includes((E.status||"").toString().toLowerCase()):!1,mt=ct==="paid"||dt==="paid",_e=["paid","success","successful","completed"].includes(cs),Re=xt==="delivered",ds=!Re||_e,ut=xt==="rejected"&&!!N.rejectionPermanent,xs=t=>{const{value:s}=t.target;if(Le){R.error("Estimated delivery date cannot be changed after delivery.");return}fe(l=>(String(l.status||"").toLowerCase()==="delivered"||(X.current=s),{...l,estimatedDeliveryDate:s}))},ms=async t=>{var s,l;if(t.preventDefault(),!!E){if(Re&&!_e){R.error("Payment must be successful before marking an order as delivered.");return}Ye(!0);try{const a={status:N.status||void 0,paymentStatus:N.paymentStatus||void 0,paymentMethod:N.paymentMethod||void 0,estimatedDeliveryDate:N.estimatedDeliveryDate||null};N.courier&&(a.courier=N.courier),N.trackingId&&(a.trackingId=N.trackingId),(N.status||"").toString().toLowerCase()==="rejected"?a.rejectionPermanent=!!N.rejectionPermanent:E!=null&&E.rejectionPermanent&&String(E.status||"").toLowerCase()==="rejected"&&(a.rejectionPermanent=!1);const i=E.orderId||E._id;await Ts(i,a),R.success("Order updated successfully"),await Ie(),Se(null)}catch(a){const r=(a==null?void 0:a.message)||((l=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to update order";R.error(r)}finally{Ye(!1)}}},us=async t=>{var l;const s=t.orderId||t.id||t._id;if(s)try{const a=String(s);Ge(a);const r=await Rs(s),i=r.data,c=(((l=r.headers)==null?void 0:l["content-disposition"])||"").match(/filename="?([^";]+)"?/i),h=(c==null?void 0:c[1])||`invoice-${a}.pdf`,u=window.URL.createObjectURL(i),n=document.createElement("a");n.href=u,n.download=h,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(u)}catch(a){console.error("Failed to download invoice",a),window.alert(a.message||"Failed to download invoice.")}finally{Ge(null)}},{name:ps,username:hs}=ze||{},Oe=t=>t?t.thumbnail?t.thumbnail:Array.isArray(t.images)&&t.images.length?t.images.find(s=>!!s)||"":Array.isArray(t.gallery)&&t.gallery.length&&t.gallery.find(s=>!!s)||"":"",gs=(t,s)=>{if(!t)return[];const l=[...Array.isArray(t.images)?t.images:[],...Array.isArray(t.gallery)?t.gallery:[]].filter(Boolean),a=new Set,r=[];return l.forEach(i=>{s&&i===s||a.has(i)||(a.add(i),r.push(i))}),r},ce=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(Number(t)||0),pt=(t={})=>{if(!t||typeof t!="object")return"--";const s=[t.fullName,t.mobile].filter(Boolean).join(" • "),l=t.email?`Email: ${t.email}`:"",a=[t.addressLine,t.landmark].filter(Boolean).join(", "),r=[t.city,t.district].filter(Boolean).join(", "),i=[t.state,t.pincode].filter(Boolean).join(" - ");return[s,l,a,r,i].filter(c=>c&&c.trim().length).join(`
`)||"--"},Te=Oe(g),ht=gs(g,Te);return e.jsxs("div",{className:clsx("min-h-screen","md:h-screen","bg-slate-50","text-slate-900","overflow-x-hidden"),children:[e.jsxs("div",{className:clsx("flex","md:h-screen"),children:[e.jsx(St,{active:"Dashboard",className:clsx("hidden","lg:flex","lg:w-64","lg:flex-none"),onNavigate:()=>me(!1)}),e.jsx(Ee,{children:Ut&&e.jsxs(J.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:clsx("fixed","inset-0","z-40","flex","lg:hidden"),children:[e.jsx(J.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:220,damping:24},className:clsx("bg-white","w-72","max-w-sm","h-full","shadow-xl"),children:e.jsx(St,{active:"Dashboard",className:clsx("flex","w-full"),onNavigate:()=>me(!1)})}),e.jsx("button",{type:"button",onClick:()=>me(!1),className:clsx("flex-1","bg-black/30"),"aria-label":"Close sidebar"})]})}),e.jsxs("div",{className:clsx("flex-1","flex","flex-col","overflow-hidden"),children:[e.jsx(Us,{onToggleSidebar:()=>me(t=>!t),activeRange:"All Time",onSelectRange:()=>{},adminName:ps||hs||"Subadmin",adminRole:"Sub Admin",notifications:{pendingOrders:0,shippedOrders:0,deliveredOrders:0},showRangeSelector:!1,showNotifications:!1,onLogout:Tt}),e.jsxs("main",{className:clsx("flex-1","overflow-y-auto","px-4","py-6","md:px-8","space-y-6"),children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:clsx("text-sm","text-slate-500"),children:"Subadmin / Sellers / Details"}),e.jsx("h1",{className:clsx("text-2xl","font-semibold","text-slate-900"),children:"Seller Details"}),e.jsxs("p",{className:clsx("text-xs","text-slate-500"),children:["Seller ID: ",e.jsx("span",{className:"font-mono",children:I})]})]}),e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-3"),children:[e.jsx("button",{type:"button",onClick:()=>ye("products"),className:`rounded-full px-4 py-1.5 text-sm font-medium border transition-colors ${Z==="products"?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-700 hover:border-slate-300"}`,children:"Products"}),e.jsx("button",{type:"button",onClick:()=>ye("orders"),className:`rounded-full px-4 py-1.5 text-sm font-medium border transition-colors ${Z==="orders"?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-700 hover:border-slate-300"}`,children:"Orders"}),e.jsx("button",{type:"button",onClick:()=>ye("coupons"),className:`rounded-full px-4 py-1.5 text-sm font-medium border transition-colors ${Z==="coupons"?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-700 hover:border-slate-300"}`,children:"Coupons"})]}),Z==="products"&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("header",{className:clsx("flex","flex-col","gap-3","md:flex-row","md:items-center","md:justify-between"),children:[e.jsxs("div",{className:clsx("flex","flex-col","gap-1"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-3"),children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Products"}),je&&e.jsx("p",{className:clsx("text-xs","text-slate-500"),children:"Loading products..."})]}),e.jsx("p",{className:clsx("text-xs","text-slate-500"),children:je?"Fetching latest products...":`Showing ${Pe.length} of ${ee.length} items`})]}),e.jsxs("div",{className:clsx("flex","w-full","flex-col","gap-2","md:w-auto","md:flex-row","md:items-center","md:justify-end"),children:[e.jsxs("div",{className:clsx("relative","w-full","md:w-64"),children:[e.jsx(Fe,{className:clsx("pointer-events-none","absolute","left-3","top-1/2","h-4","w-4","-translate-y-1/2","text-slate-400")}),e.jsx("input",{type:"text",value:ve,onChange:t=>Ft(t.target.value),placeholder:"Search name, SKU or brand",className:clsx("w-full","rounded-full","border","border-slate-200","bg-white","py-1.5","pl-8","pr-3","text-xs","text-slate-700","placeholder:text-slate-400","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100")})]}),e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-2","md:justify-end"),children:[e.jsx("select",{value:pe,onChange:t=>Mt(t.target.value),className:clsx("rounded-lg","border","border-slate-200","bg-white","px-3","py-1.5","text-xs","text-slate-700","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100"),children:Yt.map(t=>e.jsx("option",{value:t,children:t?t.replace(/_/g," "):"All statuses"},t||"all"))}),e.jsx("select",{value:ne,onChange:t=>zt(t.target.value),className:clsx("rounded-lg","border","border-slate-200","bg-white","px-3","py-1.5","text-xs","text-slate-700","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100"),children:Ys.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("select",{value:te,onChange:t=>Bt(t.target.value),className:clsx("rounded-lg","border","border-slate-200","bg-white","px-3","py-1.5","text-xs","text-slate-700","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100"),children:Gs.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]})]}),Qe&&e.jsx("div",{className:clsx("rounded-xl","border","border-rose-200","bg-rose-50","px-4","py-3","text-sm","text-rose-600"),children:Qe}),e.jsx("div",{className:clsx("overflow-x-auto","rounded-2xl","border","border-slate-200","bg-white"),children:e.jsxs("table",{className:clsx("min-w-full","divide-y","divide-slate-200","text-sm"),children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600","w-16"),children:"S/N"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Image"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Name"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"SKU"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Price"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Status"}),e.jsx("th",{className:clsx("px-3","py-2","text-center","font-semibold","text-slate-600"),children:"View"})]})}),e.jsx("tbody",{className:clsx("divide-y","divide-slate-100","bg-white"),children:je?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:clsx("px-3","py-6","text-center","text-slate-500"),children:"Loading products..."})}):ee.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:clsx("px-3","py-6","text-center","text-slate-500"),children:"No products found for this seller."})}):Pe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:clsx("px-3","py-6","text-center","text-slate-500"),children:"No products match the current filters."})}):Pe.map((t,s)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-xs","font-semibold","text-slate-500"),children:s+1}),e.jsx("td",{className:clsx("px-3","py-2","align-middle"),children:Oe(t)?e.jsx("img",{src:Oe(t),alt:t.name||t.sku||"Product",className:clsx("h-12","w-12","rounded-lg","border","border-slate-200","object-cover")}):e.jsx("div",{className:clsx("flex","h-12","w-12","items-center","justify-center","rounded-lg","border","border-dashed","border-slate-200","bg-slate-50","text-slate-400"),children:e.jsx(_t,{size:16})})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-800"),children:t.name||"--"}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-600"),children:t.sku||"--"}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-600"),children:ce(t.price)}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-600"),children:t.status||"--"}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-center"),children:e.jsx("button",{type:"button",onClick:()=>ue(t),className:clsx("inline-flex","h-8","w-8","items-center","justify-center","rounded-full","border","border-slate-200","text-slate-600","transition","hover:border-blue-200","hover:text-blue-600"),"aria-label":"View product details",children:e.jsx(Dt,{size:16})})})]},t._id))})]})})]}),Z==="orders"&&e.jsxs("section",{className:"space-y-4",children:[!Ne&&Y.length>0&&e.jsx("div",{className:clsx("grid","gap-3","sm:grid-cols-2","xl:grid-cols-3"),children:ns.map(({key:t,label:s,value:l,accent:a,badge:r})=>e.jsxs("div",{className:clsx("rounded-2xl","border","border-slate-200","bg-white","p-4","shadow-sm"),children:[e.jsx("p",{className:clsx("text-xs","font-semibold","uppercase","tracking-[0.18em]","text-slate-400"),children:s}),e.jsxs("div",{className:clsx("mt-3","flex","items-baseline","gap-3"),children:[e.jsx("span",{className:`text-3xl font-semibold ${a}`,children:l}),e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold ${r}`,children:t.replace(/_/g," ")})]})]},t))}),e.jsxs("header",{className:clsx("flex","flex-wrap","items-center","justify-between","gap-3"),children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Orders"}),!Ne&&e.jsxs("p",{className:clsx("text-xs","text-slate-500"),children:["Showing ",w.length," of ",Y.length," ","orders"]})]}),e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-3"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-2"),children:[e.jsx(It,{size:16,className:"text-slate-400"}),e.jsx("select",{value:he,onChange:t=>$t(t.target.value),className:clsx("rounded-lg","border","border-slate-200","bg-white","px-3","py-1.5","text-xs","text-slate-700","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100"),children:Xs.map(t=>e.jsx("option",{value:t,children:t?t.replace(/_/g," "):"All statuses"},t||"all"))})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:clsx("absolute","left-3","top-1/2","h-4","w-4","-translate-y-1/2","text-slate-400")}),e.jsx("input",{type:"text",value:we,onChange:t=>qt(t.target.value),placeholder:"Search by order id, buyer, email or tracking",className:clsx("w-64","rounded-full","border","border-slate-200","bg-white","py-1.5","pl-8","pr-3","text-xs","text-slate-700","placeholder:text-slate-400","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100")})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>ge(t=>!t),className:clsx("inline-flex","items-center","gap-2","rounded-full","border","border-slate-200","px-3","py-1.5","text-xs","font-semibold","text-slate-600","transition","hover:border-blue-200","hover:text-blue-600"),children:[e.jsx(Pt,{size:14})," Export"]}),e.jsx(Ee,{children:Qt&&e.jsxs(J.div,{initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.18},className:clsx("absolute","right-0","top-full","z-20","mt-2","w-44","rounded-xl","border","border-slate-200","bg-white","text-left","shadow-xl"),children:[e.jsx("button",{type:"button",onClick:()=>{ls(),ge(!1)},className:clsx("block","w-full","px-4","py-2","text-xs","text-slate-600","hover:bg-slate-50"),children:"Export as CSV"}),e.jsx("button",{type:"button",onClick:()=>{as(),ge(!1)},className:clsx("block","w-full","px-4","py-2","text-xs","text-slate-600","hover:bg-slate-50"),children:"Export as XLSX"}),e.jsx("button",{type:"button",onClick:()=>{rs(),ge(!1)},className:clsx("block","w-full","px-4","py-2","text-xs","text-slate-600","hover:bg-slate-50"),children:"Export as PDF"})]})})]})]})]}),Ve&&e.jsx("div",{className:clsx("rounded-xl","border","border-rose-200","bg-rose-50","px-4","py-3","text-sm","text-rose-600"),children:Ve}),e.jsx("div",{className:clsx("overflow-x-auto","rounded-2xl","border","border-slate-200","bg-white"),children:e.jsxs("table",{className:clsx("min-w-full","divide-y","divide-slate-200","text-[11px]"),children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:clsx("px-3","py-2","text-center","font-semibold","text-slate-600","w-12"),children:e.jsx("input",{ref:tt,type:"checkbox",className:clsx("h-4","w-4","rounded","border-slate-300","text-slate-700","focus:ring-blue-500"),checked:w.length>0&&be===w.length,onChange:ts,"aria-label":"Select all visible orders"})}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600","w-12"),children:"S/N"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Order ID"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Size"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Customer"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Mobile"}),e.jsx("th",{className:clsx("px-3","py-2","text-center","font-semibold","text-slate-600"),children:"QR"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Total"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Fulfilment"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Shipping"}),e.jsx("th",{className:clsx("px-3","py-2","text-center","font-semibold","text-slate-600"),children:"Invoice"}),e.jsx("th",{className:clsx("px-3","py-2","text-center","font-semibold","text-slate-600"),children:"Actions"})]})}),e.jsx("tbody",{className:clsx("divide-y","divide-slate-100","bg-white"),children:Ne?e.jsx("tr",{children:e.jsx("td",{colSpan:12,className:clsx("px-3","py-6","text-center","text-slate-500"),children:"Loading orders..."})}):w.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:12,className:clsx("px-3","py-6","text-center","text-slate-500"),children:"No orders found for this seller."})}):w.map((t,s)=>{var C,U,F,$,M;const l=re(t),a=t.paymentStatus||((C=t.payment)==null?void 0:C.status)||"pending",r=Array.isArray(t.items)&&t.items.length?t.items[0]:null,i=(r==null?void 0:r.size)||(r==null?void 0:r.selectedSize)||"--",p=Gt(t),c=((U=t.shipping)==null?void 0:U.courier)||"Triupati",h=((F=t.shipping)==null?void 0:F.trackingId)||"",u=(($=t.qrfolio)==null?void 0:$.imageUrl)||((M=t.qrfolio)==null?void 0:M.image)||"",n=Jt(t),m=Zt(t),f=es(t),b=String(l||""),P=!!(b&&V.has(b)),O=Wt===b;return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-center"),children:e.jsx("input",{type:"checkbox",className:clsx("h-4","w-4","rounded","border-slate-300","text-slate-700","focus:ring-blue-500"),checked:P,onChange:()=>ss(b),"aria-label":`Select order ${b}`})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-[11px]","font-semibold","text-slate-500"),children:s+1}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","font-mono","text-[11px]","text-slate-800"),children:l}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:i}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:e.jsxs("div",{className:clsx("flex","flex-col"),children:[e.jsx("span",{children:n}),f&&f!=="--"&&e.jsx("span",{className:clsx("text-[11px]","text-slate-500"),children:f})]})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:m||"--"}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-center"),children:e.jsx("button",{type:"button",onClick:async()=>{if(!b){R.error("Order reference unavailable");return}if(!u){R.error("QR code not available for this order yet.");return}try{Ze(b),await kt({qrUrl:u,orderId:l||b,filePrefix:"order-qr",title:n||"Customer"}),R.success("QR code saved as PDF")}catch(W){R.error((W==null?void 0:W.message)||"Failed to download QR code")}finally{Ze(null)}},disabled:!u||Je===b,className:clsx("inline-flex","h-7","w-7","items-center","justify-center","rounded-full","border","border-slate-200","text-slate-500","transition","hover:border-blue-200","hover:bg-blue-50","disabled:cursor-not-allowed","disabled:opacity-60"),"aria-label":`Download QR for order ${l}`,children:Je===b?e.jsx(At,{size:14,className:"animate-spin"}):e.jsx(zs,{size:14})})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-800"),children:ce(p)}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:clsx("font-medium","text-slate-800"),children:t.orderStatus||t.status||"processing"}),e.jsxs("span",{className:clsx("block","text-[11px]","text-slate-500"),children:["Payment: ",a]})]})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{children:c}),e.jsx("span",{className:clsx("block","text-[11px]","text-slate-500","break-all"),children:h||"--"})]})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-center"),children:e.jsxs("button",{type:"button",onClick:()=>us(t),disabled:O,className:clsx("inline-flex","items-center","gap-1","rounded-full","border","border-slate-200","px-3","py-1","text-[11px]","font-medium","text-slate-700","transition","hover:border-blue-200","hover:text-blue-600","disabled:cursor-not-allowed","disabled:opacity-60"),children:[O?e.jsx(At,{size:12,className:"animate-spin"}):e.jsx(Pt,{size:12}),"Invoice"]})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-center"),children:e.jsxs("div",{className:clsx("flex","items-center","justify-center","gap-2"),children:[e.jsx("button",{type:"button",onClick:()=>xe(`/subadmin/sellers/${I}/orders/${l}`,{state:{returnTo:`/subadmin/sellers/${I}`,returnState:{initialTab:"orders"},returnLabel:"Back to seller orders",allowReplacementActions:!1}}),className:clsx("inline-flex","h-7","w-7","items-center","justify-center","rounded-full","border","border-slate-200","text-slate-600","hover:border-blue-200","hover:text-blue-600"),"aria-label":"View order",children:e.jsx(Dt,{size:14})}),e.jsx("button",{type:"button",onClick:()=>is(t),className:clsx("inline-flex","h-7","w-7","items-center","justify-center","rounded-full","border","border-slate-200","text-slate-600","hover:border-blue-200","hover:text-blue-600"),"aria-label":"Edit courier & tracking",children:e.jsx(Qs,{size:14})})]})})]},t._id)})})]})})]}),Z==="coupons"&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("header",{className:clsx("flex","items-center","justify-between","gap-3"),children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Coupons"}),!ke&&e.jsxs("p",{className:clsx("text-xs","text-slate-500"),children:["Showing ",G.length," of ",le.length," ","coupons"]})]}),e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-3"),children:[e.jsxs("div",{className:clsx("flex","items-center","gap-2"),children:[e.jsx(It,{size:16,className:"text-slate-400"}),e.jsx("select",{value:De,onChange:t=>Vt(t.target.value),className:clsx("rounded-lg","border","border-slate-200","bg-white","px-3","py-1.5","text-xs","text-slate-700","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100"),children:Js.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:clsx("absolute","left-3","top-1/2","h-4","w-4","-translate-y-1/2","text-slate-400")}),e.jsx("input",{type:"text",value:Ce,onChange:t=>Kt(t.target.value),placeholder:"Search by code, description or discount",className:clsx("w-64","rounded-full","border","border-slate-200","bg-white","py-1.5","pl-8","pr-3","text-xs","text-slate-700","placeholder:text-slate-400","focus:border-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-100")})]})]})]}),!ke&&G.length>0&&e.jsx("div",{className:clsx("grid","gap-3","sm:grid-cols-2","xl:grid-cols-4"),children:Xt.map(({key:t,label:s,value:l,icon:a,iconBg:r,helper:i})=>e.jsxs("div",{className:clsx("rounded-2xl","border","border-slate-200","bg-white","p-4","shadow-sm"),children:[e.jsxs("div",{className:clsx("flex","items-center","justify-between"),children:[e.jsx("p",{className:clsx("text-xs","font-semibold","uppercase","tracking-[0.18em]","text-slate-400"),children:s}),e.jsx("span",{className:`inline-flex h-8 w-8 items-center justify-center rounded-full ${r}`,children:e.jsx(a,{size:16})})]}),e.jsx("p",{className:clsx("mt-3","text-2xl","font-semibold","text-slate-900"),children:l}),i&&e.jsx("p",{className:clsx("text-[11px]","font-medium","text-slate-500"),children:i})]},t))}),at&&e.jsx("div",{className:clsx("rounded-xl","border","border-rose-200","bg-rose-50","px-4","py-3","text-sm","text-rose-600"),children:at}),e.jsx("div",{className:clsx("overflow-x-auto","rounded-2xl","border","border-slate-200","bg-white"),children:e.jsxs("table",{className:clsx("min-w-full","divide-y","divide-slate-200","text-sm"),children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600","w-16"),children:"S/N"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Code"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Description"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Discount"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Type"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Usage"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Validity"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Status"}),e.jsx("th",{className:clsx("px-3","py-2","text-left","font-semibold","text-slate-600"),children:"Active"})]})}),e.jsx("tbody",{className:clsx("divide-y","divide-slate-100","bg-white"),children:ke?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:clsx("px-3","py-6","text-center","text-slate-500"),children:"Loading coupons..."})}):G.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:clsx("px-3","py-6","text-center","text-slate-500"),children:"No coupons found for this seller."})}):G.slice().sort((t,s)=>{const l=t!=null&&t.createdAt?new Date(t.createdAt).getTime():0;return(s!=null&&s.createdAt?new Date(s.createdAt).getTime():0)-l}).map((t,s)=>{const l=Number(t.maxRedemptions)||0,a=Number(t.usageCount)||0,r=l<=1,i=t.startDate?new Date(t.startDate):null,p=t.endDate?new Date(t.endDate):null,c=m=>m&&!Number.isNaN(m.getTime())?m.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}):"--",u=p&&p<new Date,n=a>0?"Redeemed":"Not redeemed";return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-xs","font-semibold","text-slate-500"),children:s+1}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","font-mono","text-xs","text-slate-800"),children:t.code}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:t.description||"--"}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:t.discountType==="flat"?`₹${t.discountValue}`:`${t.discountValue}%`}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:r?"Single":"Multi"}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:`${a} / ${l>0?l:"∞"}`}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:`${c(i)} - ${c(p)}`}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold ${n==="Redeemed"?"bg-emerald-100 text-emerald-700":u?"bg-slate-100 text-slate-500":"bg-blue-100 text-blue-700"}`,children:n})}),e.jsx("td",{className:clsx("px-3","py-2","align-middle","text-slate-700"),children:t.isActive!==!1?"Yes":"No"})]},t._id)})})]})})]})]})]})]}),e.jsxs(Ee,{children:[g&&e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:clsx("fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/40","px-4"),onClick:()=>ue(null),children:e.jsxs(J.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},className:clsx("relative","flex","w-full","max-w-5xl","max-h-[90vh]","min-h-0","flex-col","overflow-hidden","rounded-2xl","border","border-slate-200","bg-white","shadow-2xl"),onClick:t=>t.stopPropagation(),children:[e.jsx("button",{type:"button",onClick:()=>ue(null),className:clsx("absolute","right-4","top-4","z-30","inline-flex","h-9","w-9","items-center","justify-center","rounded-xl","border","border-slate-200","bg-white/90","text-slate-500","shadow-sm","transition","hover:border-slate-300","hover:text-slate-700"),"aria-label":"Close",children:e.jsx(wt,{size:18})}),e.jsxs("div",{className:clsx("group","relative","flex-1","min-h-0"),children:[e.jsx("div",{className:clsx("modal-scroll","h-full","min-h-0","overflow-y-scroll","px-6","pb-6","pt-20","md:px-8","md:pb-8","md:pt-24","relative"),style:{maxHeight:"calc(90vh - 96px)",scrollbarWidth:"thin",scrollbarColor:"#94a3b8 #e2e8f0",WebkitOverflowScrolling:"touch"},children:e.jsxs("div",{className:clsx("mx-auto","flex","w-full","max-w-4xl","flex-col","gap-6","pr-4","text-sm","text-slate-700"),children:[e.jsx("section",{className:"space-y-4",children:e.jsxs("div",{className:clsx("flex","flex-col","gap-4","lg:flex-row"),children:[e.jsx("div",{className:clsx("relative","flex","flex-1","items-center","justify-center","rounded-2xl","border","border-slate-200","bg-slate-50"),children:Te?e.jsx("img",{src:Te,alt:g.name||"Product image",className:clsx("h-auto","max-h-96","w-full","rounded-2xl","object-contain","p-4")}):e.jsx("div",{className:clsx("flex","h-64","w-full","items-center","justify-center","text-slate-400"),children:e.jsx(_t,{size:28})})}),ht.length>0&&e.jsx("div",{className:clsx("flex","w-full","flex-1","flex-wrap","items-start","justify-center","gap-3","rounded-2xl","border","border-slate-200","bg-white/60","p-4","lg:max-w-xs"),children:ht.slice(0,8).map(t=>e.jsx("img",{src:t,alt:"Product gallery thumbnail",className:clsx("h-20","w-20","rounded-xl","border","border-slate-200","object-cover","transition","hover:scale-[1.02]")},t))})]})}),e.jsxs("section",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:clsx("text-xs","font-semibold","uppercase","tracking-[0.18em]","text-slate-400"),children:"Product Overview"}),e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-3"),children:[e.jsx("h2",{className:clsx("text-2xl","font-semibold","text-slate-900"),children:g.name||"Untitled Product"}),e.jsx("span",{className:clsx("inline-flex","items-center","rounded-full","border","border-slate-200","bg-slate-50","px-3","py-1","text-xs","font-semibold","text-slate-600"),children:g.status?g.status:"Status unavailable"})]}),e.jsxs("div",{className:clsx("flex","flex-wrap","items-center","gap-3","text-xs","text-slate-500"),children:[e.jsxs("span",{children:["ID:"," ",e.jsx("span",{className:"font-mono",children:g._id})]}),g.createdAt&&e.jsxs("span",{children:["Added:"," ",new Date(g.createdAt).toLocaleDateString("en-IN")]})]})]}),e.jsxs("div",{className:clsx("grid","gap-4","sm:grid-cols-2","lg:grid-cols-3"),children:[e.jsxs("div",{className:clsx("rounded-xl","border","border-slate-200","bg-slate-50","px-4","py-3"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"SKU"}),e.jsx("p",{className:clsx("mt-1","font-mono","text-sm","text-slate-800"),children:g.sku||"--"})]}),e.jsxs("div",{className:clsx("rounded-xl","border","border-slate-200","bg-slate-50","px-4","py-3"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Category"}),e.jsx("p",{className:clsx("mt-1","text-sm","text-slate-800"),children:g.category||"--"})]}),e.jsxs("div",{className:clsx("rounded-xl","border","border-slate-200","bg-slate-50","px-4","py-3"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Brand"}),e.jsx("p",{className:clsx("mt-1","text-sm","text-slate-800"),children:g.brand||"--"})]}),e.jsxs("div",{className:clsx("rounded-xl","border","border-slate-200","bg-slate-50","px-4","py-3"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Price"}),e.jsx("p",{className:clsx("mt-1","text-base","font-semibold","text-slate-900"),children:ce(g.price)}),g.originalPrice?e.jsxs("p",{className:clsx("text-xs","text-slate-500"),children:["Original:"," ",ce(g.originalPrice)]}):null]}),e.jsxs("div",{className:clsx("rounded-xl","border","border-slate-200","bg-slate-50","px-4","py-3"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Discount"}),e.jsx("p",{className:clsx("mt-1","text-base","font-semibold","text-slate-900"),children:g.discountPercentage!==void 0&&g.discountPercentage!==null?`${g.discountPercentage}%`:g.saveAmount?`${ce(g.saveAmount)} off`:"--"})]}),e.jsxs("div",{className:clsx("rounded-xl","border","border-slate-200","bg-slate-50","px-4","py-3"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Stock"}),e.jsx("p",{className:clsx("mt-1","text-base","font-semibold","text-slate-900"),children:Number.isFinite(Number(g.stock))?Number(g.stock):"--"}),g.lowStockThreshold?e.jsxs("p",{className:clsx("text-xs","text-slate-500"),children:["Low stock alert at ",g.lowStockThreshold]}):null]})]}),g.description&&e.jsxs("div",{className:clsx("rounded-2xl","border","border-slate-200","bg-white","px-5","py-4","shadow-sm"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Description"}),e.jsx("p",{className:clsx("mt-2","whitespace-pre-line","text-sm","leading-relaxed","text-slate-700"),children:g.description})]}),Array.isArray(g.keyFeatures)&&g.keyFeatures.length>0&&e.jsxs("div",{className:clsx("rounded-2xl","border","border-slate-200","bg-white","px-5","py-4","shadow-sm"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Key Features"}),e.jsx("ul",{className:clsx("mt-2","list-disc","space-y-1","pl-5","text-sm","text-slate-700"),children:g.keyFeatures.filter(t=>!!t).map(t=>e.jsx("li",{children:t},t))})]}),Array.isArray(g.sizes)&&g.sizes.length>0&&e.jsxs("div",{className:clsx("rounded-2xl","border","border-slate-200","bg-white","px-5","py-4","shadow-sm"),children:[e.jsx("p",{className:clsx("text-[11px]","font-semibold","uppercase","tracking-[0.12em]","text-slate-400"),children:"Sizes"}),e.jsx("div",{className:clsx("mt-2","flex","flex-wrap","gap-2","text-xs"),children:g.sizes.map((t,s)=>e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full border px-3 py-1 ${(t==null?void 0:t.isAvailable)!==!1?"border-emerald-200 bg-emerald-50 text-emerald-600":"border-slate-200 bg-slate-100 text-slate-500"}`,children:[(t==null?void 0:t.label)||"--",e.jsx("span",{className:clsx("font-mono","text-[11px]"),children:Number.isFinite(Number(t==null?void 0:t.stock))?Number(t.stock):0})]},`${(t==null?void 0:t.label)||"size"}-${s}`))})]})]}),e.jsx("div",{className:clsx("flex","justify-end","pb-2"),children:e.jsx("button",{type:"button",onClick:()=>ue(null),className:clsx("inline-flex","items-center","justify-center","rounded-xl","border","border-slate-200","px-4","py-2","text-sm","font-semibold","text-slate-600","transition","hover:border-slate-300","hover:text-slate-800"),children:"Close"})})]})}),e.jsx("div",{className:clsx("pointer-events-none","absolute","inset-x-8","bottom-0","h-14","bg-gradient-to-t","from-white","via-white/90","to-transparent","opacity-80","transition-opacity","duration-300","group-hover:opacity-5")}),e.jsx("div",{className:clsx("pointer-events-none","absolute","inset-x-0","bottom-4","flex","justify-center","text-xs","font-medium","text-slate-400","opacity-80","transition-opacity","duration-300","group-hover:opacity-5"),children:"Scroll to see full details"})]})]})}),E&&e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:clsx("fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/40","px-4"),onClick:Ae,children:e.jsxs(J.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},className:clsx("relative","w-full","max-w-lg","rounded-2xl","border","border-slate-200","bg-white","p-6","shadow-2xl"),onClick:t=>t.stopPropagation(),children:[e.jsx("button",{type:"button",onClick:Ae,className:clsx("absolute","right-4","top-4","inline-flex","h-8","w-8","items-center","justify-center","rounded-full","border","border-slate-200","text-slate-500","hover:border-slate-300","hover:text-slate-700"),"aria-label":"Close",disabled:ie,children:e.jsx(wt,{size:16})}),e.jsx("h2",{className:clsx("text-lg","font-semibold","text-slate-900"),children:"Edit Order"}),e.jsx("p",{className:clsx("mt-1","text-xs","text-slate-500"),children:"Update order status, payment details and courier information."}),e.jsxs("form",{onSubmit:ms,className:clsx("mt-4","space-y-4","text-sm"),children:[e.jsxs("div",{children:[e.jsxs("label",{className:clsx("block","text-xs","font-medium","text-slate-700"),children:["Order Status",e.jsxs("select",{value:N.status,onChange:os,className:clsx("mt-1","w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-blue-500","focus:outline-none","focus:ring-1","focus:ring-blue-500"),disabled:ut,children:[e.jsx("option",{value:"confirmed",children:"Order Confirmed"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"picked_up",children:"Picked Up"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"out_for_delivery",children:"Out for Delivery"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"returned",children:"Returned"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),String(N.status||"").toLowerCase()==="rejected"&&e.jsxs("label",{className:clsx("mt-2","flex","items-center","gap-2","text-xs","font-medium","text-rose-600"),children:[e.jsx("input",{type:"checkbox",className:clsx("h-4","w-4","rounded","border-slate-300","text-rose-600","focus:ring-rose-500"),checked:!!N.rejectionPermanent,onChange:t=>oe("rejectionPermanent",t.target.checked)}),e.jsx("span",{children:"Lock status after rejection (prevent further status changes)"})]}),ut?e.jsx("p",{className:clsx("mt-1","text-xs","text-rose-500"),children:"Unlock the toggle above to change the order status."}):null]}),e.jsxs("div",{className:clsx("grid","gap-4","sm:grid-cols-2"),children:[e.jsxs("label",{className:clsx("block","text-xs","font-medium","text-slate-700"),children:["Payment Status",e.jsxs("select",{value:N.paymentStatus,disabled:mt,onChange:t=>oe("paymentStatus",t.target.value),className:clsx("mt-1","w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-blue-500","focus:outline-none","focus:ring-1","focus:ring-blue-500"),children:[e.jsx("option",{value:"",children:"Keep unchanged"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Successful"}),e.jsx("option",{value:"failed",children:"Failed"})]}),mt?e.jsx("p",{className:clsx("mt-1","text-[11px]","text-slate-500"),children:"Payment is already marked successful and cannot be changed."}):null]}),e.jsxs("label",{className:clsx("block","text-xs","font-medium","text-slate-700"),children:["Payment Method",e.jsxs("select",{value:N.paymentMethod,onChange:t=>oe("paymentMethod",t.target.value),className:clsx("mt-1","w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-blue-500","focus:outline-none","focus:ring-1","focus:ring-blue-500"),children:[e.jsx("option",{value:"",children:"Keep unchanged"}),e.jsx("option",{value:"cod",children:"Cash on Delivery"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"qr",children:"QR Code"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"netbanking",children:"Net Banking"})]})]})]}),e.jsxs("label",{className:clsx("block","text-xs","font-medium","text-slate-700"),children:["Estimated Delivery Date",e.jsx("input",{type:"date",value:N.estimatedDeliveryDate,disabled:Le,onChange:xs,className:clsx("mt-1","w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-blue-500","focus:outline-none","focus:ring-1","focus:ring-blue-500")}),Le?e.jsx("p",{className:clsx("mt-1","text-xs","text-slate-500"),children:"Delivery date is locked because the order has already been delivered or returned."}):null]}),e.jsxs("div",{className:clsx("grid","gap-4","sm:grid-cols-2"),children:[e.jsxs("label",{className:clsx("block","text-xs","font-medium","text-slate-700"),children:["Courier",e.jsx("select",{value:N.courier,onChange:t=>oe("courier",t.target.value),className:clsx("mt-1","w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-blue-500","focus:outline-none","focus:ring-1","focus:ring-blue-500"),children:Zs.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("label",{className:clsx("block","text-xs","font-medium","text-slate-700"),children:["Tracking ID",e.jsx("input",{type:"text",value:N.trackingId,onChange:t=>oe("trackingId",t.target.value),className:clsx("mt-1","w-full","rounded-xl","border","border-slate-200","px-3","py-2","text-sm","focus:border-blue-500","focus:outline-none","focus:ring-1","focus:ring-blue-500"),placeholder:"To be assigned"})]})]}),e.jsxs("div",{className:clsx("mt-2","flex","flex-wrap","items-center","justify-end","gap-3"),children:[Re&&!_e?e.jsx("p",{className:clsx("mr-auto","text-xs","text-rose-500"),children:"Mark payment as successful before setting the order to Delivered."}):null,e.jsx("button",{type:"button",onClick:Ae,className:clsx("rounded-xl","border","border-slate-200","px-4","py-2","text-xs","font-medium","text-slate-600","hover:bg-slate-50"),disabled:ie,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:ie||!ds,className:clsx("rounded-xl","bg-slate-900","px-4","py-2","text-xs","font-medium","text-white","hover:bg-slate-800","disabled:cursor-not-allowed","disabled:opacity-70"),children:ie?"Saving...":"Save Changes"})]})]})]})})]})]})};export{jl as default};
