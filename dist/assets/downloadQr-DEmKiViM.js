import{c as S}from"./index-Bpx0OnSg.js";import{E as q}from"./jspdf.es.min-BhhWDGe6.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],j=S("qr-code",E),F=async a=>{const h=await fetch(a,{credentials:"include"});if(!h.ok)throw new Error("Failed to load QR code image");const s=await h.blob(),i=await new Promise((c,t)=>{const e=new FileReader;e.onloadend=()=>c(e.result),e.onerror=t,e.readAsDataURL(s)}),g=await new Promise((c,t)=>{const e=new Image;e.crossOrigin="anonymous",e.onload=()=>c({width:e.naturalWidth,height:e.naturalHeight}),e.onerror=t,e.src=i}),r=s.type||"";let n="PNG";return r.includes("jpeg")||r.includes("jpg")?n="JPEG":r.includes("webp")&&(n="WEBP"),{dataUrl:i,format:n,dimensions:g}},x=a=>String(a||"qr-code").toLowerCase().replace(/[^a-z0-9\-]+/gi,"-").replace(/-{2,}/g,"-").replace(/^-|-$/g,""),I=async({qrUrl:a,orderId:h,filePrefix:s="qr-code",title:i,includeTitle:g=!1,returnDataUri:r=!1})=>{if(!a)throw new Error("QR code not available for this order");const{dataUrl:n,format:c,dimensions:t}=await F(a),e=.75,m=t!=null&&t.width?t.width*e:320,M=t!=null&&t.height?t.height*e:m,w=420,y=240,d=Math.min(Math.max(m,y),w),u=t!=null&&t.width&&(t!=null&&t.height)?t.width/t.height:1,k=u?d/u:Math.min(Math.max(M,y),w),l=12,p=i&&g?36:0,f=d+l*2,b=k+l*2+p,o=new q({orientation:"portrait",unit:"pt",format:[f,b]});p&&(o.setFont("Helvetica","bold"),o.setFontSize(18),o.text(String(i),f/2,l+6,{align:"center"}));const v=(f-d)/2,P=l+p;o.addImage(n,c||"PNG",v,P,d,k);const z=x(h||Date.now()),H=`${x(s)||"qr-code"}-${z||"qr"}.pdf`;if(r)return o.output("datauristring");o.save(H)};export{j as Q,I as d};
